var xh=Object.defineProperty;var vc=e=>{throw TypeError(e)};var ph=(e,t,r)=>t in e?xh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var jr=(e,t,r)=>ph(e,typeof t!="symbol"?t+"":t,r),mh=(e,t,r)=>t.has(e)||vc("Cannot "+r);var _c=(e,t,r)=>t.has(e)?vc("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var ms=(e,t,r)=>(mh(e,t,"access private method"),r);import{b as wc,e as gh,c as De,a as ne,t as Oe,d as sl}from"../chunks/disclose-version.2iI3aS7g.js";import{i as rs}from"../chunks/legacy.DY8QTsY9.js";import{d as il,h as Yr,F as Vs,i as vh,ap as cl,P as _h,Q as kc,G as Ps,R as ki,g as _a,aw as Ns,V as ol,e as p0,W as wh,C as Ec,ax as Tc,ay as kh,ac as Eh,az as Th,f as ll,B as fl,A as yh,am as Ah,ae as Sh,ag as Fh,aA as m0,aB as g0,a8 as bh,J as yc,aC as ul,aD as Ch,aE as Rh,ak as hl,an as Ih,al as Oh,aF as Dh,aG as Ph,O as Nh,aH as Mh,aI as Lh,b as Bh,as as Uh,ar as dl,j as Fe,p as ts,k as as,v as j,s as be,a3 as Ac,t as Je,aJ as $h,aK as Kt,L as Ge,x as ga,aL as v0,aM as kr,m as xe,r as fe,aN as Hh,aO as wn,aP as It}from"../chunks/runtime.BXeHQR4r.js";import{a as Wh,l as xl,s as Et,e as zt,r as Sc}from"../chunks/render.5-4pPTFq.js";import{b as Vh,p as ze,i as xr,l as Fc,s as Wa,c as ut}from"../chunks/props.DWtFO36s.js";import{o as _0,c as Gh}from"../chunks/index-client.BVB-JWuD.js";function tt(e,t){return t}function zh(e,t,r,a){for(var n=[],s=t.length,i=0;i<s;i++)kh(t[i].e,n,!0);var c=s>0&&n.length===0&&r!==null;if(c){var o=r.parentNode;Eh(o),o.append(r),a.clear(),sa(e,t[0].prev,t[s-1].next)}Th(n,()=>{for(var l=0;l<s;l++){var f=t[l];c||(a.delete(f.k),sa(e,f.prev,f.next)),ll(f.e,!c)}})}function at(e,t,r,a,n,s=null){var i=e,c={flags:t,items:new Map,first:null},o=(t&ul)!==0;if(o){var l=e;i=Yr?Ps(fl(l)):l.appendChild(yh())}Yr&&Vs();var f=null,h=!1;il(()=>{var u=r(),d=vh(u)?u:u==null?[]:cl(u),p=d.length;if(h&&p===0)return;h=p===0;let x=!1;if(Yr){var m=i.data===_h;m!==(p===0)&&(i=kc(),Ps(i),ki(!1),x=!0)}if(Yr){for(var w=null,_,v=0;v<p;v++){if(_a.nodeType===8&&_a.data===Ah){i=_a,x=!0,ki(!1);break}var C=d[v],O=a(C,v);_=pl(_a,c,w,null,C,O,v,n,t),c.items.set(O,_),w=_}p>0&&Ps(kc())}if(!Yr){var R=Sh;Xh(d,c,i,n,t,(R.f&Ns)!==0,a)}s!==null&&(p===0?f?ol(f):f=p0(()=>s(i)):f!==null&&wh(f,()=>{f=null})),x&&ki(!0),r()}),Yr&&(i=_a)}function Xh(e,t,r,a,n,s,i,c){var Z,oe,Q,ye;var o=(n&Ch)!==0,l=(n&(m0|g0))!==0,f=e.length,h=t.items,u=t.first,d=u,p,x=null,m,w=[],_=[],v,C,O,R;if(o)for(R=0;R<f;R+=1)v=e[R],C=i(v,R),O=h.get(C),O!==void 0&&((Z=O.a)==null||Z.measure(),(m??(m=new Set)).add(O));for(R=0;R<f;R+=1){if(v=e[R],C=i(v,R),O=h.get(C),O===void 0){var E=d?d.e.nodes_start:r;x=pl(E,t,x,x===null?t.first:x.next,v,C,R,a,n),h.set(C,x),w=[],_=[],d=x.next;continue}if(l&&jh(O,v,R,n),O.e.f&Ns&&(ol(O.e),o&&((oe=O.a)==null||oe.unfix(),(m??(m=new Set)).delete(O))),O!==d){if(p!==void 0&&p.has(O)){if(w.length<_.length){var M=_[0],I;x=M.prev;var W=w[0],L=w[w.length-1];for(I=0;I<w.length;I+=1)bc(w[I],M,r);for(I=0;I<_.length;I+=1)p.delete(_[I]);sa(t,W.prev,L.next),sa(t,x,W),sa(t,L,M),d=M,x=L,R-=1,w=[],_=[]}else p.delete(O),bc(O,d,r),sa(t,O.prev,O.next),sa(t,O,x===null?t.first:x.next),sa(t,x,O),x=O;continue}for(w=[],_=[];d!==null&&d.k!==C;)(s||!(d.e.f&Ns))&&(p??(p=new Set)).add(d),_.push(d),d=d.next;if(d===null)continue;O=d}w.push(O),x=O,d=O.next}if(d!==null||p!==void 0){for(var N=p===void 0?[]:cl(p);d!==null;)(s||!(d.e.f&Ns))&&N.push(d),d=d.next;var J=N.length;if(J>0){var le=n&ul&&f===0?r:null;if(o){for(R=0;R<J;R+=1)(Q=N[R].a)==null||Q.measure();for(R=0;R<J;R+=1)(ye=N[R].a)==null||ye.fix()}zh(t,N,le,h)}}o&&Fh(()=>{var U;if(m!==void 0)for(O of m)(U=O.a)==null||U.apply()}),Ec.first=t.first&&t.first.e,Ec.last=x&&x.e}function jh(e,t,r,a){a&m0&&Tc(e.v,t),a&g0?Tc(e.i,r):e.i=r}function pl(e,t,r,a,n,s,i,c,o,l){var f=(o&m0)!==0,h=(o&Rh)===0,u=f?h?bh(n):yc(n):n,d=o&g0?yc(i):i,p={i:d,v:u,k:s,a:null,e:null,prev:r,next:a};try{return p.e=p0(()=>c(e,u,d),Yr),p.e.prev=r&&r.e,p.e.next=a&&a.e,r===null?t.first=p:(r.next=p,r.e.next=p.e),a!==null&&(a.prev=p,a.e.prev=p.e),p}finally{}}function bc(e,t,r){for(var a=e.next?e.next.e.nodes_start:r,n=t?t.e.nodes_start:r,s=e.e.nodes_start;s!==a;){var i=hl(s);n.before(s),s=i}}function sa(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function Kh(e,t,r,a,n){var s=e,i="",c;il(()=>{if(i===(i=t()??"")){Yr&&Vs();return}c!==void 0&&(ll(c),c=void 0),i!==""&&(c=p0(()=>{if(Yr){_a.data;for(var o=Vs(),l=o;o!==null&&(o.nodeType!==8||o.data!=="");)l=o,o=hl(o);if(o===null)throw Ih(),Oh;wc(_a,l),s=Ps(o);return}var f=i+"",h=gh(f);wc(fl(h),h.lastChild),s.before(h)}))})}function ir(e,t,r,a,n){var c;Yr&&Vs();var s=(c=t.$$slots)==null?void 0:c[r],i=!1;s===!0&&(s=t.children,i=!0),s===void 0||s(e,i?()=>a:a)}function gs(e){if(Yr){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var a=e.value;br(e,"value",null),e.value=a}if(e.hasAttribute("checked")){var n=e.checked;br(e,"checked",null),e.checked=n}}};e.__on_r=r,Dh(r),Wh()}}function br(e,t,r,a){var n=e.__attributes??(e.__attributes={});Yr&&(n[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||n[t]!==(n[t]=r)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[Ph]=r),r==null?e.removeAttribute(t):typeof r!="string"&&Yh(e).includes(t)?e[t]=r:e.setAttribute(t,r))}var Cc=new Map;function Yh(e){var t=Cc.get(e.nodeName);if(t)return t;Cc.set(e.nodeName,t=[]);for(var r,a=e,n=Element.prototype;n!==a;){r=Mh(a);for(var s in r)r[s].set&&t.push(s);a=Nh(a)}return t}function Jh(e,t){var r=e.__className,a=qh(t);Yr&&e.className===a?e.__className=a:(r!==a||Yr&&e.className!==a)&&(t==null?e.removeAttribute("class"):e.className=a,e.__className=a)}function qh(e){return e??""}function Va(e,t,r=t){var a=Lh();xl(e,"input",n=>{var s=n?e.defaultValue:e.value;if(s=Ei(e)?Ti(s):s,r(s),a&&s!==(s=t())){var i=e.selectionStart,c=e.selectionEnd;e.value=s??"",c!==null&&(e.selectionStart=i,e.selectionEnd=Math.min(c,e.value.length))}}),(Yr&&e.defaultValue!==e.value||Bh(t)==null&&e.value)&&r(Ei(e)?Ti(e.value):e.value),Uh(()=>{var n=t();Ei(e)&&n===Ti(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function Ei(e){var t=e.type;return t==="number"||t==="range"}function Ti(e){return e===""?null:+e}function ml(e,t,r){if(e.multiple)return Qh(e,t);for(var a of e.options){var n=In(a);if(Vh(n,t)){a.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function Zh(e,t){dl(()=>{var r=new MutationObserver(()=>{var a=e.__value;ml(e,a)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function vs(e,t,r=t){var a=!0;xl(e,"change",n=>{var s=n?"[selected]":":checked",i;if(e.multiple)i=[].map.call(e.querySelectorAll(s),In);else{var c=e.querySelector(s)??e.querySelector("option:not([disabled])");i=c&&In(c)}r(i)}),dl(()=>{var n=t();if(ml(e,n,a),a&&n===void 0){var s=e.querySelector(":checked");s!==null&&(n=In(s),r(n))}e.__value=n,a=!1}),Zh(e)}function Qh(e,t){for(var r of e.options)r.selected=~t.indexOf(In(r))}function In(e){return"__value"in e?e.__value:e.value}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var gl=1252,ed=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],w0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},k0=function(e){ed.indexOf(e)!=-1&&(gl=w0[0]=e)};function rd(){k0(1252)}var yt=function(e){k0(e)};function vl(){yt(1200),rd()}function Rc(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function td(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function _l(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var kn=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?td(e.slice(2)):t==254&&r==255?_l(e.slice(2)):t==65279?e.slice(1):e},_s=function(t){return String.fromCharCode(t)},Ic=function(t){return String.fromCharCode(t)},ia,oa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Oc(e){for(var t="",r=0,a=0,n=0,s=0,i=0,c=0,o=0,l=0;l<e.length;)r=e.charCodeAt(l++),s=r>>2,a=e.charCodeAt(l++),i=(r&3)<<4|a>>4,n=e.charCodeAt(l++),c=(a&15)<<2|n>>6,o=n&63,isNaN(a)?c=o=64:isNaN(n)&&(o=64),t+=oa.charAt(s)+oa.charAt(i)+oa.charAt(c)+oa.charAt(o);return t}function ft(e){var t="",r=0,a=0,n=0,s=0,i=0,c=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=oa.indexOf(e.charAt(l++)),i=oa.indexOf(e.charAt(l++)),r=s<<2|i>>4,t+=String.fromCharCode(r),c=oa.indexOf(e.charAt(l++)),a=(i&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),o=oa.indexOf(e.charAt(l++)),n=(c&3)<<6|o,o!==64&&(t+=String.fromCharCode(n));return t}var Me=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Oa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ua(e){return Me?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Dc(e){return Me?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Tt=function(t){return Me?Oa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Da(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function E0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return E0(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ca=Me?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Oa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function ad(e){for(var t=[],r=0,a=e.length+250,n=ua(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=e.charCodeAt(++s)&1023;n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|c>>6&15|(i&3)<<4,n[r++]=128|c&63}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|i&63;r>a&&(t.push(n.slice(0,r)),r=0,n=ua(65535),a=65530)}return t.push(n.slice(0,r)),ca(t)}var Zr=/\u0000/g,En=/[\u0001-\u0006]/g;function Za(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function At(e,t){var r=""+e;return r.length>=t?r:fr("0",t-r.length)+r}function T0(e,t){var r=""+e;return r.length>=t?r:fr(" ",t-r.length)+r}function Gs(e,t){var r=""+e;return r.length>=t?r:r+fr(" ",t-r.length)}function nd(e,t){var r=""+Math.round(e);return r.length>=t?r:fr("0",t-r.length)+r}function sd(e,t){var r=""+e;return r.length>=t?r:fr("0",t-r.length)+r}var Pc=Math.pow(2,32);function Ga(e,t){if(e>Pc||e<-Pc)return nd(e,t);var r=Math.round(e);return sd(r,t)}function zs(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Nc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],yi=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function id(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ie={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Mc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cd={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xs(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,i=1,c=0,o=1,l=0,f=0,h=Math.floor(n);l<t&&(h=Math.floor(n),c=h*i+s,f=h*l+o,!(n-h<5e-8));)n=1/(n-h),s=i,i=c,o=l,l=f;if(f>t&&(l>t?(f=o,c=s):(f=l,c=i)),!r)return[0,a*c,f];var u=Math.floor(a*c/f);return[u,a*c-u*f,f]}function Ea(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,i=[],c={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),i=[o.getFullYear(),o.getMonth()+1,o.getDate()],s=o.getDay(),a<60&&(s=(s+6)%7),r&&(s=dd(o,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=s,c}var wl=new Date(1899,11,31,0,0,0),od=wl.getTime(),ld=new Date(1900,2,1,0,0,0);function kl(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=ld&&(r+=24*60*60*1e3),(r-(od+(e.getTimezoneOffset()-wl.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function y0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fd(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ud(e){var t=e<0?12:11,r=y0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function hd(e){var t=y0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Gn(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=ud(e):t===10?r=e.toFixed(10).substr(0,12):r=hd(e),y0(fd(r.toUpperCase()))}function Sa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Gn(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return pt(14,kl(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function dd(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function xd(e,t,r,a){var n="",s=0,i=0,c=r.y,o,l=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:o=c%100,l=2;break;default:o=c%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,l=t.length;break;case 3:return yi[r.m-1][1];case 5:return yi[r.m-1][0];default:return yi[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,l=t.length;break;case 3:return Nc[r.q][0];default:return Nc[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?At(r.S,t.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(n=At(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:o=c,l=1;break}var f=l>0?At(o,l):"";return f}function la(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var El=/%/g;function pd(e,t,r){var a=t.replace(El,""),n=t.length-a.length;return Jt(e,a,r*Math.pow(10,2*n))+fr("%",n)}function md(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Jt(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Tl(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Tl(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,l,f){return o+l+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var yl=/# (\?+)( ?)\/( ?)(\d+)/;function gd(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),i=n-s*a,c=a;return r+(s===0?"":""+s)+" "+(i===0?fr(" ",e[1].length+1+e[4].length):T0(i,e[1].length)+e[2]+"/"+e[3]+At(c,e[4].length))}function vd(e,t,r){return r+(t===0?"":""+t)+fr(" ",e[1].length+2+e[4].length)}var Al=/^#*0*\.([0#]+)/,Sl=/\).*[0#]/,Fl=/\(###\) ###\\?-####/;function Kr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Lc(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Bc(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function _d(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function wd(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function dt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Sl)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?dt("n",a,r):"("+dt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return md(e,t,r);if(t.indexOf("%")!==-1)return pd(e,t,r);if(t.indexOf("E")!==-1)return Tl(t,r);if(t.charCodeAt(0)===36)return"$"+dt(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,c,o=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+Ga(o,t.length);if(t.match(/^[#?]+$/))return n=Ga(r,0),n==="0"&&(n=""),n.length>t.length?n:Kr(t.substr(0,t.length-n.length))+n;if(s=t.match(yl))return gd(s,o,l);if(t.match(/^#+0+$/))return l+Ga(o,t.length-t.indexOf("0"));if(s=t.match(Al))return n=Lc(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Kr(s[1])).replace(/\.$/,"."+Kr(s[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+fr("0",Kr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+Lc(o,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+la(Ga(o,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+dt(e,t,-r):la(""+(Math.floor(r)+_d(r,s[1].length)))+"."+At(Bc(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return dt(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Za(dt(e,t.replace(/[\\-]/g,""),r)),i=0,Za(Za(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<n.length?n.charAt(i++):p==="0"?"0":""}));if(t.match(Fl))return n=dt(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=Xs(o,Math.pow(10,i)-1,!1),n=""+l,f=Jt("n",s[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=Gs(c[2],i),f.length<s[4].length&&(f=Kr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=Xs(o,Math.pow(10,i)-1,!0),l+(c[0]||(c[1]?"":"0"))+" "+(c[1]?T0(c[1],i)+s[2]+"/"+s[3]+Gs(c[2],i):fr(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=Ga(r,0),t.length<=n.length?n:Kr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var h=t.indexOf(".")-i,u=t.length-n.length-h;return Kr(t.substr(0,h)+n+t.substr(t.length-u))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Bc(r,s[1].length),r<0?"-"+dt(e,t,-r):la(wd(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?At(0,3-p.length):"")+p})+"."+At(i,s[1].length);switch(t){case"###,##0.00":return dt(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=la(Ga(o,0));return d!=="0"?l+d:"";case"###,###.00":return dt(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return dt(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function kd(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Jt(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Ed(e,t,r){var a=t.replace(El,""),n=t.length-a.length;return Jt(e,a,r*Math.pow(10,2*n))+fr("%",n)}function bl(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+bl(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,l,f){return o+l+f.substr(0,(n+s)%n)+"."+f.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Pt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Sl)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pt("n",a,r):"("+Pt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return kd(e,t,r);if(t.indexOf("%")!==-1)return Ed(e,t,r);if(t.indexOf("E")!==-1)return bl(t,r);if(t.charCodeAt(0)===36)return"$"+Pt(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,i,c,o=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+At(o,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Kr(t.substr(0,t.length-n.length))+n;if(s=t.match(yl))return vd(s,o,l);if(t.match(/^#+0+$/))return l+At(o,t.length-t.indexOf("0"));if(s=t.match(Al))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Kr(s[1])).replace(/\.$/,"."+Kr(s[1])),n=n.replace(/\.(\d*)$/,function(p,x){return"."+x+fr("0",Kr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+la(""+o);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pt(e,t,-r):la(""+r)+"."+fr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Pt(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Za(Pt(e,t.replace(/[\\-]/g,""),r)),i=0,Za(Za(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<n.length?n.charAt(i++):p==="0"?"0":""}));if(t.match(Fl))return n=Pt(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),c=Xs(o,Math.pow(10,i)-1,!1),n=""+l,f=Jt("n",s[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+s[2]+"/"+s[3],f=Gs(c[2],i),f.length<s[4].length&&(f=Kr(s[4].substr(s[4].length-f.length))+f),n+=f,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c=Xs(o,Math.pow(10,i)-1,!0),l+(c[0]||(c[1]?"":"0"))+" "+(c[1]?T0(c[1],i)+s[2]+"/"+s[3]+Gs(c[2],i):fr(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Kr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var h=t.indexOf(".")-i,u=t.length-n.length-h;return Kr(t.substr(0,h)+n+t.substr(t.length-u))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Pt(e,t,-r):la(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?At(0,3-p.length):"")+p})+"."+At(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=la(""+o);return d!=="0"?l+d:"";default:if(t.match(/\.[0#?]*$/))return Pt(e,t.slice(0,t.lastIndexOf(".")),r)+Kr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Jt(e,t,r){return(r|0)===r?Pt(e,t,r):dt(e,t,r)}function Td(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Cl=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ln(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":zs(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(Cl))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yd(e,t,r,a){for(var n=[],s="",i=0,c="",o="t",l,f,h,u="H";i<e.length;)switch(c=e.charAt(i)){case"G":if(!zs(e,i))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(h=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(h);n[n.length]={t:"t",v:s},++i;break;case"\\":var d=e.charAt(++i),p=d==="("||d===")"?d:"t";n[n.length]={t:p,v:d},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(l==null&&(l=Ea(t,r,e.charAt(i+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},o=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=Ea(t,r),l==null))return"";for(s=c;++i<e.length&&e.charAt(i).toLowerCase()===c;)s+=c;c==="m"&&o.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=u),n[n.length]={t:c,v:s},o=c;break;case"A":case"a":case"上":var x={t:c,v:c};if(l==null&&(l=Ea(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(l!=null&&(x.v=l.H>=12?"P":"A"),x.t="T",u="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(l!=null&&(x.v=l.H>=12?"PM":"AM"),x.t="T",i+=5,u="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(l!=null&&(x.v=l.H>=12?"下午":"上午"),x.t="T",i+=5,u="h"):(x.t="t",++i),l==null&&x.t==="T")return"";n[n.length]=x,o=c;break;case"[":for(s=c;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Cl)){if(l==null&&(l=Ea(t,r),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},o=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ln(e)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=c;++i<e.length&&(c=e.charAt(i))==="0";)s+=c;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++i<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(i))>-1;)s+=c;n[n.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++i)===c;)s+=c;n[n.length]={t:c,v:s},o=c;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:c,v:c},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"t",v:c},++i;break}var m=0,w=0,_;for(i=n.length-1,o="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=u,o="h",m<1&&(m=1);break;case"s":(_=n[i].v.match(/\.0+$/))&&(w=Math.max(w,_[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":o=n[i].t;break;case"m":o==="s"&&(n[i].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&n[i].v.match(/[Hh]/)&&(m=1),m<2&&n[i].v.match(/[Mm]/)&&(m=2),m<3&&n[i].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var v="",C;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=xd(n[i].t.charCodeAt(0),n[i].v,l,w),n[i].t="t";break;case"n":case"?":for(C=i+1;n[C]!=null&&((c=n[C].t)==="?"||c==="D"||(c===" "||c==="t")&&n[C+1]!=null&&(n[C+1].t==="?"||n[C+1].t==="t"&&n[C+1].v==="/")||n[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[C].v==="/"||n[C].v===" "&&n[C+1]!=null&&n[C+1].t=="?"));)n[i].v+=n[C].v,n[C]={v:"",t:";"},++C;v+=n[i].v,i=C-1;break;case"G":n[i].t="t",n[i].v=Sa(t,r);break}var O="",R,E;if(v.length>0){v.charCodeAt(0)==40?(R=t<0&&v.charCodeAt(0)===45?-t:t,E=Jt("n",v,R)):(R=t<0&&a>1?-t:t,E=Jt("n",v,R),R<0&&n[0]&&n[0].t=="t"&&(E=E.substr(1),n[0].v="-"+n[0].v)),C=E.length-1;var M=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){M=i;break}var I=n.length;if(M===n.length&&E.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(C>=n[i].v.length-1?(C-=n[i].v.length,n[i].v=E.substr(C+1,n[i].v.length)):C<0?n[i].v="":(n[i].v=E.substr(0,C+1),C=-1),n[i].t="t",I=i);C>=0&&I<n.length&&(n[I].v=E.substr(0,C+1)+n[I].v)}else if(M!==n.length&&E.indexOf("E")===-1){for(C=E.indexOf(".")-1,i=M;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(f=n[i].v.indexOf(".")>-1&&i===M?n[i].v.indexOf(".")-1:n[i].v.length-1,O=n[i].v.substr(f+1);f>=0;--f)C>=0&&(n[i].v.charAt(f)==="0"||n[i].v.charAt(f)==="#")&&(O=E.charAt(C--)+O);n[i].v=O,n[i].t="t",I=i}for(C>=0&&I<n.length&&(n[I].v=E.substr(0,C+1)+n[I].v),C=E.indexOf(".")+1,i=M;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==M)){for(f=n[i].v.indexOf(".")>-1&&i===M?n[i].v.indexOf(".")+1:0,O=n[i].v.substr(0,f);f<n[i].v.length;++f)C<E.length&&(O+=E.charAt(C++));n[i].v=O,n[i].t="t",I=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(R=a>1&&t<0&&i>0&&n[i-1].v==="-"?-t:t,n[i].v=Jt(n[i].t,n[i].v,R),n[i].t="t");var W="";for(i=0;i!==n.length;++i)n[i]!=null&&(W+=n[i].v);return W}var Uc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $c(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Ad(e,t){var r=Td(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Uc),c=r[1].match(Uc);return $c(t,i)?[a,r[0]]:$c(t,c)?[a,r[1]]:[a,r[i!=null&&c!=null?2:1]]}return[a,s]}function pt(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ie)[e],a==null&&(a=r.table&&r.table[Mc[e]]||Ie[Mc[e]]),a==null&&(a=cd[e]||"General");break}if(zs(a,0))return Sa(t,r);t instanceof Date&&(t=kl(t,r.date1904));var n=Ad(a,t);if(zs(n[1]))return Sa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yd(n[1],t,r,n[0])}function ya(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ie[r]==null){t<0&&(t=r);continue}if(Ie[r]==e){t=r;break}}t<0&&(t=391)}return Ie[t]=e,t}function Rl(){Ie=id()}var Sd={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Il=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Fd(e){var t=typeof e=="number"?Ie[e]:e;return t=t.replace(Il,"(\\d+)"),new RegExp("^"+t+"$")}function bd(e,t,r){var a=-1,n=-1,s=-1,i=-1,c=-1,o=-1;(t.match(Il)||[]).forEach(function(h,u){var d=parseInt(r[u+1],10);switch(h.toLowerCase().charAt(0)){case"y":a=d;break;case"d":s=d;break;case"h":i=d;break;case"s":o=d;break;case"m":i>=0?c=d:n=d;break}}),o>=0&&c==-1&&n>=0&&(c=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return i==-1&&c==-1&&o==-1?l:a==-1&&n==-1&&s==-1?f:l+"T"+f}var Cd=function(){var e={};e.version="1.2.0";function t(){for(var E=0,M=new Array(256),I=0;I!=256;++I)E=I,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,M[I]=E;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function a(E){var M=0,I=0,W=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)L[W]=E[W];for(W=0;W!=256;++W)for(I=E[W],M=256+W;M<4096;M+=256)I=L[M]=I>>>8^E[I&255];var N=[];for(W=1;W!=16;++W)N[W-1]=typeof Int32Array<"u"?L.subarray(W*256,W*256+256):L.slice(W*256,W*256+256);return N}var n=a(r),s=n[0],i=n[1],c=n[2],o=n[3],l=n[4],f=n[5],h=n[6],u=n[7],d=n[8],p=n[9],x=n[10],m=n[11],w=n[12],_=n[13],v=n[14];function C(E,M){for(var I=M^-1,W=0,L=E.length;W<L;)I=I>>>8^r[(I^E.charCodeAt(W++))&255];return~I}function O(E,M){for(var I=M^-1,W=E.length-15,L=0;L<W;)I=v[E[L++]^I&255]^_[E[L++]^I>>8&255]^w[E[L++]^I>>16&255]^m[E[L++]^I>>>24]^x[E[L++]]^p[E[L++]]^d[E[L++]]^u[E[L++]]^h[E[L++]]^f[E[L++]]^l[E[L++]]^o[E[L++]]^c[E[L++]]^i[E[L++]]^s[E[L++]]^r[E[L++]];for(W+=15;L<W;)I=I>>>8^r[(I^E[L++])&255];return~I}function R(E,M){for(var I=M^-1,W=0,L=E.length,N=0,J=0;W<L;)N=E.charCodeAt(W++),N<128?I=I>>>8^r[(I^N)&255]:N<2048?(I=I>>>8^r[(I^(192|N>>6&31))&255],I=I>>>8^r[(I^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,J=E.charCodeAt(W++)&1023,I=I>>>8^r[(I^(240|N>>8&7))&255],I=I>>>8^r[(I^(128|N>>2&63))&255],I=I>>>8^r[(I^(128|J>>6&15|(N&3)<<4))&255],I=I>>>8^r[(I^(128|J&63))&255]):(I=I>>>8^r[(I^(224|N>>12&15))&255],I=I>>>8^r[(I^(128|N>>6&63))&255],I=I>>>8^r[(I^(128|N&63))&255]);return~I}return e.table=r,e.bstr=C,e.buf=O,e.str=R,e}(),Le=function(){var t={};t.version="1.2.1";function r(g,A){for(var k=g.split("/"),T=A.split("/"),S=0,b=0,G=Math.min(k.length,T.length);S<G;++S){if(b=k[S].length-T[S].length)return b;if(k[S]!=T[S])return k[S]<T[S]?-1:1}return k.length-T.length}function a(g){if(g.charAt(g.length-1)=="/")return g.slice(0,-1).indexOf("/")===-1?g:a(g.slice(0,-1));var A=g.lastIndexOf("/");return A===-1?g:g.slice(0,A+1)}function n(g){if(g.charAt(g.length-1)=="/")return n(g.slice(0,-1));var A=g.lastIndexOf("/");return A===-1?g:g.slice(A+1)}function s(g,A){typeof A=="string"&&(A=new Date(A));var k=A.getHours();k=k<<6|A.getMinutes(),k=k<<5|A.getSeconds()>>>1,g.write_shift(2,k);var T=A.getFullYear()-1980;T=T<<4|A.getMonth()+1,T=T<<5|A.getDate(),g.write_shift(2,T)}function i(g){var A=g.read_shift(2)&65535,k=g.read_shift(2)&65535,T=new Date,S=k&31;k>>>=5;var b=k&15;k>>>=4,T.setMilliseconds(0),T.setFullYear(k+1980),T.setMonth(b-1),T.setDate(S);var G=A&31;A>>>=5;var K=A&63;return A>>>=6,T.setHours(A),T.setMinutes(K),T.setSeconds(G<<1),T}function c(g){Ir(g,0);for(var A={},k=0;g.l<=g.length-4;){var T=g.read_shift(2),S=g.read_shift(2),b=g.l+S,G={};switch(T){case 21589:k=g.read_shift(1),k&1&&(G.mtime=g.read_shift(4)),S>5&&(k&2&&(G.atime=g.read_shift(4)),k&4&&(G.ctime=g.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}g.l=b,A[T]=G}return A}var o;function l(){return o||(o={})}function f(g,A){if(g[0]==80&&g[1]==75)return lr(g,A);if((g[0]|32)==109&&(g[1]|32)==105)return mn(g,A);if(g.length<512)throw new Error("CFB file size "+g.length+" < 512");var k=3,T=512,S=0,b=0,G=0,K=0,V=0,z=[],X=g.slice(0,512);Ir(X,0);var ee=h(X);switch(k=ee[0],k){case 3:T=512;break;case 4:T=4096;break;case 0:if(ee[1]==0)return lr(g,A);default:throw new Error("Major Version: Expected 3 or 4 saw "+k)}T!==512&&(X=g.slice(0,T),Ir(X,28));var ce=g.slice(0,T);u(X,k);var pe=X.read_shift(4,"i");if(k===3&&pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pe);X.l+=4,G=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),K=X.read_shift(4,"i"),S=X.read_shift(4,"i"),V=X.read_shift(4,"i"),b=X.read_shift(4,"i");for(var ae=-1,de=0;de<109&&(ae=X.read_shift(4,"i"),!(ae<0));++de)z[de]=ae;var Re=d(g,T);m(V,b,Re,T,z);var ar=_(Re,G,z,T);ar[G].name="!Directory",S>0&&K!==J&&(ar[K].name="!MiniFAT"),ar[z[0]].name="!FAT",ar.fat_addrs=z,ar.ssz=T;var nr={},Nr=[],gn=[],vn=[];v(G,ar,Re,Nr,S,nr,gn,K),p(gn,vn,Nr),Nr.shift();var _n={FileIndex:gn,FullPaths:vn};return A&&A.raw&&(_n.raw={header:ce,sectors:Re}),_n}function h(g){if(g[g.l]==80&&g[g.l+1]==75)return[0,0];g.chk(le,"Header Signature: "),g.l+=16;var A=g.read_shift(2,"u");return[g.read_shift(2,"u"),A]}function u(g,A){var k=9;switch(g.l+=2,k=g.read_shift(2)){case 9:if(A!=3)throw new Error("Sector Shift: Expected 9 saw "+k);break;case 12:if(A!=4)throw new Error("Sector Shift: Expected 12 saw "+k);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+k)}g.chk("0600","Mini Sector Shift: "),g.chk("000000000000","Reserved: ")}function d(g,A){for(var k=Math.ceil(g.length/A)-1,T=[],S=1;S<k;++S)T[S-1]=g.slice(S*A,(S+1)*A);return T[k-1]=g.slice(k*A),T}function p(g,A,k){for(var T=0,S=0,b=0,G=0,K=0,V=k.length,z=[],X=[];T<V;++T)z[T]=X[T]=T,A[T]=k[T];for(;K<X.length;++K)T=X[K],S=g[T].L,b=g[T].R,G=g[T].C,z[T]===T&&(S!==-1&&z[S]!==S&&(z[T]=z[S]),b!==-1&&z[b]!==b&&(z[T]=z[b])),G!==-1&&(z[G]=T),S!==-1&&T!=z[T]&&(z[S]=z[T],X.lastIndexOf(S)<K&&X.push(S)),b!==-1&&T!=z[T]&&(z[b]=z[T],X.lastIndexOf(b)<K&&X.push(b));for(T=1;T<V;++T)z[T]===T&&(b!==-1&&z[b]!==b?z[T]=z[b]:S!==-1&&z[S]!==S&&(z[T]=z[S]));for(T=1;T<V;++T)if(g[T].type!==0){if(K=T,K!=z[K])do K=z[K],A[T]=A[K]+"/"+A[T];while(K!==0&&z[K]!==-1&&K!=z[K]);z[T]=-1}for(A[0]+="/",T=1;T<V;++T)g[T].type!==2&&(A[T]+="/")}function x(g,A,k){for(var T=g.start,S=g.size,b=[],G=T;k&&S>0&&G>=0;)b.push(A.slice(G*N,G*N+N)),S-=N,G=wa(k,G*4);return b.length===0?Er(0):ca(b).slice(0,g.size)}function m(g,A,k,T,S){var b=J;if(g===J){if(A!==0)throw new Error("DIFAT chain shorter than expected")}else if(g!==-1){var G=k[g],K=(T>>>2)-1;if(!G)return;for(var V=0;V<K&&(b=wa(G,V*4))!==J;++V)S.push(b);m(wa(G,T-4),A-1,k,T,S)}}function w(g,A,k,T,S){var b=[],G=[];S||(S=[]);var K=T-1,V=0,z=0;for(V=A;V>=0;){S[V]=!0,b[b.length]=V,G.push(g[V]);var X=k[Math.floor(V*4/T)];if(z=V*4&K,T<4+z)throw new Error("FAT boundary crossed: "+V+" 4 "+T);if(!g[X])break;V=wa(g[X],z)}return{nodes:b,data:Jc([G])}}function _(g,A,k,T){var S=g.length,b=[],G=[],K=[],V=[],z=T-1,X=0,ee=0,ce=0,pe=0;for(X=0;X<S;++X)if(K=[],ce=X+A,ce>=S&&(ce-=S),!G[ce]){V=[];var ae=[];for(ee=ce;ee>=0;){ae[ee]=!0,G[ee]=!0,K[K.length]=ee,V.push(g[ee]);var de=k[Math.floor(ee*4/T)];if(pe=ee*4&z,T<4+pe)throw new Error("FAT boundary crossed: "+ee+" 4 "+T);if(!g[de]||(ee=wa(g[de],pe),ae[ee]))break}b[ce]={nodes:K,data:Jc([V])}}return b}function v(g,A,k,T,S,b,G,K){for(var V=0,z=T.length?2:0,X=A[g].data,ee=0,ce=0,pe;ee<X.length;ee+=128){var ae=X.slice(ee,ee+128);Ir(ae,64),ce=ae.read_shift(2),pe=C0(ae,0,ce-z),T.push(pe);var de={name:pe,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},Re=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Re!==0&&(de.ct=C(ae,ae.l-8));var ar=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);ar!==0&&(de.mt=C(ae,ae.l-8)),de.start=ae.read_shift(4,"i"),de.size=ae.read_shift(4,"i"),de.size<0&&de.start<0&&(de.size=de.type=0,de.start=J,de.name=""),de.type===5?(V=de.start,S>0&&V!==J&&(A[V].name="!StreamData")):de.size>=4096?(de.storage="fat",A[de.start]===void 0&&(A[de.start]=w(k,de.start,A.fat_addrs,A.ssz)),A[de.start].name=de.name,de.content=A[de.start].data.slice(0,de.size)):(de.storage="minifat",de.size<0?de.size=0:V!==J&&de.start!==J&&A[V]&&(de.content=x(de,A[V].data,(A[K]||{}).data))),de.content&&Ir(de.content,0),b[pe]=de,G.push(de)}}function C(g,A){return new Date((ot(g,A+4)/1e7*Math.pow(2,32)+ot(g,A)/1e7-11644473600)*1e3)}function O(g,A){return l(),f(o.readFileSync(g),A)}function R(g,A){var k=A&&A.type;switch(k||Me&&Buffer.isBuffer(g)&&(k="buffer"),k||"base64"){case"file":return O(g,A);case"base64":return f(Tt(ft(g)),A);case"binary":return f(Tt(g),A)}return f(g,A)}function E(g,A){var k=A||{},T=k.root||"Root Entry";if(g.FullPaths||(g.FullPaths=[]),g.FileIndex||(g.FileIndex=[]),g.FullPaths.length!==g.FileIndex.length)throw new Error("inconsistent CFB structure");g.FullPaths.length===0&&(g.FullPaths[0]=T+"/",g.FileIndex[0]={name:T,type:5}),k.CLSID&&(g.FileIndex[0].clsid=k.CLSID),M(g)}function M(g){var A="Sh33tJ5";if(!Le.find(g,"/"+A)){var k=Er(4);k[0]=55,k[1]=k[3]=50,k[2]=54,g.FileIndex.push({name:A,type:2,content:k,size:4,L:69,R:69,C:69}),g.FullPaths.push(g.FullPaths[0]+A),I(g)}}function I(g,A){E(g);for(var k=!1,T=!1,S=g.FullPaths.length-1;S>=0;--S){var b=g.FileIndex[S];switch(b.type){case 0:T?k=!0:(g.FileIndex.pop(),g.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(b.R*b.L*b.C)&&(k=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(k=!0);break;default:k=!0;break}}if(!(!k&&!A)){var G=new Date(1987,1,19),K=0,V=Object.create?Object.create(null):{},z=[];for(S=0;S<g.FullPaths.length;++S)V[g.FullPaths[S]]=!0,g.FileIndex[S].type!==0&&z.push([g.FullPaths[S],g.FileIndex[S]]);for(S=0;S<z.length;++S){var X=a(z[S][0]);T=V[X],T||(z.push([X,{name:n(X).replace("/",""),type:1,clsid:oe,ct:G,mt:G,content:null}]),V[X]=!0)}for(z.sort(function(pe,ae){return r(pe[0],ae[0])}),g.FullPaths=[],g.FileIndex=[],S=0;S<z.length;++S)g.FullPaths[S]=z[S][0],g.FileIndex[S]=z[S][1];for(S=0;S<z.length;++S){var ee=g.FileIndex[S],ce=g.FullPaths[S];if(ee.name=n(ce).replace("/",""),ee.L=ee.R=ee.C=-(ee.color=1),ee.size=ee.content?ee.content.length:0,ee.start=0,ee.clsid=ee.clsid||oe,S===0)ee.C=z.length>1?1:-1,ee.size=0,ee.type=5;else if(ce.slice(-1)=="/"){for(K=S+1;K<z.length&&a(g.FullPaths[K])!=ce;++K);for(ee.C=K>=z.length?-1:K,K=S+1;K<z.length&&a(g.FullPaths[K])!=a(ce);++K);ee.R=K>=z.length?-1:K,ee.type=1}else a(g.FullPaths[S+1]||"")==a(ce)&&(ee.R=S+1),ee.type=2}}}function W(g,A){var k=A||{};if(k.fileType=="mad")return vi(g,k);switch(I(g),k.fileType){case"zip":return ra(g,k)}var T=function(pe){for(var ae=0,de=0,Re=0;Re<pe.FileIndex.length;++Re){var ar=pe.FileIndex[Re];if(ar.content){var nr=ar.content.length;nr>0&&(nr<4096?ae+=nr+63>>6:de+=nr+511>>9)}}for(var Nr=pe.FullPaths.length+3>>2,gn=ae+7>>3,vn=ae+127>>7,_n=gn+de+Nr+vn,ma=_n+127>>7,wi=ma<=109?0:Math.ceil((ma-109)/127);_n+ma+wi+127>>7>ma;)wi=++ma<=109?0:Math.ceil((ma-109)/127);var Gt=[1,wi,ma,vn,Nr,de,ae,0];return pe.FileIndex[0].size=ae<<6,Gt[7]=(pe.FileIndex[0].start=Gt[0]+Gt[1]+Gt[2]+Gt[3]+Gt[4]+Gt[5])+(Gt[6]+7>>3),Gt}(g),S=Er(T[7]<<9),b=0,G=0;{for(b=0;b<8;++b)S.write_shift(1,Z[b]);for(b=0;b<8;++b)S.write_shift(2,0);for(S.write_shift(2,62),S.write_shift(2,3),S.write_shift(2,65534),S.write_shift(2,9),S.write_shift(2,6),b=0;b<3;++b)S.write_shift(2,0);for(S.write_shift(4,0),S.write_shift(4,T[2]),S.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),S.write_shift(4,0),S.write_shift(4,4096),S.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:J),S.write_shift(4,T[3]),S.write_shift(-4,T[1]?T[0]-1:J),S.write_shift(4,T[1]),b=0;b<109;++b)S.write_shift(-4,b<T[2]?T[1]+b:-1)}if(T[1])for(G=0;G<T[1];++G){for(;b<236+G*127;++b)S.write_shift(-4,b<T[2]?T[1]+b:-1);S.write_shift(-4,G===T[1]-1?J:G+1)}var K=function(pe){for(G+=pe;b<G-1;++b)S.write_shift(-4,b+1);pe&&(++b,S.write_shift(-4,J))};for(G=b=0,G+=T[1];b<G;++b)S.write_shift(-4,Q.DIFSECT);for(G+=T[2];b<G;++b)S.write_shift(-4,Q.FATSECT);K(T[3]),K(T[4]);for(var V=0,z=0,X=g.FileIndex[0];V<g.FileIndex.length;++V)X=g.FileIndex[V],X.content&&(z=X.content.length,!(z<4096)&&(X.start=G,K(z+511>>9)));for(K(T[6]+7>>3);S.l&511;)S.write_shift(-4,Q.ENDOFCHAIN);for(G=b=0,V=0;V<g.FileIndex.length;++V)X=g.FileIndex[V],X.content&&(z=X.content.length,!(!z||z>=4096)&&(X.start=G,K(z+63>>6)));for(;S.l&511;)S.write_shift(-4,Q.ENDOFCHAIN);for(b=0;b<T[4]<<2;++b){var ee=g.FullPaths[b];if(!ee||ee.length===0){for(V=0;V<17;++V)S.write_shift(4,0);for(V=0;V<3;++V)S.write_shift(4,-1);for(V=0;V<12;++V)S.write_shift(4,0);continue}X=g.FileIndex[b],b===0&&(X.start=X.size?X.start-1:J);var ce=b===0&&k.root||X.name;if(z=2*(ce.length+1),S.write_shift(64,ce,"utf16le"),S.write_shift(2,z),S.write_shift(1,X.type),S.write_shift(1,X.color),S.write_shift(-4,X.L),S.write_shift(-4,X.R),S.write_shift(-4,X.C),X.clsid)S.write_shift(16,X.clsid,"hex");else for(V=0;V<4;++V)S.write_shift(4,0);S.write_shift(4,X.state||0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,0),S.write_shift(4,X.start),S.write_shift(4,X.size),S.write_shift(4,0)}for(b=1;b<g.FileIndex.length;++b)if(X=g.FileIndex[b],X.size>=4096)if(S.l=X.start+1<<9,Me&&Buffer.isBuffer(X.content))X.content.copy(S,S.l,0,X.size),S.l+=X.size+511&-512;else{for(V=0;V<X.size;++V)S.write_shift(1,X.content[V]);for(;V&511;++V)S.write_shift(1,0)}for(b=1;b<g.FileIndex.length;++b)if(X=g.FileIndex[b],X.size>0&&X.size<4096)if(Me&&Buffer.isBuffer(X.content))X.content.copy(S,S.l,0,X.size),S.l+=X.size+63&-64;else{for(V=0;V<X.size;++V)S.write_shift(1,X.content[V]);for(;V&63;++V)S.write_shift(1,0)}if(Me)S.l=S.length;else for(;S.l<S.length;)S.write_shift(1,0);return S}function L(g,A){var k=g.FullPaths.map(function(V){return V.toUpperCase()}),T=k.map(function(V){var z=V.split("/");return z[z.length-(V.slice(-1)=="/"?2:1)]}),S=!1;A.charCodeAt(0)===47?(S=!0,A=k[0].slice(0,-1)+A):S=A.indexOf("/")!==-1;var b=A.toUpperCase(),G=S===!0?k.indexOf(b):T.indexOf(b);if(G!==-1)return g.FileIndex[G];var K=!b.match(En);for(b=b.replace(Zr,""),K&&(b=b.replace(En,"!")),G=0;G<k.length;++G)if((K?k[G].replace(En,"!"):k[G]).replace(Zr,"")==b||(K?T[G].replace(En,"!"):T[G]).replace(Zr,"")==b)return g.FileIndex[G];return null}var N=64,J=-2,le="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(g,A,k){l();var T=W(g,k);o.writeFileSync(A,T)}function U(g){for(var A=new Array(g.length),k=0;k<g.length;++k)A[k]=String.fromCharCode(g[k]);return A.join("")}function ve(g,A){var k=W(g,A);switch(A&&A.type||"buffer"){case"file":return l(),o.writeFileSync(A.filename,k),k;case"binary":return typeof k=="string"?k:U(k);case"base64":return Oc(typeof k=="string"?k:U(k));case"buffer":if(Me)return Buffer.isBuffer(k)?k:Oa(k);case"array":return typeof k=="string"?Tt(k):k}return k}var ge;function F(g){try{var A=g.InflateRaw,k=new A;if(k._processChunk(new Uint8Array([3,0]),k._finishFlushFlag),k.bytesRead)ge=g;else throw new Error("zlib does not expose bytesRead")}catch(T){console.error("cannot use native zlib: "+(T.message||T))}}function B(g,A){if(!ge)return pa(g,A);var k=ge.InflateRaw,T=new k,S=T._processChunk(g.slice(g.l),T._finishFlushFlag);return g.l+=T.bytesRead,S}function P(g){return ge?ge.deflateRawSync(g):Te(g)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(g){var A=(g<<1|g<<11)&139536|(g<<5|g<<15)&558144;return(A>>16|A>>8|A)&255}for(var te=typeof Uint8Array<"u",H=te?new Uint8Array(256):[],se=0;se<256;++se)H[se]=ie(se);function y(g,A){var k=H[g&255];return A<=8?k>>>8-A:(k=k<<8|H[g>>8&255],A<=16?k>>>16-A:(k=k<<8|H[g>>16&255],k>>>24-A))}function _e(g,A){var k=A&7,T=A>>>3;return(g[T]|(k<=6?0:g[T+1]<<8))>>>k&3}function he(g,A){var k=A&7,T=A>>>3;return(g[T]|(k<=5?0:g[T+1]<<8))>>>k&7}function we(g,A){var k=A&7,T=A>>>3;return(g[T]|(k<=4?0:g[T+1]<<8))>>>k&15}function me(g,A){var k=A&7,T=A>>>3;return(g[T]|(k<=3?0:g[T+1]<<8))>>>k&31}function q(g,A){var k=A&7,T=A>>>3;return(g[T]|(k<=1?0:g[T+1]<<8))>>>k&127}function Se(g,A,k){var T=A&7,S=A>>>3,b=(1<<k)-1,G=g[S]>>>T;return k<8-T||(G|=g[S+1]<<8-T,k<16-T)||(G|=g[S+2]<<16-T,k<24-T)||(G|=g[S+3]<<24-T),G&b}function He(g,A,k){var T=A&7,S=A>>>3;return T<=5?g[S]|=(k&7)<<T:(g[S]|=k<<T&255,g[S+1]=(k&7)>>8-T),A+3}function Pe(g,A,k){var T=A&7,S=A>>>3;return k=(k&1)<<T,g[S]|=k,A+1}function Ke(g,A,k){var T=A&7,S=A>>>3;return k<<=T,g[S]|=k&255,k>>>=8,g[S+1]=k,A+8}function cr(g,A,k){var T=A&7,S=A>>>3;return k<<=T,g[S]|=k&255,k>>>=8,g[S+1]=k&255,g[S+2]=k>>>8,A+16}function Qe(g,A){var k=g.length,T=2*k>A?2*k:A+5,S=0;if(k>=A)return g;if(Me){var b=Dc(T);if(g.copy)g.copy(b);else for(;S<g.length;++S)b[S]=g[S];return b}else if(te){var G=new Uint8Array(T);if(G.set)G.set(g);else for(;S<k;++S)G[S]=g[S];return G}return g.length=T,g}function qe(g){for(var A=new Array(g),k=0;k<g;++k)A[k]=0;return A}function hr(g,A,k){var T=1,S=0,b=0,G=0,K=0,V=g.length,z=te?new Uint16Array(32):qe(32);for(b=0;b<32;++b)z[b]=0;for(b=V;b<k;++b)g[b]=0;V=g.length;var X=te?new Uint16Array(V):qe(V);for(b=0;b<V;++b)z[S=g[b]]++,T<S&&(T=S),X[b]=0;for(z[0]=0,b=1;b<=T;++b)z[b+16]=K=K+z[b-1]<<1;for(b=0;b<V;++b)K=g[b],K!=0&&(X[b]=z[K+16]++);var ee=0;for(b=0;b<V;++b)if(ee=g[b],ee!=0)for(K=y(X[b],T)>>T-ee,G=(1<<T+4-ee)-1;G>=0;--G)A[K|G<<ee]=ee&15|b<<4;return T}var tr=te?new Uint16Array(512):qe(512),zr=te?new Uint16Array(32):qe(32);if(!te){for(var or=0;or<512;++or)tr[or]=0;for(or=0;or<32;++or)zr[or]=0}(function(){for(var g=[],A=0;A<32;A++)g.push(5);hr(g,zr,32);var k=[];for(A=0;A<=143;A++)k.push(8);for(;A<=255;A++)k.push(9);for(;A<=279;A++)k.push(7);for(;A<=287;A++)k.push(8);hr(k,tr,288)})();var pr=function(){for(var A=te?new Uint8Array(32768):[],k=0,T=0;k<re.length-1;++k)for(;T<re[k+1];++T)A[T]=k;for(;T<32768;++T)A[T]=29;var S=te?new Uint8Array(259):[];for(k=0,T=0;k<Y.length-1;++k)for(;T<Y[k+1];++T)S[T]=k;function b(K,V){for(var z=0;z<K.length;){var X=Math.min(65535,K.length-z),ee=z+X==K.length;for(V.write_shift(1,+ee),V.write_shift(2,X),V.write_shift(2,~X&65535);X-- >0;)V[V.l++]=K[z++]}return V.l}function G(K,V){for(var z=0,X=0,ee=te?new Uint16Array(32768):[];X<K.length;){var ce=Math.min(65535,K.length-X);if(ce<10){for(z=He(V,z,+(X+ce==K.length)),z&7&&(z+=8-(z&7)),V.l=z/8|0,V.write_shift(2,ce),V.write_shift(2,~ce&65535);ce-- >0;)V[V.l++]=K[X++];z=V.l*8;continue}z=He(V,z,+(X+ce==K.length)+2);for(var pe=0;ce-- >0;){var ae=K[X];pe=(pe<<5^ae)&32767;var de=-1,Re=0;if((de=ee[pe])&&(de|=X&-32768,de>X&&(de-=32768),de<X))for(;K[de+Re]==K[X+Re]&&Re<250;)++Re;if(Re>2){ae=S[Re],ae<=22?z=Ke(V,z,H[ae+1]>>1)-1:(Ke(V,z,3),z+=5,Ke(V,z,H[ae-23]>>5),z+=3);var ar=ae<8?0:ae-4>>2;ar>0&&(cr(V,z,Re-Y[ae]),z+=ar),ae=A[X-de],z=Ke(V,z,H[ae]>>3),z-=3;var nr=ae<4?0:ae-2>>1;nr>0&&(cr(V,z,X-de-re[ae]),z+=nr);for(var Nr=0;Nr<Re;++Nr)ee[pe]=X&32767,pe=(pe<<5^K[X])&32767,++X;ce-=Re-1}else ae<=143?ae=ae+48:z=Pe(V,z,1),z=Ke(V,z,H[ae]),ee[pe]=X&32767,++X}z=Ke(V,z,0)-1}return V.l=(z+7)/8|0,V.l}return function(V,z){return V.length<8?b(V,z):G(V,z)}}();function Te(g){var A=Er(50+Math.floor(g.length*1.1)),k=pr(g,A);return A.slice(0,k)}var We=te?new Uint16Array(32768):qe(32768),Ar=te?new Uint16Array(32768):qe(32768),er=te?new Uint16Array(128):qe(128),st=1,Wt=1;function Ua(g,A){var k=me(g,A)+257;A+=5;var T=me(g,A)+1;A+=5;var S=we(g,A)+4;A+=4;for(var b=0,G=te?new Uint8Array(19):qe(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,z=te?new Uint8Array(8):qe(8),X=te?new Uint8Array(8):qe(8),ee=G.length,ce=0;ce<S;++ce)G[D[ce]]=b=he(g,A),V<b&&(V=b),z[b]++,A+=3;var pe=0;for(z[0]=0,ce=1;ce<=V;++ce)X[ce]=pe=pe+z[ce-1]<<1;for(ce=0;ce<ee;++ce)(pe=G[ce])!=0&&(K[ce]=X[pe]++);var ae=0;for(ce=0;ce<ee;++ce)if(ae=G[ce],ae!=0){pe=H[K[ce]]>>8-ae;for(var de=(1<<7-ae)-1;de>=0;--de)er[pe|de<<ae]=ae&7|ce<<3}var Re=[];for(V=1;Re.length<k+T;)switch(pe=er[q(g,A)],A+=pe&7,pe>>>=3){case 16:for(b=3+_e(g,A),A+=2,pe=Re[Re.length-1];b-- >0;)Re.push(pe);break;case 17:for(b=3+he(g,A),A+=3;b-- >0;)Re.push(0);break;case 18:for(b=11+q(g,A),A+=7;b-- >0;)Re.push(0);break;default:Re.push(pe),V<pe&&(V=pe);break}var ar=Re.slice(0,k),nr=Re.slice(k);for(ce=k;ce<286;++ce)ar[ce]=0;for(ce=T;ce<30;++ce)nr[ce]=0;return st=hr(ar,We,286),Wt=hr(nr,Ar,30),A}function $a(g,A){if(g[0]==3&&!(g[1]&3))return[ua(A),2];for(var k=0,T=0,S=Dc(A||1<<18),b=0,G=S.length>>>0,K=0,V=0;!(T&1);){if(T=he(g,k),k+=3,T>>>1)T>>1==1?(K=9,V=5):(k=Ua(g,k),K=st,V=Wt);else{k&7&&(k+=8-(k&7));var z=g[k>>>3]|g[(k>>>3)+1]<<8;if(k+=32,z>0)for(!A&&G<b+z&&(S=Qe(S,b+z),G=S.length);z-- >0;)S[b++]=g[k>>>3],k+=8;continue}for(;;){!A&&G<b+32767&&(S=Qe(S,b+32767),G=S.length);var X=Se(g,k,K),ee=T>>>1==1?tr[X]:We[X];if(k+=ee&15,ee>>>=4,!(ee>>>8&255))S[b++]=ee;else{if(ee==256)break;ee-=257;var ce=ee<8?0:ee-4>>2;ce>5&&(ce=0);var pe=b+Y[ee];ce>0&&(pe+=Se(g,k,ce),k+=ce),X=Se(g,k,V),ee=T>>>1==1?zr[X]:Ar[X],k+=ee&15,ee>>>=4;var ae=ee<4?0:ee-2>>1,de=re[ee];for(ae>0&&(de+=Se(g,k,ae),k+=ae),!A&&G<pe&&(S=Qe(S,pe+100),G=S.length);b<pe;)S[b]=S[b-de],++b}}}return A?[S,k+7>>>3]:[S.slice(0,b),k+7>>>3]}function pa(g,A){var k=g.slice(g.l||0),T=$a(k,A);return g.l+=T[1],T[0]}function ea(g,A){if(g)typeof console<"u"&&console.error(A);else throw new Error(A)}function lr(g,A){var k=g;Ir(k,0);var T=[],S=[],b={FileIndex:T,FullPaths:S};E(b,{root:A.root});for(var G=k.length-4;(k[G]!=80||k[G+1]!=75||k[G+2]!=5||k[G+3]!=6)&&G>=0;)--G;k.l=G+4,k.l+=4;var K=k.read_shift(2);k.l+=6;var V=k.read_shift(4);for(k.l=V,G=0;G<K;++G){k.l+=20;var z=k.read_shift(4),X=k.read_shift(4),ee=k.read_shift(2),ce=k.read_shift(2),pe=k.read_shift(2);k.l+=8;var ae=k.read_shift(4),de=c(k.slice(k.l+ee,k.l+ee+ce));k.l+=ee+ce+pe;var Re=k.l;k.l=ae+4,Xr(k,z,X,b,de),k.l=Re}return b}function Xr(g,A,k,T,S){g.l+=2;var b=g.read_shift(2),G=g.read_shift(2),K=i(g);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var V=g.read_shift(4),z=g.read_shift(4),X=g.read_shift(4),ee=g.read_shift(2),ce=g.read_shift(2),pe="",ae=0;ae<ee;++ae)pe+=String.fromCharCode(g[g.l++]);if(ce){var de=c(g.slice(g.l,g.l+ce));(de[21589]||{}).mt&&(K=de[21589].mt),((S||{})[21589]||{}).mt&&(K=S[21589].mt)}g.l+=ce;var Re=g.slice(g.l,g.l+z);switch(G){case 8:Re=B(g,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var ar=!1;b&8&&(V=g.read_shift(4),V==134695760&&(V=g.read_shift(4),ar=!0),z=g.read_shift(4),X=g.read_shift(4)),z!=A&&ea(ar,"Bad compressed size: "+A+" != "+z),X!=k&&ea(ar,"Bad uncompressed size: "+k+" != "+X),Vt(T,pe,Re,{unsafe:!0,mt:K})}function ra(g,A){var k=A||{},T=[],S=[],b=Er(1),G=k.compression?8:0,K=0,V=0,z=0,X=0,ee=0,ce=g.FullPaths[0],pe=ce,ae=g.FileIndex[0],de=[],Re=0;for(V=1;V<g.FullPaths.length;++V)if(pe=g.FullPaths[V].slice(ce.length),ae=g.FileIndex[V],!(!ae.size||!ae.content||pe=="Sh33tJ5")){var ar=X,nr=Er(pe.length);for(z=0;z<pe.length;++z)nr.write_shift(1,pe.charCodeAt(z)&127);nr=nr.slice(0,nr.l),de[ee]=Cd.buf(ae.content,0);var Nr=ae.content;G==8&&(Nr=P(Nr)),b=Er(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,K),b.write_shift(2,G),ae.mt?s(b,ae.mt):b.write_shift(4,0),b.write_shift(-4,de[ee]),b.write_shift(4,Nr.length),b.write_shift(4,ae.content.length),b.write_shift(2,nr.length),b.write_shift(2,0),X+=b.length,T.push(b),X+=nr.length,T.push(nr),X+=Nr.length,T.push(Nr),b=Er(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,K),b.write_shift(2,G),b.write_shift(4,0),b.write_shift(-4,de[ee]),b.write_shift(4,Nr.length),b.write_shift(4,ae.content.length),b.write_shift(2,nr.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,ar),Re+=b.l,S.push(b),Re+=nr.length,S.push(nr),++ee}return b=Er(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,ee),b.write_shift(2,ee),b.write_shift(4,Re),b.write_shift(4,X),b.write_shift(2,0),ca([ca(T),ca(S),b])}var gt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ta(g,A){if(g.ctype)return g.ctype;var k=g.name||"",T=k.match(/\.([^\.]+)$/);return T&&gt[T[1]]||A&&(T=(k=A).match(/[\.\\]([^\.\\])+$/),T&&gt[T[1]])?gt[T[1]]:"application/octet-stream"}function mi(g){for(var A=Oc(g),k=[],T=0;T<A.length;T+=76)k.push(A.slice(T,T+76));return k.join(`\r
`)+`\r
`}function Ha(g){var A=g.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(z){var X=z.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});A=A.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),A.charAt(0)==`
`&&(A="=0D"+A.slice(1)),A=A.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var k=[],T=A.split(`\r
`),S=0;S<T.length;++S){var b=T[S];if(b.length==0){k.push("");continue}for(var G=0;G<b.length;){var K=76,V=b.slice(G,G+K);V.charAt(K-1)=="="?K--:V.charAt(K-2)=="="?K-=2:V.charAt(K-3)=="="&&(K-=3),V=b.slice(G,G+K),G+=K,G<b.length&&(V+="="),k.push(V)}}return k.join(`\r
`)}function pn(g){for(var A=[],k=0;k<g.length;++k){for(var T=g[k];k<=g.length&&T.charAt(T.length-1)=="=";)T=T.slice(0,T.length-1)+g[++k];A.push(T)}for(var S=0;S<A.length;++S)A[S]=A[S].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return Tt(A.join(`\r
`))}function gi(g,A,k){for(var T="",S="",b="",G,K=0;K<10;++K){var V=A[K];if(!V||V.match(/^\s*$/))break;var z=V.match(/^(.*?):\s*([^\s].*)$/);if(z)switch(z[1].toLowerCase()){case"content-location":T=z[2].trim();break;case"content-type":b=z[2].trim();break;case"content-transfer-encoding":S=z[2].trim();break}}switch(++K,S.toLowerCase()){case"base64":G=Tt(ft(A.slice(K).join("")));break;case"quoted-printable":G=pn(A.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+S)}var X=Vt(g,T.slice(k.length),G,{unsafe:!0});b&&(X.ctype=b)}function mn(g,A){if(U(g.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var k=A&&A.root||"",T=(Me&&Buffer.isBuffer(g)?g.toString("binary"):U(g)).split(`\r
`),S=0,b="";for(S=0;S<T.length;++S)if(b=T[S],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),k||(k=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,k.length)!=k))for(;k.length>0&&(k=k.slice(0,k.length-1),k=k.slice(0,k.lastIndexOf("/")+1),b.slice(0,k.length)!=k););var G=(T[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var K="--"+(G[1]||""),V=[],z=[],X={FileIndex:V,FullPaths:z};E(X);var ee,ce=0;for(S=0;S<T.length;++S){var pe=T[S];pe!==K&&pe!==K+"--"||(ce++&&gi(X,T.slice(ee,S),k),ee=S)}return X}function vi(g,A){var k=A||{},T=k.boundary||"SheetJS";T="------="+T;for(var S=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+T.slice(2)+'"',"","",""],b=g.FullPaths[0],G=b,K=g.FileIndex[0],V=1;V<g.FullPaths.length;++V)if(G=g.FullPaths[V].slice(b.length),K=g.FileIndex[V],!(!K.size||!K.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Re){return"_x"+Re.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Re){return"_u"+Re.charCodeAt(0).toString(16)+"_"});for(var z=K.content,X=Me&&Buffer.isBuffer(z)?z.toString("binary"):U(z),ee=0,ce=Math.min(1024,X.length),pe=0,ae=0;ae<=ce;++ae)(pe=X.charCodeAt(ae))>=32&&pe<128&&++ee;var de=ee>=ce*4/5;S.push(T),S.push("Content-Location: "+(k.root||"file:///C:/SheetJS/")+G),S.push("Content-Transfer-Encoding: "+(de?"quoted-printable":"base64")),S.push("Content-Type: "+ta(K,G)),S.push(""),S.push(de?Ha(X):mi(X))}return S.push(T+`--\r
`),S.join(`\r
`)}function ps(g){var A={};return E(A,g),A}function Vt(g,A,k,T){var S=T&&T.unsafe;S||E(g);var b=!S&&Le.find(g,A);if(!b){var G=g.FullPaths[0];A.slice(0,G.length)==G?G=A:(G.slice(-1)!="/"&&(G+="/"),G=(G+A).replace("//","/")),b={name:n(A),type:2},g.FileIndex.push(b),g.FullPaths.push(G),S||Le.utils.cfb_gc(g)}return b.content=k,b.size=k?k.length:0,T&&(T.CLSID&&(b.clsid=T.CLSID),T.mt&&(b.mt=T.mt),T.ct&&(b.ct=T.ct)),b}function _i(g,A){E(g);var k=Le.find(g,A);if(k){for(var T=0;T<g.FileIndex.length;++T)if(g.FileIndex[T]==k)return g.FileIndex.splice(T,1),g.FullPaths.splice(T,1),!0}return!1}function hh(g,A,k){E(g);var T=Le.find(g,A);if(T){for(var S=0;S<g.FileIndex.length;++S)if(g.FileIndex[S]==T)return g.FileIndex[S].name=n(k),g.FullPaths[S]=k,!0}return!1}function dh(g){I(g,!0)}return t.find=L,t.read=R,t.parse=f,t.write=ve,t.writeFile=ye,t.utils={cfb_new:ps,cfb_add:Vt,cfb_del:_i,cfb_mov:hh,cfb_gc:dh,ReadShift:On,CheckField:Ql,prep_blob:Ir,bconcat:ca,use_zlib:F,_deflateRaw:Te,_inflateRaw:pa,consts:Q},t}();function Rd(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Ut(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function A0(e){for(var t=[],r=Ut(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}var js=new Date(1899,11,30,0,0,0);function Qr(e,t){var r=e.getTime(),a=js.getTime()+(e.getTimezoneOffset()-js.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var Ol=new Date,Id=js.getTime()+(Ol.getTimezoneOffset()-js.getTimezoneOffset())*6e4,Hc=Ol.getTimezoneOffset();function oi(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Id),t.getTimezoneOffset()!==Hc&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Hc)*6e4),t}function Od(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[s],10)}return t}var Wc=new Date("2017-02-19T19:06:09.000Z"),Dl=isNaN(Wc.getFullYear())?new Date("2/19/17"):Wc,Dd=Dl.getFullYear()==2017;function Cr(e,t){var r=new Date(e);if(Dd)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Dl.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Fa(e,t){if(Me&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return yn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return yn(_l(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return yn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return yn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Or(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Or(e[r]));return t}function fr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ct(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var Pd=["january","february","march","april","may","june","july","august","september","october","november","december"];function sn(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Pd.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Nd=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var s=r.split(a),i=[s[0]],c=1;c<s.length;++c)i.push(n),i.push(s[c]);return i}}();function Pl(e){return e?e.content&&e.type?Fa(e.content,!0):e.data?kn(e.data):e.asNodeBuffer&&Me?kn(e.asNodeBuffer().toString("binary")):e.asBinary?kn(e.asBinary()):e._data&&e._data.getContent?kn(Fa(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Nl(e){if(!e)return null;if(e.data)return Rc(e.data);if(e.asNodeBuffer&&Me)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Rc(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Md(e){return e&&e.name.slice(-4)===".bin"?Nl(e):Pl(e)}function xt(e,t){for(var r=e.FullPaths||Ut(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function S0(e,t){var r=xt(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function gr(e,t,r){if(!r)return Md(S0(e,t));if(!t)return null;try{return gr(e,t)}catch{return null}}function lt(e,t,r){if(!r)return Pl(S0(e,t));if(!t)return null;try{return lt(e,t)}catch{return null}}function Ld(e,t,r){return Nl(S0(e,t))}function Vc(e){for(var t=e.FullPaths||Ut(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Bd(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Me?a=Oa(r):a=ad(r),Le.utils.cfb_add(e,t,a)}Le.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ml(e,t){switch(t.type){case"base64":return Le.read(e,{type:"base64"});case"binary":return Le.read(e,{type:"binary"});case"buffer":case"array":return Le.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Tn(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Ll=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Ud=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Gc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$d=/<[^>]*>/g,Gr=Ll.match(Gc)?Gc:$d,Hd=/<\w*:/,Wd=/<(\/?)\w+:/;function Ae(e,t,r){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(Ud),c=0,o="",l=0,f="",h="",u=1;if(i)for(l=0;l!=i.length;++l){for(h=i[l],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(u=(n=h.charCodeAt(s+1))==34||n==39?1:0,o=h.slice(s+1+u,h.length-u),c=0;c!=f.length&&f.charCodeAt(c)!==58;++c);if(c===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=o,a[f.toLowerCase()]=o;else{var d=(c===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(c+1);if(a[d]&&f.slice(c-3,c)=="ext")continue;a[d]=o,a[d.toLowerCase()]=o}}return a}function $t(e){return e.replace(Wd,"<$1")}var Bl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Vd=A0(Bl),$e=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(c,o){return Bl[c]||String.fromCharCode(parseInt(o,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,o){return String.fromCharCode(parseInt(o,16))});var i=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,i)+r(n.slice(i+3))}}(),Gd=/[&<>'"]/g,zd=/[\u0000-\u001f]/g;function F0(e){var t=e+"";return t.replace(Gd,function(r){return Vd[r]}).replace(/\n/g,"<br/>").replace(zd,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var zc=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function rr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ai(e){for(var t="",r=0,a=0,n=0,s=0,i=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){i=(a&31)<<6,i|=n&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}i=e.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function Xc(e){var t=ua(2*e.length),r,a,n=1,s=0,i=0,c;for(a=0;a<e.length;a+=n)n=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function jc(e){return Oa(e,"binary").toString("utf8")}var ws="foo bar bazâð£",Ze=Me&&(jc(ws)==Ai(ws)&&jc||Xc(ws)==Ai(ws)&&Xc)||Ai,yn=Me?function(e){return Oa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},zn=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),Ul=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),Xd=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),jd=/<\/?(?:vt:)?variant>/g,Kd=/<(?:vt:)([^>]*)>([\s\S]*)</;function Kc(e,t){var r=Ae(e),a=e.match(Xd(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var i=s.replace(jd,"").match(Kd);i&&n.push({v:Ze(i[2]),t:i[1]})}),n}var Yd=/(^\s|\s$|\n)/;function Jd(e){return Ut(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function qd(e,t,r){return"<"+e+(r!=null?Jd(r):"")+(t!=null?(t.match(Yd)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function b0(e){if(Me&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ze(Da(E0(e)));throw new Error("Bad input format: expected Buffer or string")}var Xn=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zd={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Qd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function e1(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function r1(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,i=a?-t:t;isFinite(i)?i==0?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var c=0;c<=5;++c,s/=256)e[r+c]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var Yc=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Jc=Me?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Oa(t)})):Yc(e)}:Yc,qc=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Yt(e,n)));return a.join("").replace(Zr,"")},C0=Me?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zr,""):qc(e,t,r)}:qc,Zc=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},$l=Me?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Zc(e,t,r)}:Zc,Qc=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(ja(e,n)));return a.join("")},ns=Me?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Qc(t,r,a)}:Qc,Hl=function(e,t){var r=ot(e,t);return r>0?ns(e,t+4,t+4+r-1):""},Wl=Hl,Vl=function(e,t){var r=ot(e,t);return r>0?ns(e,t+4,t+4+r-1):""},Gl=Vl,zl=function(e,t){var r=2*ot(e,t);return r>0?ns(e,t+4,t+4+r-1):""},Xl=zl,jl=function(t,r){var a=ot(t,r);return a>0?C0(t,r+4,r+4+a):""},Kl=jl,Yl=function(e,t){var r=ot(e,t);return r>0?ns(e,t+4,t+4+r):""},Jl=Yl,ql=function(e,t){return e1(e,t)},Ks=ql,Zl=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Me&&(Wl=function(t,r){if(!Buffer.isBuffer(t))return Hl(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Gl=function(t,r){if(!Buffer.isBuffer(t))return Vl(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Xl=function(t,r){if(!Buffer.isBuffer(t))return zl(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Kl=function(t,r){if(!Buffer.isBuffer(t))return jl(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Jl=function(t,r){if(!Buffer.isBuffer(t))return Yl(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},Ks=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):ql(t,r)},Zl=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ja=function(e,t){return e[t]},Yt=function(e,t){return e[t+1]*256+e[t]},t1=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ot=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},wa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},a1=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function On(e,t){var r="",a,n,s=[],i,c,o,l;switch(t){case"dbcs":if(l=this.l,Me&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode(Yt(this,l)),l+=2;e*=2;break;case"utf8":r=ns(this,this.l,this.l+e);break;case"utf16le":e*=2,r=C0(this,this.l,this.l+e);break;case"wstr":return On.call(this,e,"dbcs");case"lpstr-ansi":r=Wl(this,this.l),e=4+ot(this,this.l);break;case"lpstr-cp":r=Gl(this,this.l),e=4+ot(this,this.l);break;case"lpwstr":r=Xl(this,this.l),e=4+2*ot(this,this.l);break;case"lpp4":e=4+ot(this,this.l),r=Kl(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ot(this,this.l),r=Jl(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=ja(this,this.l+e++))!==0;)s.push(_s(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Yt(this,this.l+e))!==0;)s.push(_s(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(l)!==-1)return i=ja(this,l),this.l=l+1,c=On.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(_s(Yt(this,l))),l+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(l)!==-1)return i=ja(this,l),this.l=l+1,c=On.call(this,e-o,i?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(_s(ja(this,l))),l+=1}r=s.join("");break;default:switch(e){case 1:return a=ja(this,this.l),this.l++,a;case 2:return a=(t==="i"?t1:Yt)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?wa:a1)(this,this.l),this.l+=4,a):(n=ot(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Ks(this,this.l):n=Ks([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=$l(this,this.l,e);break}}return this.l+=e,r}var n1=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},s1=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},i1=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function c1(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)i1(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var i=t.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,n1(this,t,this.l);break;case 8:if(a=8,r==="f"){r1(this,t,this.l);break}case 16:break;case-4:a=4,s1(this,t,this.l);break}return this.l+=a,this}function Ql(e,t){var r=$l(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ir(e,t){e.l=t,e.read_shift=On,e.chk=Ql,e.write_shift=c1}function Vr(e,t){e.l+=t}function Er(e){var t=ua(e);return Ir(t,0),t}function Qt(e,t,r){if(e){var a,n,s;Ir(e,e.l||0);for(var i=e.length,c=0,o=0;e.l<i;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var l=ei[c]||ei[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;o=e.l+s;var f=l.f&&l.f(e,s,r);if(e.l=o,t(f,l,c))return}}}function Gi(){var e=[],t=Me?256:2048,r=function(l){var f=Er(l);return Ir(f,0),f},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(l){return a&&l<a.length-a.l?a:(n(),a=r(Math.max(l+1,t)))},i=function(){return n(),ca(e)},c=function(l){n(),a=l,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:c,end:i,_bufs:e}}function Dn(e,t,r){var a=Or(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function eo(e,t,r){var a=Or(e);return a.s=Dn(a.s,t.s,r),a.e=Dn(a.e,t.s,r),a}function Pn(e,t){if(e.cRel&&e.c<0)for(e=Or(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Or(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ce(e);return!e.cRel&&e.cRel!=null&&(r=f1(r)),!e.rRel&&e.rRel!=null&&(r=o1(r)),r}function Si(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Tr(e.s.c)+":"+(e.e.cRel?"":"$")+Tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dr(e.s.r)+":"+(e.e.rRel?"":"$")+Dr(e.e.r):Pn(e.s,t.biff)+":"+Pn(e.e,t.biff)}function R0(e){return parseInt(l1(e),10)-1}function Dr(e){return""+(e+1)}function o1(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function l1(e){return e.replace(/\$(\d+)$/,"$1")}function I0(e){for(var t=u1(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Tr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function f1(e){return e.replace(/^([A-Z])/,"$$$1")}function u1(e){return e.replace(/^\$([A-Z])/,"$1")}function h1(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ce(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function fn(e){var t=e.indexOf(":");return t==-1?{s:qr(e),e:qr(e)}:{s:qr(e.slice(0,t)),e:qr(e.slice(t+1))}}function Be(e,t){return typeof t>"u"||typeof t=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Ce(e)),typeof t!="string"&&(t=Ce(t)),e==t?e:e+":"+t)}function ur(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function ro(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=pt(e.z,r?Qr(t):t)}catch{}try{return e.w=pt((e.XF||{}).numFmtId||(r?14:0),r?Qr(t):t)}catch{return""+t}}function Zt(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ma[e.v]||e.v:t==null?ro(e,e.v):ro(e,t))}function da(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function ef(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),i=0,c=0;if(s&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var o=typeof a.origin=="string"?qr(a.origin):a.origin;i=o.r,c=o.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=ur(s["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),i==-1&&(l.e.r=i=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[h].length;++u)if(!(typeof t[h][u]>"u")){var d={v:t[h][u]},p=i+h,x=c+u;if(l.s.r>p&&(l.s.r=p),l.s.c>x&&(l.s.c=x),l.e.r<p&&(l.e.r=p),l.e.c<x&&(l.e.c=x),t[h][u]&&typeof t[h][u]=="object"&&!Array.isArray(t[h][u])&&!(t[h][u]instanceof Date))d=t[h][u];else if(Array.isArray(d.v)&&(d.f=t[h][u][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(a.nullError)d.t="e",d.v=0;else if(a.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=a.dateNF||Ie[14],a.cellDates?(d.t="d",d.w=pt(d.z,Qr(d.v))):(d.t="n",d.v=Qr(d.v),d.w=pt(d.z,d.v))):d.t="s";if(n)s[p]||(s[p]=[]),s[p][x]&&s[p][x].z&&(d.z=s[p][x].z),s[p][x]=d;else{var m=Ce({c:x,r:p});s[m]&&s[m].z&&(d.z=s[m].z),s[m]=d}}}return l.s.c<1e7&&(s["!ref"]=Be(l)),s}function un(e,t){return ef(null,e,t)}function d1(e){return e.read_shift(4,"i")}function Wr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function x1(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function O0(e,t){var r=e.l,a=e.read_shift(1),n=Wr(e),s=[],i={t:n,h:n};if(a&1){for(var c=e.read_shift(4),o=0;o!=c;++o)s.push(x1(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var p1=O0;function mt(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Pa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var m1=Wr;function D0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var g1=Wr,zi=D0;function P0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?Ks([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):wa(t,0)>>2;return r?n/100:n}function rf(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Na=rf;function $r(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function v1(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),c=e.read_shift(1),o=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var l=Aa[n];l&&(t.rgb=Kn(l));break;case 2:t.rgb=Kn([i,c,o]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function _1(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function tf(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function w1(e){return tf(e,1)}function k1(e){return tf(e,2)}var N0=2,rt=3,ks=11,to=12,Ys=19,Es=64,E1=65,T1=71,y1=4108,A1=4126,Fr=80,af=81,S1=[Fr,af],F1={1:{n:"CodePage",t:N0},2:{n:"Category",t:Fr},3:{n:"PresentationFormat",t:Fr},4:{n:"ByteCount",t:rt},5:{n:"LineCount",t:rt},6:{n:"ParagraphCount",t:rt},7:{n:"SlideCount",t:rt},8:{n:"NoteCount",t:rt},9:{n:"HiddenCount",t:rt},10:{n:"MultimediaClipCount",t:rt},11:{n:"ScaleCrop",t:ks},12:{n:"HeadingPairs",t:y1},13:{n:"TitlesOfParts",t:A1},14:{n:"Manager",t:Fr},15:{n:"Company",t:Fr},16:{n:"LinksUpToDate",t:ks},17:{n:"CharacterCount",t:rt},19:{n:"SharedDoc",t:ks},22:{n:"HyperlinksChanged",t:ks},23:{n:"AppVersion",t:rt,p:"version"},24:{n:"DigSig",t:E1},26:{n:"ContentType",t:Fr},27:{n:"ContentStatus",t:Fr},28:{n:"Language",t:Fr},29:{n:"Version",t:Fr},255:{},2147483648:{n:"Locale",t:Ys},2147483651:{n:"Behavior",t:Ys},1919054434:{}},b1={1:{n:"CodePage",t:N0},2:{n:"Title",t:Fr},3:{n:"Subject",t:Fr},4:{n:"Author",t:Fr},5:{n:"Keywords",t:Fr},6:{n:"Comments",t:Fr},7:{n:"Template",t:Fr},8:{n:"LastAuthor",t:Fr},9:{n:"RevNumber",t:Fr},10:{n:"EditTime",t:Es},11:{n:"LastPrinted",t:Es},12:{n:"CreatedDate",t:Es},13:{n:"ModifiedDate",t:Es},14:{n:"PageCount",t:rt},15:{n:"WordCount",t:rt},16:{n:"CharCount",t:rt},17:{n:"Thumbnail",t:T1},18:{n:"Application",t:Fr},19:{n:"DocSecurity",t:rt},255:{},2147483648:{n:"Locale",t:Ys},2147483651:{n:"Behavior",t:Ys},1919054434:{}},ao={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},C1=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function R1(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var I1=R1([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Aa=Or(I1),Ma={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nf={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},no={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function O1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function D1(e){var t=O1();if(!e||!e.match)return t;var r={};if((e.match(Gr)||[]).forEach(function(a){var n=Ae(a);switch(n[0].replace(Hd,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[no[n.ContentType]]!==void 0&&t[no[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Zd.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Ja={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xi(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Nn(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Gr)||[]).forEach(function(n){var s=Ae(n);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Tn(s.Target,t);r[c]=i,a[s.Id]=i}}),r["!id"]=a,r}var P1="application/vnd.oasis.opendocument.spreadsheet";function N1(e,t){for(var r=b0(e),a,n;a=Xn.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Ae(a[0],!1),n.path=="/"&&n.type!==P1)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}var Mn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],M1=function(){for(var e=new Array(Mn.length),t=0;t<Mn.length;++t){var r=Mn[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function sf(e){var t={};e=Ze(e);for(var r=0;r<Mn.length;++r){var a=Mn[r],n=e.match(M1[r]);n!=null&&n.length>0&&(t[a[1]]=$e(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Cr(t[a[1]]))}return t}var L1=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function cf(e,t,r,a){var n=[];if(typeof e=="string")n=Kc(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Kc(t,a).map(function(f){return f.v}):t,c=0,o=0;if(i.length>0)for(var l=0;l!==n.length;l+=2){switch(o=+n[l+1].v,n[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=i.slice(c,c+o);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=o,r.DefinedNames=i.slice(c,c+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=i.slice(c,c+o);break}c+=o}}function B1(e,t,r){var a={};return t||(t={}),e=Ze(e),L1.forEach(function(n){var s=(e.match(zn(n[0]))||[])[1];switch(n[2]){case"string":s&&(t[n[1]]=$e(s));break;case"bool":t[n[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(a[n[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&cf(a.HeadingPairs,a.TitlesOfParts,t,r),t}var U1=/<[^>]+>[^<]*/g;function $1(e,t){var r={},a="",n=e.match(U1);if(n)for(var s=0;s!=n.length;++s){var i=n[s],c=Ae(i);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=$e(c.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var o=i.split(">"),l=o[0].slice(4),f=o[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[a]=$e(f);break;case"bool":r[a]=rr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(f);break;case"filetime":case"date":r[a]=Cr(f);break;case"cy":case"error":r[a]=$e(f);break;default:if(l.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,l,o)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var H1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Fi;function W1(e,t,r){Fi||(Fi=A0(H1)),t=Fi[t]||t,e[t]=r}function M0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function of(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function lf(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function ff(e,t,r){return t===31?lf(e):of(e,t,r)}function ji(e,t,r){return ff(e,t,r===!1?0:4)}function V1(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ff(e,t,0)}function G1(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Zr,""),e.l-n&2&&(e.l+=2)}return r}function z1(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function X1(e){var t=e.l,r=Js(e,af);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Js(e,rt);return[r,a]}function j1(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(X1(e));return r}function so(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Zr,"").replace(En,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function uf(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function K1(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Js(e,t,r){var a=e.read_shift(2),n,s=r||{};if(e.l+=2,t!==to&&a!==t&&S1.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===to?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return of(e,a,4).replace(Zr,"");case 31:return lf(e);case 64:return M0(e);case 65:return uf(e);case 71:return K1(e);case 80:return ji(e,a,!s.raw).replace(Zr,"");case 81:return V1(e,a).replace(Zr,"");case 4108:return j1(e);case 4126:case 4127:return a==4127?G1(e):z1(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function io(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,c=0,o=-1,l={};for(i=0;i!=n;++i){var f=e.read_shift(4),h=e.read_shift(4);s[i]=[f,h+r]}s.sort(function(_,v){return _[1]-v[1]});var u={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var d=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(d=!1,e.l=s[i][1]),d)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[s[i][0]];if(u[p.n]=Js(e,p.t,{raw:!0}),p.p==="version"&&(u[p.n]=String(u[p.n]>>16)+"."+("0000"+String(u[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(u[p.n]){case 0:u[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:yt(c=u[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[p.n])}}else if(s[i][0]===1){if(c=u.CodePage=Js(e,N0),yt(c),o!==-1){var x=e.l;e.l=s[o][1],l=so(e,c),e.l=x}}else if(s[i][0]===0){if(c===0){o=i,e.l=s[i+1][1];continue}l=so(e,c)}else{var m=l[s[i][0]],w;switch(e[e.l]){case 65:e.l+=4,w=uf(e);break;case 30:e.l+=4,w=ji(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=ji(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=dr(e,4);break;case 64:e.l+=4,w=Cr(M0(e));break;default:throw new Error("unparsed value: "+e[e.l])}u[m]=w}}return e.l=r+a,u}function co(e,t,r){var a=e.content;if(!a)return{};Ir(a,0);var n,s,i,c,o=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),f=a.read_shift(16);if(f!==Le.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),c=a.read_shift(4),n===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);n===2&&(i=a.read_shift(16),o=a.read_shift(4));var h=io(a,t),u={SystemIdentifier:l};for(var d in h)u[d]=h[d];if(u.FMTID=s,n===1)return u;if(o-a.l==2&&(a.l+=2),a.l!==o)throw new Error("Length mismatch 2: "+a.l+" !== "+o);var p;try{p=io(a,null)}catch{}for(d in p)u[d]=p[d];return u.FMTID=[s,i],u}function aa(e,t){return e.read_shift(t),null}function Y1(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function dr(e,t){return e.read_shift(t)===1}function vr(e){return e.read_shift(2,"u")}function hf(e,t){return Y1(e,t,vr)}function J1(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ss(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return i}function q1(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,s=1+(r&1),i=0,c,o={};n&&(i=e.read_shift(2)),a&&(c=e.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,l);return n&&(e.l+=4*i),a&&(e.l+=c),o.t=f,n||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function ba(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function is(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):ba(e,a,r)}function La(e,t,r){if(r.biff>5)return is(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Z1(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Q1(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Zr,"");return a&&(e.l+=24),n}function ex(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Zr,"");return r+i}function rx(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Q1(e);case"0303000000000000c000000000000046":return ex(e);default:throw new Error("Unsupported Moniker "+r)}}function Ts(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zr,""):"";return r}function tx(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,c,o,l="",f,h;n&16&&(s=Ts(e,r-e.l)),n&128&&(i=Ts(e,r-e.l)),(n&257)===257&&(c=Ts(e,r-e.l)),(n&257)===1&&(o=rx(e,r-e.l)),n&8&&(l=Ts(e,r-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(h=M0(e)),e.l=r;var u=i||c||o||"";u&&l&&(u+="#"+l),u||(u="#"+l),n&2&&u.charAt(0)=="/"&&u.charAt(1)!="/"&&(u="file://"+u);var d={Target:u};return f&&(d.guid=f),h&&(d.time=h),s&&(d.Tooltip=s),d}function df(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function xf(e,t){var r=df(e);return r[3]=0,r}function Ht(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function ax(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function nx(e,t,r){return t===0?"":La(e,t,r)}function sx(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[n,s,i]}function pf(e){var t=e.read_shift(2),r=P0(e);return[t,r]}function ix(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=ss(e,t,r),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function li(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function mf(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var cx=mf;function gf(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function ox(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function lx(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Mr(e){e.l+=2,e.l+=e.read_shift(2)}var fx={0:Mr,4:Mr,5:Mr,6:Mr,7:lx,8:Mr,9:Mr,10:Mr,11:Mr,12:Mr,13:ox,14:Mr,15:Mr,16:Mr,17:Mr,18:Mr,19:Mr,20:Mr,21:gf};function ux(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(fx[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function ys(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function hx(e,t){return t===0||e.read_shift(2),1200}function dx(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=La(e,0,r);return e.read_shift(t+a-e.l),n}function xx(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function px(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=ss(e,0,r);return i.length===0&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}function mx(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<r;++i)s.push(q1(e));return s.Count=a,s.Unique=n,s}function gx(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function vx(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function _x(e){var t=ax(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function wx(e){return e.read_shift(2),e.read_shift(4)}function oo(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function kx(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:s,CurTab:i,FirstTab:c,Selected:o,TabRatio:l}}function Ex(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Tx(){}function yx(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=ss(e,0,r),a}function Ax(e){var t=Ht(e);return t.isst=e.read_shift(4),t}function Sx(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=Ht(e);r.biff==2&&e.l++;var s=is(e,a-e.l,r);return n.val=s,n}function Fx(e,t,r){var a=e.read_shift(2),n=La(e,0,r);return[a,n]}var bx=La;function lo(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,s=e.read_shift(n),i=e.read_shift(n),c=e.read_shift(2),o=e.read_shift(2);return e.l=a,{s:{r:s,c},e:{r:i,c:o}}}function Cx(e){var t=e.read_shift(2),r=e.read_shift(2),a=pf(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function Rx(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(pf(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}function Ix(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}function Ox(e,t,r,a){var n={},s=e.read_shift(4),i=e.read_shift(4),c=e.read_shift(4),o=e.read_shift(2);return n.patternType=C1[c>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=o&127,n.icvBack=o>>7&127,n.fsxButton=o>>14&1),n}function Dx(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=Ox(e,t,a.fStyle,r),a}function Px(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function fo(e,t,r){var a=Ht(e);(r.biff==2||t==9)&&++e.l;var n=J1(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function Nx(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Ht(e),n=$r(e);return a.val=n,a}var uo=nx;function Mx(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ba(e,s),c=[];a>e.l;)c.push(is(e));return[s,n,i,c]}function ho(e,t,r){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=ix(e,t-2,r)),s.body=n||e.read_shift(t-2),typeof n=="string"&&(s.Name=n),s}var Lx=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function xo(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),o=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),o=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var l=ba(e,i,r);n&32&&(l=Lx[l.charCodeAt(0)]);var f=a-e.l;r&&r.biff==2&&--f;var h=a==e.l||c===0||!(f>0)?[]:vv(e,f,r,c);return{chKey:s,Name:l,itab:o,rgce:h}}function vf(e,t,r){if(r.biff<8)return Bx(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(sx(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function Bx(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=ss(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Ux(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),s=ba(e,a,r),i=ba(e,n,r);return[s,i]}function $x(e,t,r){var a=mf(e);e.l++;var n=e.read_shift(1);return t-=8,[_v(e,t,r),n,a]}function po(e,t,r){var a=cx(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,mv(e,t,r)]}function Hx(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function Wx(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),c=La(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},c,i,s]}}function Vx(e,t,r){return Wx(e,t,r)}function Gx(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(li(e));return r}function zx(e,t,r){if(r&&r.biff<8)return jx(e,t,r);var a=gf(e),n=ux(e,t-22,a[1]);return{cmo:a,ft:n}}var Xx={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function jx(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Xx[a]||Vr)(e,t,r)),{cmo:[n,a,s],ft:i}}function Kx(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=Z1(e,6,r);var c=e.read_shift(2);e.read_shift(2),vr(e,2);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],h=ba(e,e.lens[l+1]-e.lens[l]-1);if(n+=h,n.length>=(f?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function Yx(e,t){var r=li(e);e.l+=16;var a=tx(e,t-24);return[r,a]}function Jx(e,t){e.read_shift(2);var r=li(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Zr,""),[r,a]}function qx(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ao[r]||r,r=e.read_shift(2),t[1]=ao[r]||r,t}function Zx(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xf(e));return r}function Qx(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xf(e));return r}function ep(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function _f(e,t,r){if(!r.cellStyles)return Vr(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),c=e.read_shift(a),o=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:s,w:i,ixfe:c,flags:o};return(r.biff>=5||!r.biff)&&(l.level=o>>8&7),l}function rp(e,t){var r={};return t<32||(e.l+=16,r.header=$r(e),r.footer=$r(e),e.l+=2),r}function tp(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}var ap=Ht,np=hf,sp=is;function ip(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function cp(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Ht(e);++e.l;var n=La(e,t-7,r);return a.t="str",a.val=n,a}function op(e){var t=Ht(e);++e.l;var r=$r(e);return t.t="n",t.val=r,t}function lp(e){var t=Ht(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function fp(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function up(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function hp(e,t,r){var a=e.l+t,n=Ht(e),s=e.read_shift(2),i=ba(e,s,r);return e.l=a,n.t="str",n.val=i,n}var dp=[2,3,48,49,131,139,140,245],mo=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=A0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,o){var l=[],f=ua(1);switch(o.type){case"base64":f=Tt(ft(c));break;case"binary":f=Tt(c);break;case"buffer":case"array":f=c;break}Ir(f,0);var h=f.read_shift(1),u=!!(h&136),d=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,u=!0;break;case 49:d=!0,u=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,m=521;h==2&&(x=f.read_shift(2)),f.l+=3,h!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(m=f.read_shift(2));var w=f.read_shift(2),_=o.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(_=e[f[f.l]]),f.l+=1,f.l+=2),p&&(f.l+=36);for(var v=[],C={},O=Math.min(f.length,h==2?521:m-10-(d?264:0)),R=p?32:11;f.l<O&&f[f.l]!=13;)switch(C={},C.name=ia.utils.decode(_,f.slice(f.l,f.l+R)).replace(/[\u0000\r\n].*$/g,""),f.l+=R,C.type=String.fromCharCode(f.read_shift(1)),h!=2&&!p&&(C.offset=f.read_shift(4)),C.len=f.read_shift(1),h==2&&(C.offset=f.read_shift(2)),C.dec=f.read_shift(1),C.name.length&&v.push(C),h!=2&&(f.l+=p?13:14),C.type){case"B":(!d||C.len!=8)&&o.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(f[f.l]!==13&&(f.l=m-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=m;var E=0,M=0;for(l[0]=[],M=0;M!=v.length;++M)l[0][M]=v[M].name;for(;x-- >0;){if(f[f.l]===42){f.l+=w;continue}for(++f.l,l[++E]=[],M=0,M=0;M!=v.length;++M){var I=f.slice(f.l,f.l+v[M].len);f.l+=v[M].len,Ir(I,0);var W=ia.utils.decode(_,I);switch(v[M].type){case"C":W.trim().length&&(l[E][M]=W.replace(/\s+$/,""));break;case"D":W.length===8?l[E][M]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):l[E][M]=W;break;case"F":l[E][M]=parseFloat(W.trim());break;case"+":case"I":l[E][M]=p?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":l[E][M]=!0;break;case"N":case"F":l[E][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[E][M]="##MEMO##"+(p?parseInt(W.trim(),10):I.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(l[E][M]=+W||0);break;case"@":l[E][M]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":l[E][M]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":l[E][M]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[E][M]=-I.read_shift(-8,"f");break;case"B":if(d&&v[M].len==8){l[E][M]=I.read_shift(8,"f");break}case"G":case"P":I.l+=v[M].len;break;case"0":if(v[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[M].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return o&&o.sheetRows&&(l=l.slice(0,o.sheetRows)),o.DBF=v,l}function a(c,o){var l=o||{};l.dateNF||(l.dateNF="yyyymmdd");var f=un(r(c,l),l);return f["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,f}function n(c,o){try{return da(a(c,o),o)}catch(l){if(o&&o.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,o){var l=o||{};if(+l.codepage>=0&&yt(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Gi(),h=e0(c,{header:1,raw:!0,cellDates:!0}),u=h[0],d=h.slice(1),p=c["!cols"]||[],x=0,m=0,w=0,_=1;for(x=0;x<u.length;++x){if(((p[x]||{}).DBF||{}).name){u[x]=p[x].DBF.name,++w;continue}if(u[x]!=null){if(++w,typeof u[x]=="number"&&(u[x]=u[x].toString(10)),typeof u[x]!="string")throw new Error("DBF Invalid column name "+u[x]+" |"+typeof u[x]+"|");if(u.indexOf(u[x])!==x){for(m=0;m<1024;++m)if(u.indexOf(u[x]+"_"+m)==-1){u[x]+="_"+m;break}}}}var v=ur(c["!ref"]),C=[],O=[],R=[];for(x=0;x<=v.e.c-v.s.c;++x){var E="",M="",I=0,W=[];for(m=0;m<d.length;++m)d[m][x]!=null&&W.push(d[m][x]);if(W.length==0||u[x]==null){C[x]="?";continue}for(m=0;m<W.length;++m){switch(typeof W[m]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=W[m]instanceof Date?"D":"C";break;default:M="C"}I=Math.max(I,String(W[m]).length),E=E&&E!=M?"C":M}I>250&&(I=250),M=((p[x]||{}).DBF||{}).type,M=="C"&&p[x].DBF.len>I&&(I=p[x].DBF.len),E=="B"&&M=="N"&&(E="N",R[x]=p[x].DBF.dec,I=p[x].DBF.len),O[x]=E=="C"||M=="N"?I:s[E]||0,_+=O[x],C[x]=E}var L=f.next(32);for(L.write_shift(4,318902576),L.write_shift(4,d.length),L.write_shift(2,296+32*w),L.write_shift(2,_),x=0;x<4;++x)L.write_shift(4,0);for(L.write_shift(4,0|(+t[gl]||3)<<8),x=0,m=0;x<u.length;++x)if(u[x]!=null){var N=f.next(32),J=(u[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,J,"sbcs"),N.write_shift(1,C[x]=="?"?"C":C[x],"sbcs"),N.write_shift(4,m),N.write_shift(1,O[x]||s[C[x]]||0),N.write_shift(1,R[x]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),m+=O[x]||s[C[x]]||0}var le=f.next(264);for(le.write_shift(4,13),x=0;x<65;++x)le.write_shift(4,0);for(x=0;x<d.length;++x){var Z=f.next(_);for(Z.write_shift(1,0),m=0;m<u.length;++m)if(u[m]!=null)switch(C[m]){case"L":Z.write_shift(1,d[x][m]==null?63:d[x][m]?84:70);break;case"B":Z.write_shift(8,d[x][m]||0,"f");break;case"N":var oe="0";for(typeof d[x][m]=="number"&&(oe=d[x][m].toFixed(R[m]||0)),w=0;w<O[m]-oe.length;++w)Z.write_shift(1,32);Z.write_shift(1,oe,"sbcs");break;case"D":d[x][m]?(Z.write_shift(4,("0000"+d[x][m].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(d[x][m].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+d[x][m].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(d[x][m]!=null?d[x][m]:"").slice(0,O[m]);for(Z.write_shift(1,Q,"sbcs"),w=0;w<O[m]-Q.length;++w)Z.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:i}}(),xp=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ut(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(u,d){var p=e[d];return typeof p=="number"?Ic(p):p},a=function(u,d,p){var x=d.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?u:Ic(x)};e["|"]=254;function n(u,d){switch(d.type){case"base64":return s(ft(u),d);case"binary":return s(u,d);case"buffer":return s(Me&&Buffer.isBuffer(u)?u.toString("binary"):Da(u),d);case"array":return s(Fa(u),d)}throw new Error("Unrecognized type "+d.type)}function s(u,d){var p=u.split(/[\n\r]+/),x=-1,m=-1,w=0,_=0,v=[],C=[],O=null,R={},E=[],M=[],I=[],W=0,L;for(+d.codepage>=0&&yt(+d.codepage);w!==p.length;++w){W=0;var N=p[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),J=N.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),le=J[0],Z;if(N.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&C.push(N.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,Q=!1,ye=!1,U=!1,ve=-1,ge=-1;for(_=1;_<J.length;++_)switch(J[_].charAt(0)){case"A":break;case"X":m=parseInt(J[_].slice(1))-1,Q=!0;break;case"Y":for(x=parseInt(J[_].slice(1))-1,Q||(m=0),L=v.length;L<=x;++L)v[L]=[];break;case"K":Z=J[_].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(Ct(Z))?isNaN(sn(Z).getDate())||(Z=Cr(Z)):(Z=Ct(Z),O!==null&&ln(O)&&(Z=oi(Z))),oe=!0;break;case"E":U=!0;var F=Qa(J[_].slice(1),{r:x,c:m});v[x][m]=[v[x][m],F];break;case"S":ye=!0,v[x][m]=[v[x][m],"S5S"];break;case"G":break;case"R":ve=parseInt(J[_].slice(1))-1;break;case"C":ge=parseInt(J[_].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}if(oe&&(v[x][m]&&v[x][m].length==2?v[x][m][0]=Z:v[x][m]=Z,O=null),ye){if(U)throw new Error("SYLK shared formula cannot have own formula");var B=ve>-1&&v[ve][ge];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");v[x][m][1]=Cf(B[1],{r:x-ve,c:m-ge})}break;case"F":var P=0;for(_=1;_<J.length;++_)switch(J[_].charAt(0)){case"X":m=parseInt(J[_].slice(1))-1,++P;break;case"Y":for(x=parseInt(J[_].slice(1))-1,L=v.length;L<=x;++L)v[L]=[];break;case"M":W=parseInt(J[_].slice(1))/20;break;case"F":break;case"G":break;case"P":O=C[parseInt(J[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=J[_].slice(1).split(" "),L=parseInt(I[0],10);L<=parseInt(I[1],10);++L)W=parseInt(I[2],10),M[L-1]=W===0?{hidden:!0}:{wch:W},cn(M[L-1]);break;case"C":m=parseInt(J[_].slice(1))-1,M[m]||(M[m]={});break;case"R":x=parseInt(J[_].slice(1))-1,E[x]||(E[x]={}),W>0?(E[x].hpt=W,E[x].hpx=Yn(W)):W===0&&(E[x].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}P<1&&(O=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}}return E.length>0&&(R["!rows"]=E),M.length>0&&(R["!cols"]=M),d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),[v,R]}function i(u,d){var p=n(u,d),x=p[0],m=p[1],w=un(x,d);return Ut(m).forEach(function(_){w[_]=m[_]}),w}function c(u,d){return da(i(u,d),d)}function o(u,d,p,x){var m="C;Y"+(p+1)+";X"+(x+1)+";K";switch(u.t){case"n":m+=u.v||0,u.f&&!u.F&&(m+=";E"+eg(u.f,{r:p,c:x}));break;case"b":m+=u.v?"TRUE":"FALSE";break;case"e":m+=u.w||u.v;break;case"d":m+='"'+(u.w||u.v)+'"';break;case"s":m+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function l(u,d){d.forEach(function(p,x){var m="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?m+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Zs(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Qs(p.wpx)),typeof p.wch=="number"&&(m+=Math.round(p.wch))),m.charAt(m.length-1)!=" "&&u.push(m)})}function f(u,d){d.forEach(function(p,x){var m="F;";p.hidden?m+="M0;":p.hpt?m+="M"+20*p.hpt+";":p.hpx&&(m+="M"+20*Sf(p.hpx)+";"),m.length>2&&u.push(m+"R"+(x+1))})}function h(u,d){var p=["ID;PWXL;N;E"],x=[],m=ur(u["!ref"]),w,_=Array.isArray(u),v=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),u["!cols"]&&l(p,u["!cols"]),u["!rows"]&&f(p,u["!rows"]),p.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var C=m.s.r;C<=m.e.r;++C)for(var O=m.s.c;O<=m.e.c;++O){var R=Ce({r:C,c:O});w=_?(u[C]||[])[O]:u[R],!(!w||w.v==null&&(!w.f||w.F))&&x.push(o(w,u,C,O))}return p.join(v)+v+x.join(v)+v+"E"+v}return{to_workbook:c,to_sheet:i,from_sheet:h}}(),pp=function(){function e(s,i){switch(i.type){case"base64":return t(ft(s),i);case"binary":return t(s,i);case"buffer":return t(Me&&Buffer.isBuffer(s)?s.toString("binary"):Da(s),i);case"array":return t(Fa(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var c=s.split(`
`),o=-1,l=-1,f=0,h=[];f!==c.length;++f){if(c[f].trim()==="BOT"){h[++o]=[],l=0;continue}if(!(o<0)){var u=c[f].trim().split(","),d=u[0],p=u[1];++f;for(var x=c[f]||"";(x.match(/["]/g)||[]).length&1&&f<c.length-1;)x+=`
`+c[++f];switch(x=x.trim(),+d){case-1:if(x==="BOT"){h[++o]=[],l=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[o][l]=!0:x==="FALSE"?h[o][l]=!1:isNaN(Ct(p))?isNaN(sn(p).getDate())?h[o][l]=p:h[o][l]=Cr(p):h[o][l]=Ct(p),++l;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[o][l++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(s,i){return un(e(s,i),i)}function a(s,i){return da(r(s,i),i)}var n=function(){var s=function(o,l,f,h,u){o.push(l),o.push(f+","+h),o.push('"'+u.replace(/"/g,'""')+'"')},i=function(o,l,f,h){o.push(l+","+f),o.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(o){var l=[],f=ur(o["!ref"]),h,u=Array.isArray(o);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,f.e.r-f.s.r+1,""),s(l,"TUPLES",0,f.e.c-f.s.c+1,""),s(l,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){i(l,-1,0,"BOT");for(var p=f.s.c;p<=f.e.c;++p){var x=Ce({r:d,c:p});if(h=u?(o[d]||[])[p]:o[x],!h){i(l,1,0,"");continue}switch(h.t){case"n":var m=h.w;!m&&h.v!=null&&(m=h.v),m==null?h.f&&!h.F?i(l,1,0,"="+h.f):i(l,1,0,""):i(l,0,m,"V");break;case"b":i(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=pt(h.z||Ie[14],Qr(Cr(h.v)))),i(l,0,h.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var w=`\r
`,_=l.join(w);return _}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),mp=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,u){for(var d=h.split(`
`),p=-1,x=-1,m=0,w=[];m!==d.length;++m){var _=d[m].trim().split(":");if(_[0]==="cell"){var v=qr(_[1]);if(w.length<=v.r)for(p=w.length;p<=v.r;++p)w[p]||(w[p]=[]);switch(p=v.r,x=v.c,_[2]){case"t":w[p][x]=e(_[3]);break;case"v":w[p][x]=+_[3];break;case"vtf":var C=_[_.length-1];case"vtc":switch(_[3]){case"nl":w[p][x]=!!+_[4];break;default:w[p][x]=+_[4];break}_[2]=="vtf"&&(w[p][x]=[w[p][x],C])}}}return u&&u.sheetRows&&(w=w.slice(0,u.sheetRows)),w}function a(h,u){return un(r(h,u),u)}function n(h,u){return da(a(h,u),u)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var u=[],d=[],p,x="",m=fn(h["!ref"]),w=Array.isArray(h),_=m.s.r;_<=m.e.r;++_)for(var v=m.s.c;v<=m.e.c;++v)if(x=Ce({r:_,c:v}),p=w?(h[_]||[])[v]:h[x],!(!p||p.v==null||p.t==="z")){switch(d=["cell",x,"t"],p.t){case"s":case"str":d.push(t(p.v));break;case"n":p.f?(d[2]="vtf",d[3]="n",d[4]=p.v,d[5]=t(p.f)):(d[2]="v",d[3]=p.v);break;case"b":d[2]="vt"+(p.f?"f":"c"),d[3]="nl",d[4]=p.v?"1":"0",d[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var C=Qr(Cr(p.v));d[2]="vtc",d[3]="nd",d[4]=""+C,d[5]=p.w||pt(p.z||Ie[14],C);break;case"e":continue}u.push(d.join(":"))}return u.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function f(h){return[s,i,c,i,l(h),o].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}}(),jn=function(){function e(f,h,u,d,p){p.raw?h[u][d]=f:f===""||(f==="TRUE"?h[u][d]=!0:f==="FALSE"?h[u][d]=!1:isNaN(Ct(f))?isNaN(sn(f).getDate())?h[u][d]=f:h[u][d]=Cr(f):h[u][d]=Ct(f))}function t(f,h){var u=h||{},d=[];if(!f||f.length===0)return d;for(var p=f.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var m=10,w=0,_=0;_<=x;++_)w=p[_].indexOf(" "),w==-1?w=p[_].length:w++,m=Math.max(m,w);for(_=0;_<=x;++_){d[_]=[];var v=0;for(e(p[_].slice(0,m).trim(),d,_,v,u),v=1;v<=(p[_].length-m)/10+1;++v)e(p[_].slice(m+(v-1)*10,m+v*10).trim(),d,_,v,u)}return u.sheetRows&&(d=d.slice(0,u.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var h={},u=!1,d=0,p=0;d<f.length;++d)(p=f.charCodeAt(d))==34?u=!u:!u&&p in r&&(h[p]=(h[p]||0)+1);p=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&p.push([h[d],d]);if(!p.length){h=a;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&p.push([h[d],d])}return p.sort(function(x,m){return x[0]-m[0]||a[x[1]]-a[m[1]]}),r[p.pop()[1]]||44}function s(f,h){var u=h||{},d="",p=u.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=n(f.slice(0,1024)):u&&u.FS?d=u.FS:d=n(f.slice(0,1024));var m=0,w=0,_=0,v=0,C=0,O=d.charCodeAt(0),R=!1,E=0,M=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var I=u.dateNF!=null?Fd(u.dateNF):null;function W(){var L=f.slice(v,C),N={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)N.t="z";else if(u.raw)N.t="s",N.v=L;else if(L.trim().length===0)N.t="s",N.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(N.t="s",N.v=L.slice(2,-1).replace(/""/g,'"')):tg(L)?(N.t="n",N.f=L.slice(1)):(N.t="s",N.v=L);else if(L=="TRUE")N.t="b",N.v=!0;else if(L=="FALSE")N.t="b",N.v=!1;else if(!isNaN(_=Ct(L)))N.t="n",u.cellText!==!1&&(N.w=L),N.v=_;else if(!isNaN(sn(L).getDate())||I&&L.match(I)){N.z=u.dateNF||Ie[14];var J=0;I&&L.match(I)&&(L=bd(L,u.dateNF,L.match(I)||[]),J=1),u.cellDates?(N.t="d",N.v=Cr(L,J)):(N.t="n",N.v=Qr(Cr(L,J))),u.cellText!==!1&&(N.w=pt(N.z,N.v instanceof Date?Qr(N.v):N.v)),u.cellNF||delete N.z}else N.t="s",N.v=L;if(N.t=="z"||(u.dense?(p[m]||(p[m]=[]),p[m][w]=N):p[Ce({c:w,r:m})]=N),v=C+1,M=f.charCodeAt(v),x.e.c<w&&(x.e.c=w),x.e.r<m&&(x.e.r=m),E==O)++w;else if(w=0,++m,u.sheetRows&&u.sheetRows<=m)return!0}e:for(;C<f.length;++C)switch(E=f.charCodeAt(C)){case 34:M===34&&(R=!R);break;case O:case 10:case 13:if(!R&&W())break e;break}return C-v>0&&W(),p["!ref"]=Be(x),p}function i(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):un(t(f,h),h)}function c(f,h){var u="",d=h.type=="string"?[0,0,0,0]:G0(f,h);switch(h.type){case"base64":u=ft(f);break;case"binary":u=f;break;case"buffer":h.codepage==65001?u=f.toString("utf8"):h.codepage&&typeof ia<"u"?u=ia.utils.decode(h.codepage,f):u=Me&&Buffer.isBuffer(f)?f.toString("binary"):Da(f);break;case"array":u=Fa(f);break;case"string":u=f;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?u=Ze(u.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?u=Ze(u):h.type=="binary"&&typeof ia<"u"&&h.codepage&&(u=ia.utils.decode(h.codepage,ia.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?mp.to_sheet(h.type=="string"?u:Ze(u),h):i(u,h)}function o(f,h){return da(c(f,h),h)}function l(f){for(var h=[],u=ur(f["!ref"]),d,p=Array.isArray(f),x=u.s.r;x<=u.e.r;++x){for(var m=[],w=u.s.c;w<=u.e.c;++w){var _=Ce({r:x,c:w});if(d=p?(f[x]||[])[w]:f[_],!d||d.v==null){m.push("          ");continue}for(var v=(d.w||(Zt(d),d.w)||"").slice(0,10);v.length<10;)v+=" ";m.push(v+(w===0?" ":""))}h.push(m.join(""))}return h.join(`
`)}return{to_workbook:o,to_sheet:c,from_sheet:l}}();function gp(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=xp.to_workbook(e,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return jn.to_workbook(e,t)}}var Ln=function(){function e(F,B,P){if(F){Ir(F,F.l||0);for(var D=P.Enum||ve;F.l<F.length;){var Y=F.read_shift(2),re=D[Y]||D[65535],ie=F.read_shift(2),te=F.l+ie,H=re.f&&re.f(F,ie,P);if(F.l=te,B(H,re,Y))return}}}function t(F,B){switch(B.type){case"base64":return r(Tt(ft(F)),B);case"binary":return r(Tt(F),B);case"buffer":case"array":return r(F,B)}throw"Unsupported type "+B.type}function r(F,B){if(!F)return F;var P=B||{},D=P.dense?[]:{},Y="Sheet1",re="",ie=0,te={},H=[],se=[],y={s:{r:0,c:0},e:{r:0,c:0}},_e=P.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)P.Enum=ve,e(F,function(q,Se,He){switch(He){case 0:P.vers=q,q>=4096&&(P.qpro=!0);break;case 6:y=q;break;case 204:q&&(re=q);break;case 222:re=q;break;case 15:case 51:P.qpro||(q[1].v=q[1].v.slice(1));case 13:case 14:case 16:He==14&&(q[2]&112)==112&&(q[2]&15)>1&&(q[2]&15)<15&&(q[1].z=P.dateNF||Ie[14],P.cellDates&&(q[1].t="d",q[1].v=oi(q[1].v))),P.qpro&&q[3]>ie&&(D["!ref"]=Be(y),te[Y]=D,H.push(Y),D=P.dense?[]:{},y={s:{r:0,c:0},e:{r:0,c:0}},ie=q[3],Y=re||"Sheet"+(ie+1),re="");var Pe=P.dense?(D[q[0].r]||[])[q[0].c]:D[Ce(q[0])];if(Pe){Pe.t=q[1].t,Pe.v=q[1].v,q[1].z!=null&&(Pe.z=q[1].z),q[1].f!=null&&(Pe.f=q[1].f);break}P.dense?(D[q[0].r]||(D[q[0].r]=[]),D[q[0].r][q[0].c]=q[1]):D[Ce(q[0])]=q[1];break}},P);else if(F[2]==26||F[2]==14)P.Enum=ge,F[2]==14&&(P.qpro=!0,F.l=0),e(F,function(q,Se,He){switch(He){case 204:Y=q;break;case 22:q[1].v=q[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(q[3]>ie&&(D["!ref"]=Be(y),te[Y]=D,H.push(Y),D=P.dense?[]:{},y={s:{r:0,c:0},e:{r:0,c:0}},ie=q[3],Y="Sheet"+(ie+1)),_e>0&&q[0].r>=_e)break;P.dense?(D[q[0].r]||(D[q[0].r]=[]),D[q[0].r][q[0].c]=q[1]):D[Ce(q[0])]=q[1],y.e.c<q[0].c&&(y.e.c=q[0].c),y.e.r<q[0].r&&(y.e.r=q[0].r);break;case 27:q[14e3]&&(se[q[14e3][0]]=q[14e3][1]);break;case 1537:se[q[0]]=q[1],q[0]==ie&&(Y=q[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(D["!ref"]=Be(y),te[re||Y]=D,H.push(re||Y),!se.length)return{SheetNames:H,Sheets:te};for(var he={},we=[],me=0;me<se.length;++me)te[H[me]]?(we.push(se[me]||H[me]),he[se[me]]=te[se[me]]||te[H[me]]):(we.push(se[me]),he[se[me]]={"!ref":"A1"});return{SheetNames:we,Sheets:he}}function a(F,B){var P=B||{};if(+P.codepage>=0&&yt(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Gi(),Y=ur(F["!ref"]),re=Array.isArray(F),ie=[];_t(D,0,s(1030)),_t(D,6,o(Y));for(var te=Math.min(Y.e.r,8191),H=Y.s.r;H<=te;++H)for(var se=Dr(H),y=Y.s.c;y<=Y.e.c;++y){H===Y.s.r&&(ie[y]=Tr(y));var _e=ie[y]+se,he=re?(F[H]||[])[y]:F[_e];if(!(!he||he.t=="z"))if(he.t=="n")(he.v|0)==he.v&&he.v>=-32768&&he.v<=32767?_t(D,13,d(H,y,he.v)):_t(D,14,x(H,y,he.v));else{var we=Zt(he);_t(D,15,h(H,y,we.slice(0,239)))}}return _t(D,1),D.end()}function n(F,B){var P=B||{};if(+P.codepage>=0&&yt(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Gi();_t(D,0,i(F));for(var Y=0,re=0;Y<F.SheetNames.length;++Y)(F.Sheets[F.SheetNames[Y]]||{})["!ref"]&&_t(D,27,U(F.SheetNames[Y],re++));var ie=0;for(Y=0;Y<F.SheetNames.length;++Y){var te=F.Sheets[F.SheetNames[Y]];if(!(!te||!te["!ref"])){for(var H=ur(te["!ref"]),se=Array.isArray(te),y=[],_e=Math.min(H.e.r,8191),he=H.s.r;he<=_e;++he)for(var we=Dr(he),me=H.s.c;me<=H.e.c;++me){he===H.s.r&&(y[me]=Tr(me));var q=y[me]+we,Se=se?(te[he]||[])[me]:te[q];if(!(!Se||Se.t=="z"))if(Se.t=="n")_t(D,23,W(he,me,ie,Se.v));else{var He=Zt(Se);_t(D,22,E(he,me,ie,He.slice(0,239)))}}++ie}}return _t(D,1),D.end()}function s(F){var B=Er(2);return B.write_shift(2,F),B}function i(F){var B=Er(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var P=0,D=0,Y=0,re=0;re<F.SheetNames.length;++re){var ie=F.SheetNames[re],te=F.Sheets[ie];if(!(!te||!te["!ref"])){++Y;var H=fn(te["!ref"]);P<H.e.r&&(P=H.e.r),D<H.e.c&&(D=H.e.c)}}return P>8191&&(P=8191),B.write_shift(2,P),B.write_shift(1,Y),B.write_shift(1,D),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function c(F,B,P){var D={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&P.qpro?(D.s.c=F.read_shift(1),F.l++,D.s.r=F.read_shift(2),D.e.c=F.read_shift(1),F.l++,D.e.r=F.read_shift(2),D):(D.s.c=F.read_shift(2),D.s.r=F.read_shift(2),B==12&&P.qpro&&(F.l+=2),D.e.c=F.read_shift(2),D.e.r=F.read_shift(2),B==12&&P.qpro&&(F.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function o(F){var B=Er(8);return B.write_shift(2,F.s.c),B.write_shift(2,F.s.r),B.write_shift(2,F.e.c),B.write_shift(2,F.e.r),B}function l(F,B,P){var D=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(D[0].c=F.read_shift(1),D[3]=F.read_shift(1),D[0].r=F.read_shift(2),F.l+=2):(D[2]=F.read_shift(1),D[0].c=F.read_shift(2),D[0].r=F.read_shift(2)),D}function f(F,B,P){var D=F.l+B,Y=l(F,B,P);if(Y[1].t="s",P.vers==20768){F.l++;var re=F.read_shift(1);return Y[1].v=F.read_shift(re,"utf8"),Y}return P.qpro&&F.l++,Y[1].v=F.read_shift(D-F.l,"cstr"),Y}function h(F,B,P){var D=Er(7+P.length);D.write_shift(1,255),D.write_shift(2,B),D.write_shift(2,F),D.write_shift(1,39);for(var Y=0;Y<D.length;++Y){var re=P.charCodeAt(Y);D.write_shift(1,re>=128?95:re)}return D.write_shift(1,0),D}function u(F,B,P){var D=l(F,B,P);return D[1].v=F.read_shift(2,"i"),D}function d(F,B,P){var D=Er(7);return D.write_shift(1,255),D.write_shift(2,B),D.write_shift(2,F),D.write_shift(2,P,"i"),D}function p(F,B,P){var D=l(F,B,P);return D[1].v=F.read_shift(8,"f"),D}function x(F,B,P){var D=Er(13);return D.write_shift(1,255),D.write_shift(2,B),D.write_shift(2,F),D.write_shift(8,P,"f"),D}function m(F,B,P){var D=F.l+B,Y=l(F,B,P);if(Y[1].v=F.read_shift(8,"f"),P.qpro)F.l=D;else{var re=F.read_shift(2);C(F.slice(F.l,F.l+re),Y),F.l+=re}return Y}function w(F,B,P){var D=B&32768;return B&=-32769,B=(D?F:0)+(B>=8192?B-16384:B),(D?"":"$")+(P?Tr(B):Dr(B))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(F,B){Ir(F,0);for(var P=[],D=0,Y="",re="",ie="",te="";F.l<F.length;){var H=F[F.l++];switch(H){case 0:P.push(F.read_shift(8,"f"));break;case 1:re=w(B[0].c,F.read_shift(2),!0),Y=w(B[0].r,F.read_shift(2),!1),P.push(re+Y);break;case 2:{var se=w(B[0].c,F.read_shift(2),!0),y=w(B[0].r,F.read_shift(2),!1);re=w(B[0].c,F.read_shift(2),!0),Y=w(B[0].r,F.read_shift(2),!1),P.push(se+y+":"+re+Y)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(F.read_shift(2));break;case 6:{for(var _e="";H=F[F.l++];)_e+=String.fromCharCode(H);P.push('"'+_e.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:te=P.pop(),ie=P.pop(),P.push(["AND","OR"][H-20]+"("+ie+","+te+")");break;default:if(H<32&&v[H])te=P.pop(),ie=P.pop(),P.push(ie+v[H]+te);else if(_[H]){if(D=_[H][1],D==69&&(D=F[F.l++]),D>P.length){console.error("WK1 bad formula parse 0x"+H.toString(16)+":|"+P.join("|")+"|");return}var he=P.slice(-D);P.length-=D,P.push(_[H][0]+"("+he.join(",")+")")}else return H<=7?console.error("WK1 invalid opcode "+H.toString(16)):H<=24?console.error("WK1 unsupported op "+H.toString(16)):H<=30?console.error("WK1 invalid opcode "+H.toString(16)):H<=115?console.error("WK1 unsupported function opcode "+H.toString(16)):console.error("WK1 unrecognized opcode "+H.toString(16))}}P.length==1?B[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function O(F){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=F.read_shift(2),B[3]=F[F.l++],B[0].c=F[F.l++],B}function R(F,B){var P=O(F);return P[1].t="s",P[1].v=F.read_shift(B-4,"cstr"),P}function E(F,B,P,D){var Y=Er(6+D.length);Y.write_shift(2,F),Y.write_shift(1,P),Y.write_shift(1,B),Y.write_shift(1,39);for(var re=0;re<D.length;++re){var ie=D.charCodeAt(re);Y.write_shift(1,ie>=128?95:ie)}return Y.write_shift(1,0),Y}function M(F,B){var P=O(F);P[1].v=F.read_shift(2);var D=P[1].v>>1;if(P[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return P[1].v=D,P}function I(F,B){var P=O(F),D=F.read_shift(4),Y=F.read_shift(4),re=F.read_shift(2);if(re==65535)return D===0&&Y===3221225472?(P[1].t="e",P[1].v=15):D===0&&Y===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var ie=re&32768;return re=(re&32767)-16446,P[1].v=(1-ie*2)*(Y*Math.pow(2,re+32)+D*Math.pow(2,re)),P}function W(F,B,P,D){var Y=Er(14);if(Y.write_shift(2,F),Y.write_shift(1,P),Y.write_shift(1,B),D==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var re=0,ie=0,te=0,H=0;return D<0&&(re=1,D=-D),ie=Math.log2(D)|0,D/=Math.pow(2,ie-31),H=D>>>0,H&2147483648||(D/=2,++ie,H=D>>>0),D-=H,H|=2147483648,H>>>=0,D*=Math.pow(2,32),te=D>>>0,Y.write_shift(4,te),Y.write_shift(4,H),ie+=16383+(re?32768:0),Y.write_shift(2,ie),Y}function L(F,B){var P=I(F);return F.l+=B-14,P}function N(F,B){var P=O(F),D=F.read_shift(4);return P[1].v=D>>6,P}function J(F,B){var P=O(F),D=F.read_shift(8,"f");return P[1].v=D,P}function le(F,B){var P=J(F);return F.l+=B-10,P}function Z(F,B){return F[F.l+B-1]==0?F.read_shift(B,"cstr"):""}function oe(F,B){var P=F[F.l++];P>B-1&&(P=B-1);for(var D="";D.length<P;)D+=String.fromCharCode(F[F.l++]);return D}function Q(F,B,P){if(!(!P.qpro||B<21)){var D=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var Y=F.read_shift(B-21,"cstr");return[D,Y]}}function ye(F,B){for(var P={},D=F.l+B;F.l<D;){var Y=F.read_shift(2);if(Y==14e3){for(P[Y]=[0,""],P[Y][0]=F.read_shift(2);F[F.l];)P[Y][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return P}function U(F,B){var P=Er(5+F.length);P.write_shift(2,14e3),P.write_shift(2,B);for(var D=0;D<F.length;++D){var Y=F.charCodeAt(D);P[P.l++]=Y>127?95:Y}return P[P.l++]=0,P}var ve={0:{n:"BOF",f:vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:p},15:{n:"LABEL",f},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function vp(e){var t={},r=e.match(Gr),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=Ae(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=w0[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}var _p=function(){var e=zn("t"),t=zn("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var c={t:"s",v:$e(i[1])},o=s.match(t);return o&&(c.s=vp(o[1])),c}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(n).map(r).filter(function(c){return c.v})}}(),wp=function(){var t=/(\r\n|\n)/g;function r(n,s,i){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),n.b&&(s.push("<b>"),i.push("</b>")),n.i&&(s.push("<i>"),i.push("</i>")),n.strike&&(s.push("<s>"),i.push("</s>"));var o=n.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(s.push("<"+o+">"),i.push("</"+o+">")),i.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}}(),kp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ep=/<(?:\w+:)?r>/,Tp=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function L0(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=$e(Ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Ze(e),r&&(a.h=F0(a.t))):e.match(Ep)&&(a.r=Ze(e),a.t=$e(Ze((e.replace(Tp,"").match(kp)||[]).join("").replace(Gr,""))),r&&(a.h=wp(_p(a.r)))),a):{t:""}}var yp=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ap=/<(?:\w+:)?(?:si|sstItem)>/g,Sp=/<\/(?:\w+:)?(?:si|sstItem)>/;function Fp(e,t){var r=[],a="";if(!e)return r;var n=e.match(yp);if(n){a=n[2].replace(Ap,"").split(Sp);for(var s=0;s!=a.length;++s){var i=L0(a[s].trim(),t);i!=null&&(r[r.length]=i)}n=Ae(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}function bp(e){return[e.read_shift(4),e.read_shift(4)]}function Cp(e,t){var r=[],a=!1;return Qt(e,function(s,i,c){switch(c){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function wf(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function qt(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Rp(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=qt(e,4),t.U=qt(e,4),t.W=qt(e,4),t}function Ip(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Op(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Ip(e));return t}function Dp(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Pp(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=qt(e,4),t.U=qt(e,4),t.W=qt(e,4),t}function Np(e){var t=Pp(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function kf(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function Ef(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Mp(e){var t=qt(e);switch(t.Minor){case 2:return[t.Minor,Lp(e)];case 3:return[t.Minor,Bp()];case 4:return[t.Minor,Up(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Lp(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=kf(e,r),n=Ef(e,e.length-e.l);return{t:"Std",h:a,v:n}}function Bp(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Up(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Gr,function(s){var i=Ae(s);switch($t(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=i[c]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function $p(e,t){var r={},a=r.EncryptionVersionInfo=qt(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=kf(e,n),t-=n,r.EncryptionVerifier=Ef(e,t),r}function Hp(e){var t={},r=t.EncryptionVersionInfo=qt(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Wp(e){var t=0,r,a=wf(e),n=a.length+1,s,i,c,o,l;for(r=ua(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)i=r[s],c=t&16384?1:0,o=t<<1&32767,l=c|o,t=l^i;return t^52811}var Tf=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},n=function(i,c){return a(i^c)},s=function(i){for(var c=t[i.length-1],o=104,l=i.length-1;l>=0;--l)for(var f=i[l],h=0;h!=7;++h)f&64&&(c^=r[o]),f*=2,--o;return c};return function(i){for(var c=wf(i),o=s(c),l=c.length,f=ua(16),h=0;h!=16;++h)f[h]=0;var u,d,p;for((l&1)===1&&(u=o>>8,f[l]=n(e[0],u),--l,u=o&255,d=c[c.length-1],f[l]=n(d,u));l>0;)--l,u=o>>8,f[l]=n(c[l],u),--l,u=o&255,f[l]=n(c[l],u);for(l=15,p=15-c.length;p>0;)u=o>>8,f[l]=n(e[p],u),--l,--p,u=o&255,f[l]=n(c[l],u),--l,--p;return f}}(),Vp=function(e,t,r,a,n){n||(n=t),a||(a=Tf(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=a[r],i=(i>>5|i<<3)&255,n[s]=i,++r;return[n,r,a]},Gp=function(e){var t=0,r=Tf(e);return function(a){var n=Vp("",a,t,r);return t=n[1],n[0]}};function zp(e,t,r,a){var n={key:vr(e),verificationBytes:vr(e)};return r.password&&(n.verifier=Wp(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Gp(r.password)),n}function Xp(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Hp(e):a.Data=$p(e,t),a}function jp(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?Xp(e,t-2,a):zp(e,r.biff>=8?t:t-2,r,a),a}var Kp=function(){function e(n,s){switch(s.type){case"base64":return t(ft(n),s);case"binary":return t(n,s);case"buffer":return t(Me&&Buffer.isBuffer(n)?n.toString("binary"):Da(n),s);case"array":return t(Fa(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var i=s||{},c=i.dense?[]:{},o=n.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(f,h){Array.isArray(c)&&(c[h]=[]);for(var u=/\\\w+\b/g,d=0,p,x=-1;p=u.exec(f);){switch(p[0]){case"\\cell":var m=f.slice(d,u.lastIndex-p[0].length);if(m[0]==" "&&(m=m.slice(1)),++x,m.length){var w={v:m,t:"s"};Array.isArray(c)?c[h][x]=w:c[Ce({r:h,c:x})]=w}break}d=u.lastIndex}x>l.e.c&&(l.e.c=x)}),c["!ref"]=Be(l),c}function r(n,s){return da(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],i=ur(n["!ref"]),c,o=Array.isArray(n),l=i.s.r;l<=i.e.r;++l){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var h=Ce({r:l,c:f});c=o?(n[l]||[])[f]:n[h],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(Zt(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function Yp(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Kn(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Jp(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),i=n-s;if(i===0)return[0,0,t];var c=0,o=0,l=n+s;switch(o=i/(l>1?2-l:l),n){case t:c=((r-a)/i+6)%6;break;case r:c=(a-t)/i+2;break;case a:c=(t-r)/i+4;break}return[c/6,o,l/2]}function qp(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),s=a-n/2,i=[s,s,s],c=6*t,o;if(r!==0)switch(c|0){case 0:case 6:o=n*c,i[0]+=n,i[1]+=o;break;case 1:o=n*(2-c),i[0]+=o,i[1]+=n;break;case 2:o=n*(c-2),i[1]+=n,i[2]+=o;break;case 3:o=n*(4-c),i[1]+=o,i[2]+=n;break;case 4:o=n*(c-4),i[2]+=n,i[0]+=o;break;case 5:o=n*(6-c),i[2]+=o,i[0]+=n;break}for(var l=0;l!=3;++l)i[l]=Math.round(i[l]*255);return i}function qs(e,t){if(t===0)return e;var r=Jp(Yp(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Kn(qp(r))}var yf=6,Zp=15,Qp=1,Jr=yf;function Zs(e){return Math.floor((e+Math.round(128/Jr)/256)*Jr)}function Qs(e){return Math.floor((e-5)/Jr*100+.5)/100}function Ki(e){return Math.round((e*Jr+5)/Jr*256)/256}function bi(e){return Ki(Qs(Zs(e)))}function B0(e){var t=Math.abs(e-bi(e)),r=Jr;if(t>.005)for(Jr=Qp;Jr<Zp;++Jr)Math.abs(e-bi(e))<=t&&(t=Math.abs(e-bi(e)),r=Jr);Jr=r}function cn(e){e.width?(e.wpx=Zs(e.width),e.wch=Qs(e.wpx),e.MDW=Jr):e.wpx?(e.wch=Qs(e.wpx),e.width=Ki(e.wch),e.MDW=Jr):typeof e.wch=="number"&&(e.width=Ki(e.wch),e.wpx=Zs(e.width),e.MDW=Jr),e.customWidth&&delete e.customWidth}var em=96,Af=em;function Sf(e){return e*96/Af}function Yn(e){return e*Af/96}var rm={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function tm(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(Gr)||[]).forEach(function(i){var c=Ae(i);switch($t(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=rr(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=rr(c.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function am(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(Gr)||[]).forEach(function(i){var c=Ae(i);switch($t(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function nm(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(Gr)||[]).forEach(function(i){var c=Ae(i);switch($t(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=Ze(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?rr(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?rr(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?rr(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?rr(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?rr(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?rr(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?rr(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=w0[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=rr(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var o=Aa[n.color.index];n.color.index==81&&(o=Aa[1]),o||(o=Aa[1]),n.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=qs(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function sm(e,t,r){t.NumberFmt=[];for(var a=Ut(Ie),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Ie[a[n]];var s=e[0].match(Gr);if(s)for(n=0;n<s.length;++n){var i=Ae(s[n]);switch($t(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=$e(Ze(i.formatCode)),o=parseInt(i.numFmtId,10);if(t.NumberFmt[o]=c,o>0){if(o>392){for(o=392;o>60&&t.NumberFmt[o]!=null;--o);t.NumberFmt[o]=c}ya(c,o)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var As=["numFmtId","fillId","fontId","borderId","xfId"],Ss=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function im(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(Gr)||[]).forEach(function(s){var i=Ae(s),c=0;switch($t(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],c=0;c<As.length;++c)a[As[c]]&&(a[As[c]]=parseInt(a[As[c]],10));for(c=0;c<Ss.length;++c)a[Ss[c]]&&(a[Ss[c]]=rr(a[Ss[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),i.textRotation!=null&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=rr(i.wrapText)),a.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var cm=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,o,l){var f={};if(!c)return f;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=c.match(t))&&sm(h,f,l),(h=c.match(n))&&nm(h,f,o,l),(h=c.match(a))&&am(h,f,o,l),(h=c.match(s))&&tm(h,f,o,l),(h=c.match(r))&&im(h,f,l),f}}();function om(e,t){var r=e.read_shift(2),a=Wr(e);return[r,a]}function lm(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=_1(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var c=e.read_shift(1);c>0&&(a.family=c);var o=e.read_shift(1);switch(o>0&&(a.charset=o),e.l++,a.color=v1(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Wr(e),a}var fm=Vr;function um(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}var hm=Vr;function dm(e,t,r){var a={};a.NumberFmt=[];for(var n in Ie)a.NumberFmt[n]=Ie[n];a.CellXf=[],a.Fonts=[];var s=[],i=!1;return Qt(e,function(o,l,f){switch(f){case 44:a.NumberFmt[o[0]]=o[1],ya(o[1],o[0]);break;case 43:a.Fonts.push(o),o.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=qs(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(l.T>0)s.push(f);else if(l.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}var xm=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function pm(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Gr)||[]).forEach(function(n){var s=Ae(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[xm.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function mm(){}function gm(){}var vm=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_m=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,wm=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function km(e,t,r){t.themeElements={};var a;[["clrScheme",vm,pm],["fontScheme",_m,mm],["fmtScheme",wm,gm]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var Em=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ff(e,t){(!e||e.length===0)&&(e=Tm());var r,a={};if(!(r=e.match(Em)))throw new Error("themeElements not found in theme");return km(r[0],a,t),a.raw=e,a}function Tm(e,t){var r=[Ll];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function ym(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var i;try{i=Ml(s,{type:"array"})}catch{return}var c=lt(i,"theme/theme/theme1.xml",!0);if(c)return Ff(c,r)}}function Am(e){return e.read_shift(4)}function Sm(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Fm(e,4);break;case 2:t.xclrValue=df(e);break;case 3:t.xclrValue=Am(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Fm(e,t){return Vr(e,t)}function bm(e,t){return Vr(e,t)}function Cm(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Sm(e);break;case 6:a[1]=bm(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Rm(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(Cm(e,r-e.l));return{ixfe:a,ext:s}}function Im(e,t){t.forEach(function(r){switch(r[0]){}})}function Om(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Wr(e)}}function Dm(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Pm(e){return e.l+=4,e.read_shift(4)!=0}function Nm(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],i=!1,c=2;return Qt(e,function(o,l,f){switch(f){case 335:a.Types.push({name:o.name});break;case 51:o.forEach(function(h){c==1?a.Cell.push({type:a.Types[h[0]-1].name,index:h[1]}):c==0&&a.Value.push({type:a.Types[h[0]-1].name,index:h[1]})});break;case 337:c=o?1:0;break;case 338:c=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!l.T){if(!i||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Mm(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,i;return e.replace(Gr,function(c){var o=Ae(c);switch($t(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==o.name&&(i=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[o.t-1].name,index:+o.v}):s==0&&a.Value.push({type:a.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+o.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return c}),a}function Lm(e){var t=[];if(!e)return t;var r=1;return(e.match(Gr)||[]).forEach(function(a){var n=Ae(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function Bm(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ce(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Um(e,t,r){var a=[];return Qt(e,function(s,i,c){switch(c){case 63:a.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function $m(e,t,r,a){if(!e)return e;var n=a||{},s=!1;Qt(e,function(c,o,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!o.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},n)}function Hm(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function go(e,t,r,a){var n=Array.isArray(e),s;t.forEach(function(i){var c=qr(i.ref);if(n?(e[c.r]||(e[c.r]=[]),s=e[c.r][c.c]):s=e[i.ref],!s){s={t:"z"},n?e[c.r][c.c]=s:e[i.ref]=s;var o=ur(e["!ref"]||"BDWGO1000001:A1");o.s.r>c.r&&(o.s.r=c.r),o.e.r<c.r&&(o.e.r=c.r),o.s.c>c.c&&(o.s.c=c.c),o.e.c<c.c&&(o.e.c=c.c);var l=Be(o);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&a){for(h=0;h<a.length;++h)if(f.a==a[h].id){f.a=a[h].name||f.a;break}}s.c.push(f)})}function Wm(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var c=i.match(/<(?:\w+:)?comment[^>]*>/);if(c){var o=Ae(c[0]),l={author:o.authorId&&r[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},f=qr(o.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!h&&!!h[1]&&L0(h[1])||{r:"",t:"",h:""};l.r=u.r,u.r=="<t></t>"&&(u.t=u.h=""),l.t=(u.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(l.h=u.h),a.push(l)}}}}),a}function Vm(e,t){var r=[],a=!1,n={},s=0;return e.replace(Gr,function(c,o){var l=Ae(c);switch($t(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=o+c.length;break;case"</text>":n.t=e.slice(s,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return c}),r}function Gm(e,t){var r=[],a=!1;return e.replace(Gr,function(s){var i=Ae(s);switch($t(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function zm(e){var t={};t.iauthor=e.read_shift(4);var r=Na(e);return t.rfx=r.s,t.ref=Ce(r.s),e.l+=16,t}var Xm=Wr;function jm(e,t){var r=[],a=[],n={},s=!1;return Qt(e,function(c,o,l){switch(l){case 632:a.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}var Km="application/vnd.ms-office.vbaProject";function Ym(e){var t=Le.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Le.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Le.write(t)}function Jm(){return{"!type":"dialog"}}function qm(){return{"!type":"dialog"}}function Zm(){return{"!type":"macro"}}function Qm(){return{"!type":"macro"}}var Qa=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,i){var c=!1,o=!1;s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return c?f+=t.c:--f,o?l+=t.r:--l,n+(c?"":"$")+Tr(f)+(o?"":"$")+Dr(l)}return function(n,s){return t=s,n.replace(e,r)}}(),bf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,eg=function(){return function(t,r){return t.replace(bf,function(a,n,s,i,c,o){var l=I0(i)-(s?0:r.c),f=R0(o)-(c?0:r.r),h=f==0?"":c?f+1:"["+f+"]",u=l==0?"":s?l+1:"["+l+"]";return n+"R"+h+"C"+u})}}();function Cf(e,t){return e.replace(bf,function(r,a,n,s,i,c){return a+(n=="$"?n+s:Tr(I0(s)+t.c))+(i=="$"?i+c:Dr(R0(c)+t.r))})}function rg(e,t,r){var a=fn(t),n=a.s,s=qr(r),i={r:s.r-n.r,c:s.c-n.c};return Cf(e,i)}function tg(e){return e.length!=1}function vo(e){return e.replace(/_xlfn\./g,"")}function mr(e){e.l+=1}function ha(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Rf(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return If(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=ha(e),c=ha(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function If(e){var t=ha(e),r=ha(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function ag(e,t,r){if(r.biff<8)return If(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=ha(e),i=ha(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function Of(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return ng(e);var a=e.read_shift(r&&r.biff==12?4:2),n=ha(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function ng(e){var t=ha(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function sg(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function ig(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return cg(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;n>524287;)n-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:i,rRel:c}}function cg(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function og(e,t,r){var a=(e[e.l++]&96)>>5,n=Rf(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function lg(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=Rf(e,s,r);return[a,n,i]}function fg(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function ug(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function hg(e,t,r){var a=(e[e.l++]&96)>>5,n=ag(e,t-1,r);return[a,n]}function dg(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function _o(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function xg(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function pg(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function mg(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function gg(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function vg(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Df(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function _g(e){return e.read_shift(2),Df(e)}function wg(e){return e.read_shift(2),Df(e)}function kg(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=Of(e,0,r);return[a,n]}function Eg(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=ig(e,0,r);return[a,n]}function Tg(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=Of(e,0,r);return[a,n,s]}function yg(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Av[n],Mf[n],a]}function Ag(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Sg(e);return[n,(s[0]===0?Mf:yv)[s[1]]]}function Sg(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Fg(e,t,r){e.l+=r&&r.biff==2?3:4}function bg(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Cg(e){return e.l++,Ma[e.read_shift(1)]}function Rg(e){return e.l++,e.read_shift(2)}function Ig(e){return e.l++,e.read_shift(1)!==0}function Og(e){return e.l++,$r(e)}function Dg(e,t,r){return e.l++,ss(e,t-1,r)}function Pg(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=dr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ma[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$r(e);break;case 2:r[1]=La(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Ng(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?Na:li)(e));return n}function Mg(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var c=0;c!=n;++c)i[s][c]=Pg(e,r.biff);return i}function Lg(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function Bg(e,t,r){if(r.biff==5)return Ug(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function Ug(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function $g(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Hg(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Wg(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function Vg(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var Gg=Vr,zg=Vr,Xg=Vr;function cs(e,t,r){return e.l+=2,[sg(e)]}function U0(e){return e.l+=6,[]}var jg=cs,Kg=U0,Yg=U0,Jg=cs;function Pf(e){return e.l+=2,[vr(e),e.read_shift(2)&1]}var qg=cs,Zg=Pf,Qg=U0,ev=cs,rv=cs,tv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function av(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),i=tv[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:a,c:n,C:s}}function nv(e){return e.l+=2,[e.read_shift(4)]}function sv(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function iv(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function cv(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ov(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lv(e){return e.l+=4,[0,0]}var wo={1:{n:"PtgExp",f:bg},2:{n:"PtgTbl",f:Xg},3:{n:"PtgAdd",f:mr},4:{n:"PtgSub",f:mr},5:{n:"PtgMul",f:mr},6:{n:"PtgDiv",f:mr},7:{n:"PtgPower",f:mr},8:{n:"PtgConcat",f:mr},9:{n:"PtgLt",f:mr},10:{n:"PtgLe",f:mr},11:{n:"PtgEq",f:mr},12:{n:"PtgGe",f:mr},13:{n:"PtgGt",f:mr},14:{n:"PtgNe",f:mr},15:{n:"PtgIsect",f:mr},16:{n:"PtgUnion",f:mr},17:{n:"PtgRange",f:mr},18:{n:"PtgUplus",f:mr},19:{n:"PtgUminus",f:mr},20:{n:"PtgPercent",f:mr},21:{n:"PtgParen",f:mr},22:{n:"PtgMissArg",f:mr},23:{n:"PtgStr",f:Dg},26:{n:"PtgSheet",f:sv},27:{n:"PtgEndSheet",f:iv},28:{n:"PtgErr",f:Cg},29:{n:"PtgBool",f:Ig},30:{n:"PtgInt",f:Rg},31:{n:"PtgNum",f:Og},32:{n:"PtgArray",f:dg},33:{n:"PtgFunc",f:yg},34:{n:"PtgFuncVar",f:Ag},35:{n:"PtgName",f:Lg},36:{n:"PtgRef",f:kg},37:{n:"PtgArea",f:og},38:{n:"PtgMemArea",f:$g},39:{n:"PtgMemErr",f:Gg},40:{n:"PtgMemNoMem",f:zg},41:{n:"PtgMemFunc",f:Hg},42:{n:"PtgRefErr",f:Wg},43:{n:"PtgAreaErr",f:fg},44:{n:"PtgRefN",f:Eg},45:{n:"PtgAreaN",f:hg},46:{n:"PtgMemAreaN",f:cv},47:{n:"PtgMemNoMemN",f:ov},57:{n:"PtgNameX",f:Bg},58:{n:"PtgRef3d",f:Tg},59:{n:"PtgArea3d",f:lg},60:{n:"PtgRefErr3d",f:Vg},61:{n:"PtgAreaErr3d",f:ug},255:{}},fv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},uv={1:{n:"PtgElfLel",f:Pf},2:{n:"PtgElfRw",f:ev},3:{n:"PtgElfCol",f:jg},6:{n:"PtgElfRwV",f:rv},7:{n:"PtgElfColV",f:Jg},10:{n:"PtgElfRadical",f:qg},11:{n:"PtgElfRadicalS",f:Qg},13:{n:"PtgElfColS",f:Kg},15:{n:"PtgElfColSV",f:Yg},16:{n:"PtgElfRadicalLel",f:Zg},25:{n:"PtgList",f:av},29:{n:"PtgSxName",f:nv},255:{}},hv={0:{n:"PtgAttrNoop",f:lv},1:{n:"PtgAttrSemi",f:vg},2:{n:"PtgAttrIf",f:mg},4:{n:"PtgAttrChoose",f:xg},8:{n:"PtgAttrGoto",f:pg},16:{n:"PtgAttrSum",f:Fg},32:{n:"PtgAttrBaxcel",f:_o},33:{n:"PtgAttrBaxcel",f:_o},64:{n:"PtgAttrSpace",f:_g},65:{n:"PtgAttrSpaceSemi",f:wg},128:{n:"PtgAttrIfError",f:gg},255:{}};function os(e,t,r,a){if(a.biff<8)return Vr(e,t);for(var n=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Mg(e,0,a),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Ng(e,r[i][1],a),s.push(r[i][2]);break;case"PtgExp":a&&a.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=n-e.l,t!==0&&s.push(Vr(e,t)),s}function ls(e,t,r){for(var a=e.l+t,n,s,i=[];a!=e.l;)t=a-e.l,s=e[e.l],n=wo[s]||wo[fv[s]],(s===24||s===25)&&(n=(s===24?uv:hv)[e[e.l+1]]),!n||!n.f?Vr(e,t):i.push([n.n,n.f(e,t,r)]);return i}function dv(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var i=a[s];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var xv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function pv(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Nf(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function ko(e,t,r){var a=Nf(e,t,r);return a=="#REF"?a:pv(a,r)}function Ur(e,t,r,a,n){var s=n&&n.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},c=[],o,l,f,h=0,u=0,d,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,m="",w=0,_=e[0].length;w<_;++w){var v=e[0][w];switch(v[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=c.pop(),l=c.pop(),x>=0){switch(e[0][x][1][0]){case 0:m=fr(" ",e[0][x][1][1]);break;case 1:m=fr("\r",e[0][x][1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}l=l+m,x=-1}c.push(l+xv[v[0]]+o);break;case"PtgIsect":o=c.pop(),l=c.pop(),c.push(l+" "+o);break;case"PtgUnion":o=c.pop(),l=c.pop(),c.push(l+","+o);break;case"PtgRange":o=c.pop(),l=c.pop(),c.push(l+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Dn(v[1][1],i,n),c.push(Pn(f,s));break;case"PtgRefN":f=r?Dn(v[1][1],r,n):v[1][1],c.push(Pn(f,s));break;case"PtgRef3d":h=v[1][1],f=Dn(v[1][2],i,n),p=ko(a,h,n),c.push(p+"!"+Pn(f,s));break;case"PtgFunc":case"PtgFuncVar":var C=v[1][0],O=v[1][1];C||(C=0),C&=127;var R=C==0?[]:c.slice(-C);c.length-=C,O==="User"&&(O=R.shift()),c.push(O+"("+R.join(",")+")");break;case"PtgBool":c.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(v[1]);break;case"PtgNum":c.push(String(v[1]));break;case"PtgStr":c.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(v[1]);break;case"PtgAreaN":d=eo(v[1][1],r?{s:r}:i,n),c.push(Si(d,n));break;case"PtgArea":d=eo(v[1][1],i,n),c.push(Si(d,n));break;case"PtgArea3d":h=v[1][1],d=v[1][2],p=ko(a,h,n),c.push(p+"!"+Si(d,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=v[1][2];var E=(a.names||[])[u-1]||(a[0]||[])[u],M=E?E.Name:"SH33TJSNAME"+String(u);M&&M.slice(0,6)=="_xlfn."&&!n.xlfn&&(M=M.slice(6)),c.push(M);break;case"PtgNameX":var I=v[1][1];u=v[1][2];var W;if(n.biff<=5)I<0&&(I=-I),a[I]&&(W=a[I][u]);else{var L="";if(((a[I]||[])[0]||[])[0]==14849||(((a[I]||[])[0]||[])[0]==1025?a[I][u]&&a[I][u].itab>0&&(L=a.SheetNames[a[I][u].itab-1]+"!"):L=a.SheetNames[u-1]+"!"),a[I]&&a[I][u])L+=a[I][u].Name;else if(a[0]&&a[0][u])L+=a[0][u].Name;else{var N=(Nf(a,I,n)||"").split(";;");N[u-1]?L=N[u-1]:L+="SH33TJSERRX"}c.push(L);break}W||(W={Name:"SH33TJSERRY"}),c.push(W.Name);break;case"PtgParen":var J="(",le=")";if(x>=0){switch(m="",e[0][x][1][0]){case 2:J=fr(" ",e[0][x][1][1])+J;break;case 3:J=fr("\r",e[0][x][1][1])+J;break;case 4:le=fr(" ",e[0][x][1][1])+le;break;case 5:le=fr("\r",e[0][x][1][1])+le;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}c.push(J+c.pop()+le);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var Z={c:r.c,r:r.r};if(a.sharedf[Ce(f)]){var oe=a.sharedf[Ce(f)];c.push(Ur(oe,i,Z,a,n))}else{var Q=!1;for(o=0;o!=a.arrayf.length;++o)if(l=a.arrayf[o],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){c.push(Ur(l[1],i,Z,a,n)),Q=!0;break}Q||c.push(v[1])}break;case"PtgArray":c.push("{"+dv(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&ye.indexOf(e[0][w][0])==-1){v=e[0][x];var U=!0;switch(v[1][0]){case 4:U=!1;case 0:m=fr(" ",v[1][1]);break;case 5:U=!1;case 1:m=fr("\r",v[1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}c.push((U?m:"")+c.pop()+(U?"":m)),x=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function mv(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],Vr(e,t-2)];var c=ls(e,i,r);return t!==i+n&&(s=os(e,t-i-n,c,r)),e.l=a,[c,s]}function gv(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],Vr(e,t-2)];var c=ls(e,i,r);return t!==i+n&&(s=os(e,t-i-n,c,r)),e.l=a,[c,s]}function vv(e,t,r,a){var n=e.l+t,s=ls(e,a,r),i;return n!==e.l&&(i=os(e,n-e.l,s,r)),[s,i]}function _v(e,t,r){var a=e.l+t,n,s=e.read_shift(2),i=ls(e,s,r);return s==65535?[[],Vr(e,t-2)]:(t!==s+2&&(n=os(e,a-s-2,i,r)),[i,n])}function wv(e){var t;if(Yt(e,e.l+6)!==65535)return[$r(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Ci(e,t,r){var a=e.l+t,n=Ht(e);r.biff==2&&++e.l;var s=wv(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=gv(e,a-e.l,r);return{cell:n,val:s[0],formula:c,shared:i>>3&1,tt:s[1]}}function fi(e,t,r){var a=e.read_shift(4),n=ls(e,a,r),s=e.read_shift(4),i=s>0?os(e,s,n,r):null;return[n,i]}var kv=fi,ui=fi,Ev=fi,Tv=fi,yv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Mf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Av={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Eo(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Ri(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Bn={},en={};function Un(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Lf(e,t,r,a,n,s){try{a.cellNF&&(e.z=Ie[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Cr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Ie[t]==null&&ya(Sd[t]||"General",t),e.t==="e")e.w=e.w||Ma[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gn(e.v);else if(e.t==="d"){var i=Qr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Gn(i)}else{if(e.v===void 0)return"";e.w=Sa(e.v,en)}else e.t==="d"?e.w=pt(t,Qr(e.v),en):e.w=pt(t,e.v,en)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=qs(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=qs(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&s.Fills)throw c}}}function Sv(e,t){var r=ur(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Be(r))}var Fv=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,bv=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Cv=/<(?:\w:)?hyperlink [^>]*>/mg,Rv=/"(\w*:\w*)"/,Iv=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ov=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Dv=/<(?:\w:)?pageMargins[^>]*\/>/g,Bf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Pv=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Nv=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Mv(e,t,r,a,n,s,i){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",h=e.match(bv);h?(l=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):l=f=e;var u=l.match(Bf);u?$0(u[0],c,n,r):(u=l.match(Pv))&&Lv(u[0],u[1]||"",c,n,r);var d=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=l.slice(d,d+50).match(Rv);p&&Sv(c,p[1])}var x=l.match(Nv);x&&x[1]&&Vv(x[1],n);var m=[];if(t.cellStyles){var w=l.match(Iv);w&&$v(m,w)}h&&Gv(h[1],c,t,o,s,i);var _=f.match(Ov);_&&(c["!autofilter"]=Hv(_[0]));var v=[],C=f.match(Fv);if(C)for(d=0;d!=C.length;++d)v[d]=ur(C[d].slice(C[d].indexOf('"')+1));var O=f.match(Cv);O&&Bv(c,O,a);var R=f.match(Dv);if(R&&(c["!margins"]=Uv(Ae(R[0]))),!c["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(c["!ref"]=Be(o)),t.sheetRows>0&&c["!ref"]){var E=ur(c["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>o.e.r&&(E.e.r=o.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>o.e.c&&(E.e.c=o.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Be(E))}return m.length>0&&(c["!cols"]=m),v.length>0&&(c["!merges"]=v),c}function $0(e,t,r,a){var n=Ae(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=$e(Ze(n.codeName)))}function Lv(e,t,r,a,n){$0(e.slice(0,e.indexOf(">")),r,a,n)}function Bv(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=Ae(Ze(t[n]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+$e(s.location))):(s.Target="#"+$e(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=ur(s.ref),o=c.s.r;o<=c.e.r;++o)for(var l=c.s.c;l<=c.e.c;++l){var f=Ce({c:l,r:o});a?(e[o]||(e[o]=[]),e[o][l]||(e[o][l]={t:"z",v:void 0}),e[o][l].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function Uv(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function $v(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=Ae(t[a],!0);n.hidden&&(n.hidden=rr(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,B0(n.width)),cn(n);s<=i;)e[s++]=Or(n)}}function Hv(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var Wv=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Vv(e,t){t.Views||(t.Views=[{}]),(e.match(Wv)||[]).forEach(function(r,a){var n=Ae(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),rr(n.rightToLeft)&&(t.Views[a].RTL=!0)})}var Gv=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=zn("v"),i=zn("f");return function(o,l,f,h,u,d){for(var p=0,x="",m=[],w=[],_=0,v=0,C=0,O="",R,E,M=0,I=0,W,L,N=0,J=0,le=Array.isArray(d.CellXf),Z,oe=[],Q=[],ye=Array.isArray(l),U=[],ve={},ge=!1,F=!!f.sheetStubs,B=o.split(t),P=0,D=B.length;P!=D;++P){x=B[P].trim();var Y=x.length;if(Y!==0){var re=0;e:for(p=0;p<Y;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(f&&f.cellStyles){if(E=Ae(x.slice(re,p),!0),M=E.r!=null?parseInt(E.r,10):M+1,I=-1,f.sheetRows&&f.sheetRows<M)continue;ve={},ge=!1,E.ht&&(ge=!0,ve.hpt=parseFloat(E.ht),ve.hpx=Yn(ve.hpt)),E.hidden=="1"&&(ge=!0,ve.hidden=!0),E.outlineLevel!=null&&(ge=!0,ve.level=+E.outlineLevel),ge&&(U[M-1]=ve)}break;case"<":re=p;break}if(re>=p)break;if(E=Ae(x.slice(re,p),!0),M=E.r!=null?parseInt(E.r,10):M+1,I=-1,!(f.sheetRows&&f.sheetRows<M)){h.s.r>M-1&&(h.s.r=M-1),h.e.r<M-1&&(h.e.r=M-1),f&&f.cellStyles&&(ve={},ge=!1,E.ht&&(ge=!0,ve.hpt=parseFloat(E.ht),ve.hpx=Yn(ve.hpt)),E.hidden=="1"&&(ge=!0,ve.hidden=!0),E.outlineLevel!=null&&(ge=!0,ve.level=+E.outlineLevel),ge&&(U[M-1]=ve)),m=x.slice(p).split(e);for(var ie=0;ie!=m.length&&m[ie].trim().charAt(0)=="<";++ie);for(m=m.slice(ie),p=0;p!=m.length;++p)if(x=m[p].trim(),x.length!==0){if(w=x.match(r),_=p,v=0,C=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,w!=null&&w.length===2){for(_=0,O=w[1],v=0;v!=O.length&&!((C=O.charCodeAt(v)-64)<1||C>26);++v)_=26*_+C;--_,I=_}else++I;for(v=0;v!=x.length&&x.charCodeAt(v)!==62;++v);if(++v,E=Ae(x.slice(0,v),!0),E.r||(E.r=Ce({r:M-1,c:I})),O=x.slice(v),R={t:""},(w=O.match(s))!=null&&w[1]!==""&&(R.v=$e(w[1])),f.cellFormula){if((w=O.match(i))!=null&&w[1]!==""){if(R.f=$e(Ze(w[1])).replace(/\r\n/g,`
`),f.xlfn||(R.f=vo(R.f)),w[0].indexOf('t="array"')>-1)R.F=(O.match(n)||[])[1],R.F.indexOf(":")>-1&&oe.push([ur(R.F),R.F]);else if(w[0].indexOf('t="shared"')>-1){L=Ae(w[0]);var te=$e(Ze(w[1]));f.xlfn||(te=vo(te)),Q[parseInt(L.si,10)]=[L,te,E.r]}}else(w=O.match(/<f[^>]*\/>/))&&(L=Ae(w[0]),Q[L.si]&&(R.f=rg(Q[L.si][1],Q[L.si][2],E.r)));var H=qr(E.r);for(v=0;v<oe.length;++v)H.r>=oe[v][0].s.r&&H.r<=oe[v][0].e.r&&H.c>=oe[v][0].s.c&&H.c<=oe[v][0].e.c&&(R.F=oe[v][1])}if(E.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(F)R.t="z";else continue;else R.t=E.t||"n";switch(h.s.c>I&&(h.s.c=I),h.e.c<I&&(h.e.c=I),R.t){case"n":if(R.v==""||R.v==null){if(!F)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!F)continue;R.t="z"}else W=Bn[parseInt(R.v,10)],R.v=W.t,R.r=W.r,f.cellHTML&&(R.h=W.h);break;case"str":R.t="s",R.v=R.v!=null?Ze(R.v):"",f.cellHTML&&(R.h=F0(R.v));break;case"inlineStr":w=O.match(a),R.t="s",w!=null&&(W=L0(w[1]))?(R.v=W.t,f.cellHTML&&(R.h=W.h)):R.v="";break;case"b":R.v=rr(R.v);break;case"d":f.cellDates?R.v=Cr(R.v,1):(R.v=Qr(Cr(R.v,1)),R.t="n");break;case"e":(!f||f.cellText!==!1)&&(R.w=R.v),R.v=nf[R.v];break}if(N=J=0,Z=null,le&&E.s!==void 0&&(Z=d.CellXf[E.s],Z!=null&&(Z.numFmtId!=null&&(N=Z.numFmtId),f.cellStyles&&Z.fillId!=null&&(J=Z.fillId))),Lf(R,N,J,f,u,d),f.cellDates&&le&&R.t=="n"&&ln(Ie[N])&&(R.t="d",R.v=oi(R.v)),E.cm&&f.xlmeta){var se=(f.xlmeta.Cell||[])[+E.cm-1];se&&se.type=="XLDAPR"&&(R.D=!0)}if(ye){var y=qr(E.r);l[y.r]||(l[y.r]=[]),l[y.r][y.c]=R}else l[E.r]=R}}}}U.length>0&&(l["!rows"]=U)}}();function zv(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}var Xv=Na;function jv(){}function Kv(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=m1(e),r}function Yv(e){var t=mt(e);return[t]}function Jv(e){var t=Pa(e);return[t]}function qv(e){var t=mt(e),r=e.read_shift(1);return[t,r,"b"]}function Zv(e){var t=Pa(e),r=e.read_shift(1);return[t,r,"b"]}function Qv(e){var t=mt(e),r=e.read_shift(1);return[t,r,"e"]}function e_(e){var t=Pa(e),r=e.read_shift(1);return[t,r,"e"]}function r_(e){var t=mt(e),r=e.read_shift(4);return[t,r,"s"]}function t_(e){var t=Pa(e),r=e.read_shift(4);return[t,r,"s"]}function a_(e){var t=mt(e),r=$r(e);return[t,r,"n"]}function Uf(e){var t=Pa(e),r=$r(e);return[t,r,"n"]}function n_(e){var t=mt(e),r=P0(e);return[t,r,"n"]}function s_(e){var t=Pa(e),r=P0(e);return[t,r,"n"]}function i_(e){var t=mt(e),r=O0(e);return[t,r,"is"]}function c_(e){var t=mt(e),r=Wr(e);return[t,r,"str"]}function o_(e){var t=Pa(e),r=Wr(e);return[t,r,"str"]}function l_(e,t,r){var a=e.l+t,n=mt(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"b"];if(r.cellFormula){e.l+=2;var c=ui(e,a-e.l,r);i[3]=Ur(c,null,n,r.supbooks,r)}else e.l=a;return i}function f_(e,t,r){var a=e.l+t,n=mt(e);n.r=r["!row"];var s=e.read_shift(1),i=[n,s,"e"];if(r.cellFormula){e.l+=2;var c=ui(e,a-e.l,r);i[3]=Ur(c,null,n,r.supbooks,r)}else e.l=a;return i}function u_(e,t,r){var a=e.l+t,n=mt(e);n.r=r["!row"];var s=$r(e),i=[n,s,"n"];if(r.cellFormula){e.l+=2;var c=ui(e,a-e.l,r);i[3]=Ur(c,null,n,r.supbooks,r)}else e.l=a;return i}function h_(e,t,r){var a=e.l+t,n=mt(e);n.r=r["!row"];var s=Wr(e),i=[n,s,"str"];if(r.cellFormula){e.l+=2;var c=ui(e,a-e.l,r);i[3]=Ur(c,null,n,r.supbooks,r)}else e.l=a;return i}var d_=Na;function x_(e,t){var r=e.l+t,a=Na(e),n=D0(e),s=Wr(e),i=Wr(e),c=Wr(e);e.l=r;var o={rfx:a,relId:n,loc:s,display:c};return i&&(o.Tooltip=i),o}function p_(){}function m_(e,t,r){var a=e.l+t,n=rf(e),s=e.read_shift(1),i=[n];if(i[2]=s,r.cellFormula){var c=kv(e,a-e.l,r);i[1]=c}else e.l=a;return i}function g_(e,t,r){var a=e.l+t,n=Na(e),s=[n];if(r.cellFormula){var i=Tv(e,a-e.l,r);s[1]=i,e.l=a}else e.l=a;return s}var v_=["left","right","top","bottom","header","footer"];function __(e){var t={};return v_.forEach(function(r){t[r]=$r(e)}),t}function w_(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function k_(){}function E_(){}function T_(e,t,r,a,n,s,i){if(!e)return e;var c=t||{};a||(a={"!id":{}});var o=c.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,u=!1,d,p,x,m,w,_,v,C,O,R=[];c.biff=12,c["!row"]=0;var E=0,M=!1,I=[],W={},L=c.supbooks||n.supbooks||[[]];if(L.sharedf=W,L.arrayf=I,L.SheetNames=n.SheetNames||n.Sheets.map(function(ye){return ye.name}),!c.supbooks&&(c.supbooks=L,n.Names))for(var N=0;N<n.Names.length;++N)L[0][N+1]=n.Names[N];var J=[],le=[],Z=!1;ei[16]={n:"BrtShortReal",f:Uf};var oe;if(Qt(e,function(U,ve,ge){if(!u)switch(ge){case 148:l=U;break;case 0:d=U,c.sheetRows&&c.sheetRows<=d.r&&(u=!0),C=Dr(m=d.r),c["!row"]=d.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=Yn(U.hpt)),le[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:U[2]},U[2]){case"n":p.v=U[1];break;case"s":v=Bn[U[1]],p.v=v.t,p.r=v.r;break;case"b":p.v=!!U[1];break;case"e":p.v=U[1],c.cellText!==!1&&(p.w=Ma[p.v]);break;case"str":p.t="s",p.v=U[1];break;case"is":p.t="s",p.v=U[1].t;break}if((x=i.CellXf[U[0].iStyleRef])&&Lf(p,x.numFmtId,null,c,s,i),w=U[0].c==-1?w+1:U[0].c,c.dense?(o[m]||(o[m]=[]),o[m][w]=p):o[Tr(w)+C]=p,c.cellFormula){for(M=!1,E=0;E<I.length;++E){var F=I[E];d.r>=F[0].s.r&&d.r<=F[0].e.r&&w>=F[0].s.c&&w<=F[0].e.c&&(p.F=Be(F[0]),M=!0)}!M&&U.length>3&&(p.f=U[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>w&&(f.s.c=w),f.e.r<d.r&&(f.e.r=d.r),f.e.c<w&&(f.e.c=w),c.cellDates&&x&&p.t=="n"&&ln(Ie[x.numFmtId])){var B=Ea(p.v);B&&(p.t="d",p.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}oe&&(oe.type=="XLDAPR"&&(p.D=!0),oe=void 0);break;case 1:case 12:if(!c.sheetStubs||h)break;p={t:"z",v:void 0},w=U[0].c==-1?w+1:U[0].c,c.dense?(o[m]||(o[m]=[]),o[m][w]=p):o[Tr(w)+C]=p,f.s.r>d.r&&(f.s.r=d.r),f.s.c>w&&(f.s.c=w),f.e.r<d.r&&(f.e.r=d.r),f.e.c<w&&(f.e.c=w),oe&&(oe.type=="XLDAPR"&&(p.D=!0),oe=void 0);break;case 176:R.push(U);break;case 49:oe=((c.xlmeta||{}).Cell||[])[U-1];break;case 494:var P=a["!id"][U.relId];for(P?(U.Target=P.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=P):U.relId==""&&(U.Target="#"+U.loc),m=U.rfx.s.r;m<=U.rfx.e.r;++m)for(w=U.rfx.s.c;w<=U.rfx.e.c;++w)c.dense?(o[m]||(o[m]=[]),o[m][w]||(o[m][w]={t:"z",v:void 0}),o[m][w].l=U):(_=Ce({c:w,r:m}),o[_]||(o[_]={t:"z",v:void 0}),o[_].l=U);break;case 426:if(!c.cellFormula)break;I.push(U),O=c.dense?o[m][w]:o[Tr(w)+C],O.f=Ur(U[1],f,{r:d.r,c:w},L,c),O.F=Be(U[0]);break;case 427:if(!c.cellFormula)break;W[Ce(U[0].s)]=U[1],O=c.dense?o[m][w]:o[Tr(w)+C],O.f=Ur(U[1],f,{r:d.r,c:w},L,c);break;case 60:if(!c.cellStyles)break;for(;U.e>=U.s;)J[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},Z||(Z=!0,B0(U.w/256)),cn(J[U.e+1]);break;case 161:o["!autofilter"]={ref:Be(U)};break;case 476:o["!margins"]=U;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),U.name&&(n.Sheets[r].CodeName=U.name),(U.above||U.left)&&(o["!outline"]={above:U.above,left:U.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),U.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ve.T){if(!h||c.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},c),delete c.supbooks,delete c["!row"],!o["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(o["!ref"]=Be(l||f)),c.sheetRows&&o["!ref"]){var Q=ur(o["!ref"]);c.sheetRows<=+Q.e.r&&(Q.e.r=c.sheetRows-1,Q.e.r>f.e.r&&(Q.e.r=f.e.r),Q.e.r<Q.s.r&&(Q.s.r=Q.e.r),Q.e.c>f.e.c&&(Q.e.c=f.e.c),Q.e.c<Q.s.c&&(Q.s.c=Q.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(Q))}return R.length>0&&(o["!merges"]=R),J.length>0&&(o["!cols"]=J),le.length>0&&(o["!rows"]=le),o}function y_(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var n=$e((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,n,a]}function A_(e,t,r,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var c=0,o=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var u=y_(h);f.s.r=f.s.c=0,f.e.c=c,l=Tr(c),u[0].forEach(function(d,p){i[l+Dr(p)]={t:"n",v:d,z:u[1]},o=p}),f.e.r<o&&(f.e.r=o),++c}),c>0&&(i["!ref"]=Be(f)),i}function S_(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,c=e.match(Bf);return c&&$0(c[0],s,n,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function F_(e,t){e.l+=10;var r=Wr(e);return{name:r}}function b_(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Qt(e,function(o,l,f){switch(f){case 550:s["!rel"]=o;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),o.name&&(n.Sheets[r].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var $f=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],C_=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],R_=[],I_=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function To(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=rr(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function yo(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=rr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function Hf(e){yo(e.WBProps,$f),yo(e.CalcPr,I_),To(e.WBView,C_),To(e.Sheets,R_),en.date1904=rr(e.WBProps.date1904)}var O_="][*?/\\".split("");function D_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return O_.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var P_=/<\w+:workbook/;function N_(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(Gr,function(o,l){var f=Ae(o);switch($t(f[0])){case"<?xml":break;case"<workbook":o.match(P_)&&(n="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$f.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=rr(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=Ze(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=$e(Ze(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=Ze(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),rr(f.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=$e(Ze(e.slice(i,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return o}),Qd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Hf(r),r}function M_(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=zi(e),r.name=Wr(e),r}function L_(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Wr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function B_(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function U_(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=g1(e),i=Ev(e,0,r),c=D0(e);e.l=a;var o={Name:s,Ptg:i};return n<268435455&&(o.Sheet=n),c&&(o.Comment=c),o}function $_(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],ei[16]={n:"BrtFRTArchID$",f:B_},Qt(e,function(o,l,f){switch(f){case 156:i.SheetNames.push(o.name),r.Sheets.push(o);break;case 153:r.WBProps=o;break;case 39:o.Sheet!=null&&(t.SID=o.Sheet),o.Ref=Ur(o.Ptg,null,null,i,t),delete t.SID,delete o.Ptg,s.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,o]):i[0]=[f,o],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(o),i.XTI=i.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Hf(r),r.Names=s,r.supbooks=i,r}function H_(e,t,r){return t.slice(-4)===".bin"?$_(e,r):N_(e,r)}function W_(e,t,r,a,n,s,i,c){return t.slice(-4)===".bin"?T_(e,a,r,n,s,i,c):Mv(e,a,r,n,s,i,c)}function V_(e,t,r,a,n,s,i,c){return t.slice(-4)===".bin"?b_(e,a,r,n,s):S_(e,a,r,n,s)}function G_(e,t,r,a,n,s,i,c){return t.slice(-4)===".bin"?Zm():Qm()}function z_(e,t,r,a,n,s,i,c){return t.slice(-4)===".bin"?Jm():qm()}function X_(e,t,r,a){return t.slice(-4)===".bin"?dm(e,r,a):cm(e,r,a)}function j_(e,t,r){return Ff(e,r)}function K_(e,t,r){return t.slice(-4)===".bin"?Cp(e,r):Fp(e,r)}function Y_(e,t,r){return t.slice(-4)===".bin"?jm(e,r):Wm(e,r)}function J_(e,t,r){return t.slice(-4)===".bin"?Um(e):Lm(e)}function q_(e,t,r,a){return r.slice(-4)===".bin"?$m(e,t,r,a):void 0}function Z_(e,t,r){return t.slice(-4)===".bin"?Nm(e,t,r):Mm(e,t,r)}var Wf=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Vf=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function vt(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(Wf),s,i,c,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(Vf),(i=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(i+1),a[c]=s[2].slice(1,s[2].length-1));return a}function Q_(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(Wf),n,s,i,c;if(a)for(c=0;c!=a.length;++c)n=a[c].match(Vf),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(s+1),r[i]=n[2].slice(1,n[2].length-1));return r}var $n;function e2(e,t){var r=$n[e]||$e(e);return r==="General"?Sa(t):pt(r,t)}function r2(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=rr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Cr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[$e(t)]=n}function t2(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ma[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gn(e.v):e.w=Sa(e.v):e.w=e2(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var a=$n[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&ln(a)){var n=Ea(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function a2(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=rm[a.Pattern]||a.Pattern)}e[t.ID]=t}function n2(e,t,r,a,n,s,i,c,o,l){var f="General",h=a.StyleID,u={};l=l||{};var d=[],p=0;for(h===void 0&&c&&(h=c.StyleID),h===void 0&&i&&(h=i.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=rr(e);break;case"String":a.t="s",a.r=zc($e(e)),a.v=e.indexOf("<")>-1?$e(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Cr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=$e(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=nf[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=zc(t||e));break}if(t2(a,f,l),l.cellFormula!==!1)if(a.Formula){var x=$e(a.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),a.f=Qa(x,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Qa("RC:RC",n):a.ArrayRange&&(a.F=Qa(a.ArrayRange,n),o.push([ur(a.F),a.F]))}else for(p=0;p<o.length;++p)n.r>=o[p][0].s.r&&n.r<=o[p][0].e.r&&n.c>=o[p][0].s.c&&n.c<=o[p][0].e.c&&(a.F=o[p][1]);l.cellStyles&&(d.forEach(function(m){!u.patternType&&m.patternType&&(u.patternType=m.patternType)}),a.s=u),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function s2(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ii(e,t){var r=t||{};Rl();var a=kn(b0(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Ze(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=Or(r);return i.type="string",jn.to_workbook(a,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Se){n.indexOf("<"+Se)>=0&&(s=!0)}),s)return x2(a,r);$n={"General Number":"General","General Date":Ie[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ie[15],"Short Date":Ie[14],"Long Time":Ie[19],"Medium Time":Ie[18],"Short Time":Ie[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ie[2],Standard:Ie[4],Percent:Ie[10],Scientific:Ie[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,o=[],l,f={},h=[],u=r.dense?[]:{},d="",p={},x={},m=vt('<Data ss:Type="String">'),w=0,_=0,v=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},R={},E="",M=0,I=[],W={},L={},N=0,J=[],le=[],Z={},oe=[],Q,ye=!1,U=[],ve=[],ge={},F=0,B=0,P={Sheets:[],WBProps:{date1904:!1}},D={};Xn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";c=Xn.exec(a);)switch(c[3]=(Y=c[3]).toLowerCase()){case"data":if(Y=="data"){if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break}if(o[o.length-1][1])break;c[1]==="/"?n2(a.slice(w,c.index),E,m,o[o.length-1][0]=="comment"?Z:p,{c:_,r:v},O,oe[_],x,U,r):(E="",m=vt(c[0]),w=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(le.length>0&&(p.c=le),(!r.sheetRows||r.sheetRows>v)&&p.v!==void 0&&(r.dense?(u[v]||(u[v]=[]),u[v][_]=p):u[Tr(_)+Dr(v)]=p),p.HRef&&(p.l={Target:$e(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=_+(parseInt(p.MergeAcross,10)|0),B=v+(parseInt(p.MergeDown,10)|0),I.push({s:{c:_,r:v},e:{c:F,r:B}})),!r.sheetStubs)p.MergeAcross?_=F+1:++_;else if(p.MergeAcross||p.MergeDown){for(var re=_;re<=F;++re)for(var ie=v;ie<=B;++ie)(re>_||ie>v)&&(r.dense?(u[ie]||(u[ie]=[]),u[ie][re]={t:"z"}):u[Tr(re)+Dr(ie)]={t:"z"});_=F+1}else++_;else p=Q_(c[0]),p.Index&&(_=+p.Index-1),_<C.s.c&&(C.s.c=_),_>C.e.c&&(C.e.c=_),c[0].slice(-2)==="/>"&&++_,le=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(v<C.s.r&&(C.s.r=v),v>C.e.r&&(C.e.r=v),c[0].slice(-2)==="/>"&&(x=vt(c[0]),x.Index&&(v=+x.Index-1)),_=0,++v):(x=vt(c[0]),x.Index&&(v=+x.Index-1),ge={},(x.AutoFitHeight=="0"||x.Height)&&(ge.hpx=parseInt(x.Height,10),ge.hpt=Sf(ge.hpx),ve[v]=ge),x.Hidden=="1"&&(ge.hidden=!0,ve[v]=ge));break;case"worksheet":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"));h.push(d),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(u["!ref"]=Be(C),r.sheetRows&&r.sheetRows<=C.e.r&&(u["!fullref"]=u["!ref"],C.e.r=r.sheetRows-1,u["!ref"]=Be(C))),I.length&&(u["!merges"]=I),oe.length>0&&(u["!cols"]=oe),ve.length>0&&(u["!rows"]=ve),f[d]=u}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=_=0,o.push([c[3],!1]),l=vt(c[0]),d=$e(l.Name),u=r.dense?[]:{},I=[],U=[],ve=[],D={name:d,Hidden:0},P.Sheets.push(D);break;case"table":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else{if(c[0].slice(-2)=="/>")break;o.push([c[3],!1]),oe=[],ye=!1}break;case"style":c[1]==="/"?a2(O,R,r):R=vt(c[0]);break;case"numberformat":R.nf=$e(vt(c[0]).Format||"General"),$n[R.nf]&&(R.nf=$n[R.nf]);for(var te=0;te!=392&&Ie[te]!=R.nf;++te);if(te==392){for(te=57;te!=392;++te)if(Ie[te]==null){ya(R.nf,te);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(Q=vt(c[0]),Q.Hidden&&(Q.hidden=!0,delete Q.Hidden),Q.Width&&(Q.wpx=parseInt(Q.Width,10)),!ye&&Q.wpx>10){ye=!0,Jr=yf;for(var H=0;H<oe.length;++H)oe[H]&&cn(oe[H])}ye&&cn(Q),oe[Q.Index-1||oe.length]=Q;for(var se=0;se<+Q.Span;++se)oe[oe.length]=Or(Q);break;case"namedrange":if(c[1]==="/")break;P.Names||(P.Names=[]);var y=Ae(c[0]),_e={Name:y.Name,Ref:Qa(y.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(_e.Sheet=P.Sheets.length-1),P.Names.push(_e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?E+=a.slice(M,c.index):M=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=vt(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?W1(W,Y,a.slice(N,c.index)):N=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else o.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"));s2(Z),le.push(Z)}else o.push([c[3],!1]),l=vt(c[0]),Z={a:l.Author};break;case"autofilter":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var he=vt(c[0]);u["!autofilter"]={ref:Qa(he.Range).replace(/\$/g,"")},o.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"null":break;default:if(o.length==0&&c[3]=="document"||o.length==0&&c[3]=="uof")return Ro(a,r);var we=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:we=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:we=!1}break;case"excelworkbook":switch(c[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:we=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:we=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(N,c.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else N=c.index+c[0].length;break;case"header":u["!margins"]||Un(u["!margins"]={},"xlml"),isNaN(+Ae(c[0]).Margin)||(u["!margins"].header=+Ae(c[0]).Margin);break;case"footer":u["!margins"]||Un(u["!margins"]={},"xlml"),isNaN(+Ae(c[0]).Margin)||(u["!margins"].footer=+Ae(c[0]).Margin);break;case"pagemargins":var me=Ae(c[0]);u["!margins"]||Un(u["!margins"]={},"xlml"),isNaN(+me.Top)||(u["!margins"].top=+me.Top),isNaN(+me.Left)||(u["!margins"].left=+me.Left),isNaN(+me.Right)||(u["!margins"].right=+me.Right),isNaN(+me.Bottom)||(u["!margins"].bottom=+me.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:we=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:we=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:we=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:we=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:we=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:we=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:we=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:we=!1}break;case"smarttags":break;default:we=!1;break}if(we||c[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?r2(L,Y,J,a.slice(N,c.index)):(J=c,N=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+o.join("|")}var q={};return!r.bookSheets&&!r.bookProps&&(q.Sheets=f),q.SheetNames=h,q.Workbook=P,q.SSF=Or(Ie),q.Props=W,q.Custprops=L,q}function Yi(e,t){switch(V0(t=t||{}),t.type||"base64"){case"base64":return Ii(ft(e),t);case"binary":case"buffer":case"file":return Ii(e,t);case"array":return Ii(Da(e),t)}}function i2(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=w1(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=k1(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var c2=[60,1084,2066,2165,2175];function o2(e,t,r,a,n){var s=a,i=[],c=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}i.push(c),r.l+=s;for(var o=Yt(r,r.l),l=Ji[o],f=0;l!=null&&c2.indexOf(o)>-1;)s=Yt(r,r.l+2),f=r.l+4,o==2066?f+=4:(o==2165||o==2175)&&(f+=12),c=r.slice(f,r.l+4+s),i.push(c),r.l+=4+s,l=Ji[o=Yt(r,r.l)];var h=ca(i);Ir(h,0);var u=0;h.lens=[];for(var d=0;d<i.length;++d)h.lens.push(u),u+=i[d].length;if(h.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+a;return t.f(h,h.length,n)}function Ot(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ie[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ma[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Gn(e.v):e.w=Sa(e.v):e.w=pt(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&ln(Ie[a]||String(a))){var n=Ea(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Fs(e,t,r){return{v:e,ixfe:t,t:r}}function l2(e,t){var r={opts:{}},a={},n=t.dense?[]:{},s={},i={},c=null,o=[],l="",f={},h,u="",d,p,x,m,w={},_=[],v,C,O=[],R=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},I=function(Te){return Te<8?Aa[Te]:Te<64&&R[Te-8]||Aa[Te]},W=function(Te,We,Ar){var er=We.XF.data;if(!(!er||!er.patternType||!Ar||!Ar.cellStyles)){We.s={},We.s.patternType=er.patternType;var st;(st=Kn(I(er.icvFore)))&&(We.s.fgColor={rgb:st}),(st=Kn(I(er.icvBack)))&&(We.s.bgColor={rgb:st})}},L=function(Te,We,Ar){if(!(ge>1)&&!(Ar.sheetRows&&Te.r>=Ar.sheetRows)){if(Ar.cellStyles&&We.XF&&We.XF.data&&W(Te,We,Ar),delete We.ixfe,delete We.XF,h=Te,u=Ce(Te),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Te.r<i.s.r&&(i.s.r=Te.r),Te.c<i.s.c&&(i.s.c=Te.c),Te.r+1>i.e.r&&(i.e.r=Te.r+1),Te.c+1>i.e.c&&(i.e.c=Te.c+1),Ar.cellFormula&&We.f){for(var er=0;er<_.length;++er)if(!(_[er][0].s.c>Te.c||_[er][0].s.r>Te.r)&&!(_[er][0].e.c<Te.c||_[er][0].e.r<Te.r)){We.F=Be(_[er][0]),(_[er][0].s.c!=Te.c||_[er][0].s.r!=Te.r)&&delete We.f,We.f&&(We.f=""+Ur(_[er][1],i,Te,U,N));break}}Ar.dense?(n[Te.r]||(n[Te.r]=[]),n[Te.r][Te.c]=We):n[u]=We}},N={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(N.password=t.password);var J,le=[],Z=[],oe=[],Q=[],ye=!1,U=[];U.SheetNames=N.snames,U.sharedf=N.sharedf,U.arrayf=N.arrayf,U.names=[],U.XTI=[];var ve=0,ge=0,F=0,B=[],P=[],D;N.codepage=1200,yt(1200);for(var Y=!1;e.l<e.length-1;){var re=e.l,ie=e.read_shift(2);if(ie===0&&ve===10)break;var te=e.l===e.length?0:e.read_shift(2),H=Ji[ie];if(H&&H.f){if(t.bookSheets&&ve===133&&ie!==133)break;if(ve=ie,H.r===2||H.r==12){var se=e.read_shift(2);if(te-=2,!N.enc&&se!==ie&&((se&255)<<8|se>>8)!==ie)throw new Error("rt mismatch: "+se+"!="+ie);H.r==12&&(e.l+=10,te-=10)}var y={};if(ie===10?y=H.f(e,te,N):y=o2(ie,H,e,te,N),ge==0&&[9,521,1033,2057].indexOf(ve)===-1)continue;switch(ie){case 34:r.opts.Date1904=E.WBProps.date1904=y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(e.l=0),N.enc=y,!t.password)throw new Error("File is password-protected");if(y.valid==null)throw new Error("Encryption scheme unsupported");if(!y.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=y;break;case 66:var _e=Number(y);switch(_e){case 21010:_e=1200;break;case 32768:_e=1e4;break;case 32769:_e=1252;break}yt(N.codepage=_e),Y=!0;break;case 317:N.rrtabid=y;break;case 25:N.winlocked=y;break;case 439:r.opts.RefreshAll=y;break;case 12:r.opts.CalcCount=y;break;case 16:r.opts.CalcDelta=y;break;case 17:r.opts.CalcIter=y;break;case 13:r.opts.CalcMode=y;break;case 14:r.opts.CalcPrecision=y;break;case 95:r.opts.CalcSaveRecalc=y;break;case 15:N.CalcRefMode=y;break;case 2211:r.opts.FullCalc=y;break;case 129:y.fDialog&&(n["!type"]="dialog"),y.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),y.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:O.push(y);break;case 430:U.push([y]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(y);break;case 24:case 536:D={Name:y.Name,Ref:Ur(y.rgce,i,null,U,N)},y.itab>0&&(D.Sheet=y.itab-1),U.names.push(D),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(y),y.Name=="_xlnm._FilterDatabase"&&y.itab>0&&y.rgce&&y.rgce[0]&&y.rgce[0][0]&&y.rgce[0][0][0]=="PtgArea3d"&&(P[y.itab-1]={ref:Be(y.rgce[0][0][1][2])});break;case 22:N.ExternCount=y;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(y),U.XTI=U.XTI.concat(y);break;case 2196:if(N.biff<8)break;D!=null&&(D.Comment=y[1]);break;case 18:n["!protect"]=y;break;case 19:y!==0&&N.WTF&&console.error("Password verifier: "+y);break;case 133:s[y.pos]=y,N.snames.push(y.name);break;case 10:{if(--ge)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=Be(i),t.sheetRows&&t.sheetRows<=i.e.r){var he=i.e.r;i.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Be(i),i.e.r=he}i.e.r++,i.e.c++}le.length>0&&(n["!merges"]=le),Z.length>0&&(n["!objects"]=Z),oe.length>0&&(n["!cols"]=oe),Q.length>0&&(n["!rows"]=Q),E.Sheets.push(M)}l===""?f=n:a[l]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[y.BIFFVer]||8),N.biffguess=y.BIFFVer==0,y.BIFFVer==0&&y.dt==4096&&(N.biff=5,Y=!0,yt(N.codepage=28591)),N.biff==8&&y.BIFFVer==0&&y.dt==16&&(N.biff=2),ge++)break;if(n=t.dense?[]:{},N.biff<8&&!Y&&(Y=!0,yt(N.codepage=t.codepage||1252)),N.biff<5||y.BIFFVer==0&&y.dt==4096){l===""&&(l="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var we={pos:e.l-te,name:l};s[we.pos]=we,N.snames.push(l)}else l=(s[re]||{name:""}).name;y.dt==32&&(n["!type"]="chart"),y.dt==64&&(n["!type"]="macro"),le=[],Z=[],N.arrayf=_=[],oe=[],Q=[],ye=!1,M={Hidden:(s[re]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[y.r]||[])[y.c]:n[Ce({c:y.c,r:y.r})])&&++y.c,v={ixfe:y.ixfe,XF:O[y.ixfe]||{},v:y.val,t:"n"},F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:y.c,r:y.r},v,t);break;case 5:case 517:v={ixfe:y.ixfe,XF:O[y.ixfe],v:y.val,t:y.t},F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:y.c,r:y.r},v,t);break;case 638:v={ixfe:y.ixfe,XF:O[y.ixfe],v:y.rknum,t:"n"},F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:y.c,r:y.r},v,t);break;case 189:for(var me=y.c;me<=y.C;++me){var q=y.rkrec[me-y.c][0];v={ixfe:q,XF:O[q],v:y.rkrec[me-y.c][1],t:"n"},F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:me,r:y.r},v,t)}break;case 6:case 518:case 1030:{if(y.val=="String"){c=y;break}if(v=Fs(y.val,y.cell.ixfe,y.tt),v.XF=O[v.ixfe],t.cellFormula){var Se=y.formula;if(Se&&Se[0]&&Se[0][0]&&Se[0][0][0]=="PtgExp"){var He=Se[0][0][1][0],Pe=Se[0][0][1][1],Ke=Ce({r:He,c:Pe});w[Ke]?v.f=""+Ur(y.formula,i,y.cell,U,N):v.F=((t.dense?(n[He]||[])[Pe]:n[Ke])||{}).F}else v.f=""+Ur(y.formula,i,y.cell,U,N)}F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L(y.cell,v,t),c=y}break;case 7:case 519:if(c)c.val=y,v=Fs(y,c.cell.ixfe,"s"),v.XF=O[v.ixfe],t.cellFormula&&(v.f=""+Ur(c.formula,i,c.cell,U,N)),F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L(c.cell,v,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(y);var cr=Ce(y[0].s);if(d=t.dense?(n[y[0].s.r]||[])[y[0].s.c]:n[cr],t.cellFormula&&d){if(!c||!cr||!d)break;d.f=""+Ur(y[1],i,y[0],U,N),d.F=Be(y[0])}}break;case 1212:{if(!t.cellFormula)break;if(u){if(!c)break;w[Ce(c.cell)]=y[0],d=t.dense?(n[c.cell.r]||[])[c.cell.c]:n[Ce(c.cell)],(d||{}).f=""+Ur(y[0],i,h,U,N)}}break;case 253:v=Fs(o[y.isst].t,y.ixfe,"s"),o[y.isst].h&&(v.h=o[y.isst].h),v.XF=O[v.ixfe],F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:y.c,r:y.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:y.ixfe,XF:O[y.ixfe],t:"z"},F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:y.c,r:y.r},v,t));break;case 190:if(t.sheetStubs)for(var Qe=y.c;Qe<=y.C;++Qe){var qe=y.ixfe[Qe-y.c];v={ixfe:qe,XF:O[qe],t:"z"},F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:Qe,r:y.r},v,t)}break;case 214:case 516:case 4:v=Fs(y.val,y.ixfe,"s"),v.XF=O[v.ixfe],F>0&&(v.z=B[v.ixfe>>8&63]),Ot(v,t,r.opts.Date1904),L({c:y.c,r:y.r},v,t);break;case 0:case 512:ge===1&&(i=y);break;case 252:o=y;break;case 1054:if(N.biff==4){B[F++]=y[1];for(var hr=0;hr<F+163&&Ie[hr]!=y[1];++hr);hr>=163&&ya(y[1],F+163)}else ya(y[1],y[0]);break;case 30:{B[F++]=y;for(var tr=0;tr<F+163&&Ie[tr]!=y;++tr);tr>=163&&ya(y,F+163)}break;case 229:le=le.concat(y);break;case 93:Z[y.cmo[0]]=N.lastobj=y;break;case 438:N.lastobj.TxO=y;break;case 127:N.lastobj.ImData=y;break;case 440:for(m=y[0].s.r;m<=y[0].e.r;++m)for(x=y[0].s.c;x<=y[0].e.c;++x)d=t.dense?(n[m]||[])[x]:n[Ce({c:x,r:m})],d&&(d.l=y[1]);break;case 2048:for(m=y[0].s.r;m<=y[0].e.r;++m)for(x=y[0].s.c;x<=y[0].e.c;++x)d=t.dense?(n[m]||[])[x]:n[Ce({c:x,r:m})],d&&d.l&&(d.l.Tooltip=y[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;d=t.dense?(n[y[0].r]||[])[y[0].c]:n[Ce(y[0])];var zr=Z[y[2]];d||(t.dense?(n[y[0].r]||(n[y[0].r]=[]),d=n[y[0].r][y[0].c]={t:"z"}):d=n[Ce(y[0])]={t:"z"},i.e.r=Math.max(i.e.r,y[0].r),i.s.r=Math.min(i.s.r,y[0].r),i.e.c=Math.max(i.e.c,y[0].c),i.s.c=Math.min(i.s.c,y[0].c)),d.c||(d.c=[]),p={a:y[1],t:zr.TxO.t},d.c.push(p)}break;case 2173:Im(O[y.ixfe],y.ext);break;case 125:{if(!N.cellStyles)break;for(;y.e>=y.s;)oe[y.e--]={width:y.w/256,level:y.level||0,hidden:!!(y.flags&1)},ye||(ye=!0,B0(y.w/256)),cn(oe[y.e+1])}break;case 520:{var or={};y.level!=null&&(Q[y.r]=or,or.level=y.level),y.hidden&&(Q[y.r]=or,or.hidden=!0),y.hpt&&(Q[y.r]=or,or.hpt=y.hpt,or.hpx=Yn(y.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Un(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=y;break;case 161:n["!margins"]||Un(n["!margins"]={}),n["!margins"].header=y.header,n["!margins"].footer=y.footer;break;case 574:y.RTL&&(E.Views[0].RTL=!0);break;case 146:R=y;break;case 2198:J=y;break;case 140:C=y;break;case 442:l?M.CodeName=y||M.name:E.WBProps.CodeName=y||"ThisWorkbook";break}}else H||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=te}return r.SheetNames=Ut(s).sort(function(pr,Te){return Number(pr)-Number(Te)}).map(function(pr){return s[pr].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&P.forEach(function(pr,Te){r.Sheets[r.SheetNames[Te]]["!autofilter"]=pr}),r.Strings=o,r.SSF=Or(Ie),N.enc&&(r.Encryption=N.enc),J&&(r.Themes=J),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),U.names.length>0&&(E.Names=U.names),r.Workbook=E,r}var Ao={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function f2(e,t,r){var a=Le.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=co(a,F1,Ao.DSI);for(var s in n)t[s]=n[s]}catch(l){if(r.WTF)throw l}var i=Le.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var c=co(i,b1,Ao.SI);for(var o in c)t[o]==null&&(t[o]=c[o])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(cf(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Gf(e,t){t||(t={}),V0(t),vl(),t.codepage&&k0(t.codepage);var r,a;if(e.FullPaths){if(Le.find(e,"/encryption"))throw new Error("File is password-protected");r=Le.find(e,"!CompObj"),a=Le.find(e,"/Workbook")||Le.find(e,"/Book")}else{switch(t.type){case"base64":e=Tt(ft(e));break;case"binary":e=Tt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ir(e,0),a={content:e}}var n,s;if(r&&i2(r),t.bookProps&&!t.bookSheets)n={};else{var i=Me?"buffer":"array";if(a&&a.content)n=l2(a.content,t);else if((s=Le.find(e,"PerfectOffice_MAIN"))&&s.content)n=Ln.to_workbook(s.content,(t.type=i,t));else if((s=Le.find(e,"NativeContent_MAIN"))&&s.content)n=Ln.to_workbook(s.content,(t.type=i,t));else throw(s=Le.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Le.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Ym(e))}var c={};return e.FullPaths&&f2(e,c,t),n.Props=n.Custprops=c,t.bookFiles&&(n.cfb=e),n}var ei={0:{f:zv},1:{f:Yv},2:{f:n_},3:{f:Qv},4:{f:qv},5:{f:a_},6:{f:c_},7:{f:r_},8:{f:h_},9:{f:u_},10:{f:l_},11:{f:f_},12:{f:Jv},13:{f:s_},14:{f:e_},15:{f:Zv},16:{f:Uf},17:{f:o_},18:{f:t_},19:{f:O0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:U_},40:{},42:{},43:{f:lm},44:{f:om},45:{f:fm},46:{f:hm},47:{f:um},48:{},49:{f:d1},50:{},51:{f:Dm},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:_f},62:{f:i_},63:{f:Bm},64:{f:k_},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:w_},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Kv},148:{f:Xv,p:16},151:{f:p_},152:{},153:{f:L_},154:{},155:{},156:{f:M_},157:{},158:{},159:{T:1,f:bp},160:{T:-1},161:{T:1,f:Na},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:d_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Om},336:{T:-1},337:{f:Pm,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:zi},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vf},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:m_},427:{f:g_},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:__},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jv},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:x_},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:zi},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Xm},633:{T:1},634:{T:-1},635:{T:1,f:zm},636:{T:-1},637:{f:p1},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:F_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:E_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ji={6:{f:Ci},10:{f:aa},12:{f:vr},13:{f:vr},14:{f:dr},15:{f:dr},16:{f:$r},17:{f:dr},18:{f:dr},19:{f:vr},20:{f:uo},21:{f:uo},23:{f:vf},24:{f:xo},25:{f:dr},26:{},27:{},28:{f:Vx},29:{},34:{f:dr},35:{f:ho},38:{f:$r},39:{f:$r},40:{f:$r},41:{f:$r},42:{f:dr},43:{f:dr},47:{f:jp},49:{f:yx},51:{f:vr},60:{},61:{f:kx},64:{f:dr},65:{f:Tx},66:{f:vr},77:{},80:{},81:{},82:{},85:{f:vr},89:{},90:{},91:{},92:{f:dx},93:{f:zx},94:{},95:{f:dr},96:{},97:{},99:{f:dr},125:{f:_f},128:{f:Px},129:{f:xx},130:{f:vr},131:{f:dr},132:{f:dr},133:{f:px},134:{},140:{f:qx},141:{f:vr},144:{},146:{f:Qx},151:{},152:{},153:{},154:{},155:{},156:{f:vr},157:{},158:{},160:{f:np},161:{f:rp},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Rx},190:{f:Ix},193:{f:aa},197:{},198:{},199:{},200:{},201:{},202:{f:dr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vr},220:{},221:{f:dr},222:{},224:{f:Dx},225:{f:hx},226:{f:aa},227:{},229:{f:Gx},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:mx},253:{f:Ax},255:{f:gx},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:hf},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dr},353:{f:aa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Mx},431:{f:dr},432:{},433:{},434:{},437:{},438:{f:Kx},439:{f:dr},440:{f:Yx},441:{},442:{f:is},443:{},444:{f:vr},445:{},446:{},448:{f:aa},449:{f:wx,r:2},450:{f:aa},512:{f:lo},513:{f:ap},515:{f:Nx},516:{f:Sx},517:{f:fo},519:{f:sp},520:{f:vx},523:{},545:{f:po},549:{f:oo},566:{},574:{f:Ex},638:{f:Cx},659:{},1048:{},1054:{f:Fx},1084:{},1212:{f:$x},2048:{f:Jx},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ys},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:aa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ep,r:12},2173:{f:Rm,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Ux,r:12},2197:{},2198:{f:ym,r:12},2199:{},2200:{},2201:{},2202:{f:Hx,r:12},2203:{f:aa},2204:{},2205:{},2206:{},2207:{},2211:{f:_x},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tp},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Zx},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:lo},1:{},2:{f:lp},3:{f:op},4:{f:cp},5:{f:fo},7:{f:fp},8:{},9:{f:ys},11:{},22:{f:vr},30:{f:bx},31:{},32:{},33:{f:po},36:{},37:{f:oo},50:{f:up},62:{},52:{},67:{},68:{f:vr},69:{},86:{},126:{},127:{f:ip},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hp},223:{},234:{},354:{},421:{},518:{f:Ci},521:{f:ys},536:{f:xo},547:{f:ho},561:{},579:{},1030:{f:Ci},1033:{f:ys},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _t(e,t,r,a){var n=t;if(!isNaN(n)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&Zl(r)&&e.push(r)}}function So(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,c=s&&s.index||e.length,o=Nd(e.slice(i,c),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,h=0,u=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<o.length;++i){var x=o[i].trim(),m=x.slice(0,3).toLowerCase();if(m=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}f=0;continue}if(!(m!="<td"&&m!="<th")){var w=x.split(/<\/t[dh]>/i);for(c=0;c<w.length;++c){var _=w[c].trim();if(_.match(/<t[dh]/i)){for(var v=_,C=0;v.charAt(0)=="<"&&(C=v.indexOf(">"))>-1;)v=v.slice(C+1);for(var O=0;O<p.length;++O){var R=p[O];R.s.c==f&&R.s.r<l&&l<=R.e.r&&(f=R.e.c+1,O=-1)}var E=Ae(_.slice(0,_.indexOf(">")));u=E.colspan?+E.colspan:1,((h=+E.rowspan)>1||u>1)&&p.push({s:{r:l,c:f},e:{r:l+(h||1)-1,c:f+u-1}});var M=E.t||E["data-t"]||"";if(!v.length){f+=u;continue}if(v=Ul(v),d.s.r>l&&(d.s.r=l),d.e.r<l&&(d.e.r=l),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!v.length){f+=u;continue}var I={t:"s",v};r.raw||!v.trim().length||M=="s"||(v==="TRUE"?I={t:"b",v:!0}:v==="FALSE"?I={t:"b",v:!1}:isNaN(Ct(v))?isNaN(sn(v).getDate())||(I={t:"d",v:Cr(v)},r.cellDates||(I={t:"n",v:Qr(I.v)}),I.z=r.dateNF||Ie[14]):I={t:"n",v:Ct(v)}),r.dense?(a[l]||(a[l]=[]),a[l][f]=I):a[Ce({r:l,c:f})]=I,f+=u}}}}return a["!ref"]=Be(d),p.length&&(a["!merges"]=p),a}function u2(e,t,r,a){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var c=0,o=0,l=0;l<n.length;++l)if(!(n[l].s.r>r||n[l].s.c>i)&&!(n[l].e.r<r||n[l].e.c<i)){if(n[l].s.r<r||n[l].s.c<i){c=-1;break}c=n[l].e.r-n[l].s.r+1,o=n[l].e.c-n[l].s.c+1;break}if(!(c<0)){var f=Ce({r,c:i}),h=a.dense?(e[r]||[])[i]:e[f],u=h&&h.v!=null&&(h.h||F0(h.w||(Zt(h),h.w)||""))||"",d={};c>1&&(d.rowspan=c),o>1&&(d.colspan=o),a.editable?u='<span contenteditable="true">'+u+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+h.l.Target+'">'+u+"</a>")),d.id=(a.id||"sjs")+"-"+f,s.push(qd("td",u,d))}}var p="<tr>";return p+s.join("")+"</tr>"}var h2='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',d2="</body></html>";function x2(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return da(So(r[0],t),t);var a=z0();return r.forEach(function(n,s){X0(a,So(n,t),"Sheet"+(s+1))}),a}function p2(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function m2(e,t){var r=t||{},a=r.header!=null?r.header:h2,n=r.footer!=null?r.footer:d2,s=[a],i=fn(e["!ref"]);r.dense=Array.isArray(e),s.push(p2(e,i,r));for(var c=i.s.r;c<=i.e.r;++c)s.push(u2(e,i,c,r));return s.push("</table>"+n),s.join("")}function zf(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var i=typeof a.origin=="string"?qr(a.origin):a.origin;n=i.r,s=i.c}var c=t.getElementsByTagName("tr"),o=Math.min(a.sheetRows||1e7,c.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var f=fn(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var h=[],u=0,d=e["!rows"]||(e["!rows"]=[]),p=0,x=0,m=0,w=0,_=0,v=0;for(e["!cols"]||(e["!cols"]=[]);p<c.length&&x<o;++p){var C=c[p];if(Fo(C)){if(a.display)continue;d[x]={hidden:!0}}var O=C.children;for(m=w=0;m<O.length;++m){var R=O[m];if(!(a.display&&Fo(R))){var E=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):Ul(R.innerHTML),M=R.getAttribute("data-z")||R.getAttribute("z");for(u=0;u<h.length;++u){var I=h[u];I.s.c==w+s&&I.s.r<x+n&&x+n<=I.e.r&&(w=I.e.c+1-s,u=-1)}v=+R.getAttribute("colspan")||1,((_=+R.getAttribute("rowspan")||1)>1||v>1)&&h.push({s:{r:x+n,c:w+s},e:{r:x+n+(_||1)-1,c:w+s+(v||1)-1}});var W={t:"s",v:E},L=R.getAttribute("data-t")||R.getAttribute("t")||"";E!=null&&(E.length==0?W.t=L||"z":a.raw||E.trim().length==0||L=="s"||(E==="TRUE"?W={t:"b",v:!0}:E==="FALSE"?W={t:"b",v:!1}:isNaN(Ct(E))?isNaN(sn(E).getDate())||(W={t:"d",v:Cr(E)},a.cellDates||(W={t:"n",v:Qr(W.v)}),W.z=a.dateNF||Ie[14]):W={t:"n",v:Ct(E)})),W.z===void 0&&M!=null&&(W.z=M);var N="",J=R.getElementsByTagName("A");if(J&&J.length)for(var le=0;le<J.length&&!(J[le].hasAttribute("href")&&(N=J[le].getAttribute("href"),N.charAt(0)!="#"));++le);N&&N.charAt(0)!="#"&&(W.l={Target:N}),a.dense?(e[x+n]||(e[x+n]=[]),e[x+n][w+s]=W):e[Ce({c:w+s,r:x+n})]=W,l.e.c<w+s&&(l.e.c=w+s),w+=v}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,x-1+n),e["!ref"]=Be(l),x>=o&&(e["!fullref"]=Be((l.e.r=c.length-p+x-1+n,l))),e}function Xf(e,t){var r=t||{},a=r.dense?[]:{};return zf(a,e,t)}function g2(e,t){return da(Xf(e,t),t)}function Fo(e){var t="",r=v2(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function v2(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _2(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=$e(t.replace(/<[^>]*>/g,""));return[r]}var bo={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function jf(e,t){var r=t||{},a=b0(e),n=[],s,i,c={name:""},o="",l=0,f,h,u={},d=[],p=r.dense?[]:{},x,m,w={value:""},_="",v=0,C=[],O=-1,R=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,I={},W=[],L={},N=0,J=0,le=[],Z=1,oe=1,Q=[],ye={Names:[]},U={},ve=["",""],ge=[],F={},B="",P=0,D=!1,Y=!1,re=0;for(Xn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Xn.exec(a);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"工作表":x[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?p["!ref"]=Be(E):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=Be(E)),W.length&&(p["!merges"]=W),le.length&&(p["!rows"]=le),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),u[f.name]=p,Y=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=Ae(x[0],!1),O=R=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,p=r.dense?[]:{},W=[],le=[],Y=!0);break;case"table-row-group":x[1]==="/"?--M:++M;break;case"table-row":case"行":if(x[1]==="/"){O+=Z,Z=1;break}if(h=Ae(x[0],!1),h.行号?O=h.行号-1:O==-1&&(O=0),Z=+h["number-rows-repeated"]||1,Z<10)for(re=0;re<Z;++re)M>0&&(le[O+re]={level:M});R=-1;break;case"covered-table-cell":x[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(p[O]||(p[O]=[]),p[O][R]={t:"z"}):p[Ce({r:O,c:R})]={t:"z"}),_="",C=[];break;case"table-cell":case"数据":if(x[0].charAt(x[0].length-2)==="/")++R,w=Ae(x[0],!1),oe=parseInt(w["number-columns-repeated"]||"1",10),m={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(m.f=Eo($e(w.formula))),(w.数据类型||w["value-type"])=="string"&&(m.t="s",m.v=$e(w["string-value"]||""),r.dense?(p[O]||(p[O]=[]),p[O][R]=m):p[Ce({r:O,c:R})]=m),R+=oe-1;else if(x[1]!=="/"){++R,_="",v=0,C=[],oe=1;var ie=Z?O+Z-1:O;if(R>E.e.c&&(E.e.c=R),R<E.s.c&&(E.s.c=R),O<E.s.r&&(E.s.r=O),ie>E.e.r&&(E.e.r=ie),w=Ae(x[0],!1),ge=[],F={},m={t:w.数据类型||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=$e(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(N=parseInt(w["number-matrix-rows-spanned"],10)||0,J=parseInt(w["number-matrix-columns-spanned"],10)||0,L={s:{r:O,c:R},e:{r:O+N-1,c:R+J-1}},m.F=Be(L),Q.push([L,m.F])),w.formula)m.f=Eo(w.formula);else for(re=0;re<Q.length;++re)O>=Q[re][0].s.r&&O<=Q[re][0].e.r&&R>=Q[re][0].s.c&&R<=Q[re][0].e.c&&(m.F=Q[re][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(N=parseInt(w["number-rows-spanned"],10)||0,J=parseInt(w["number-columns-spanned"],10)||0,L={s:{r:O,c:R},e:{r:O+N-1,c:R+J-1}},W.push(L)),w["number-columns-repeated"]&&(oe=parseInt(w["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=rr(w["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(w.value);break;case"percentage":m.t="n",m.v=parseFloat(w.value);break;case"currency":m.t="n",m.v=parseFloat(w.value);break;case"date":m.t="d",m.v=Cr(w["date-value"]),r.cellDates||(m.t="n",m.v=Qr(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=Od(w["time-value"])/86400,r.cellDates&&(m.t="d",m.v=oi(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(w.数据数值);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",w["string-value"]!=null&&(_=$e(w["string-value"]),C=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(D=!1,m.t==="s"&&(m.v=_||"",C.length&&(m.R=C),D=v==0),U.Target&&(m.l=U),ge.length>0&&(m.c=ge,ge=[]),_&&r.cellText!==!1&&(m.w=_),D&&(m.t="z",delete m.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var te=0;te<Z;++te){if(oe=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(p[O+te]||(p[O+te]=[]),p[O+te][R]=te==0?m:Or(m);--oe>0;)p[O+te][R+oe]=Or(m);else for(p[Ce({r:O+te,c:R})]=m;--oe>0;)p[Ce({r:O+te,c:R+oe})]=Or(m);E.e.c<=R&&(E.e.c=R)}oe=parseInt(w["number-columns-repeated"]||"1",10),R+=oe-1,oe=0,m={},_="",C=[]}U={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=n.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=n.pop())[0]!==x[3])throw"Bad state: "+s;F.t=_,C.length&&(F.R=C),F.a=B,ge.push(F)}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);B="",P=0,_="",v=0,C=[];break;case"creator":x[1]==="/"?B=a.slice(P,x.index):P=x.index+x[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=n.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&n.push([x[3],!1]);_="",v=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(I[c.name]=o,(s=n.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(o="",c=Ae(x[0],!1),n.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=Ae(x[0],!1),o+=bo[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=Ae(x[0],!1),o+=bo[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":o+=a.slice(l,x.index);break}else l=x.index+x[0].length;break;case"named-range":i=Ae(x[0],!1),ve=Ri(i["cell-range-address"]);var H={Name:i.name,Ref:ve[0]+"!"+ve[1]};Y&&(H.Sheet=d.length),ye.Names.push(H);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(x[1]==="/"&&(!w||!w["string-value"])){var se=_2(a.slice(v,x.index));_=(_.length>0?_+`
`:"")+se[0]}else Ae(x[0],!1),v=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ve=Ri(Ae(x[0])["target-range-address"]),u[ve[0]]["!autofilter"]={ref:ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(U=Ae(x[0],!1),!U.href)break;U.Target=$e(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(ve=Ri(U.Target.slice(1)),U.Target="#"+ve[0]+"!"+ve[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(x)}}var y={Sheets:u,SheetNames:d,Workbook:ye};return r.bookSheets&&delete y.Sheets,y}function Co(e,t){t=t||{},xt(e,"META-INF/manifest.xml")&&N1(gr(e,"META-INF/manifest.xml"),t);var r=lt(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=jf(Ze(r),t);return xt(e,"meta.xml")&&(a.Props=sf(gr(e,"meta.xml"))),a}function Ro(e,t){return jf(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function H0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function qi(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ze(Da(e))}function Zi(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function Io(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function w2(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function Jn(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function yr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Hr(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Jn(e,r),s=n&7;n=Math.floor(n/8);var i=0,c;if(n==0)break;switch(s){case 0:{for(var o=r[0];e[r[0]++]>=128;);c=e.slice(o,r[0])}break;case 5:i=4,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Jn(e,r),c=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var l={data:c,type:s};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function W0(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function k2(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Jn(e,a),s=Hr(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:yr(s[1][0].data),messages:[]};s[2].forEach(function(c){var o=Hr(c.data),l=yr(o[3][0].data);i.messages.push({meta:o,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(t=s[3])!=null&&t[0]&&(i.merge=yr(s[3][0].data)>>>0>0),r.push(i)}return r}function E2(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Jn(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var c=i-59;i=t[r[0]],c>1&&(i|=t[r[0]+1]<<8),c>2&&(i|=t[r[0]+2]<<16),c>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=c}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var o=0,l=0;if(s==1?(l=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,s==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Zi(n)],o==0)throw new Error("Invalid offset 0");if(o>n[0].length)throw new Error("Invalid offset beyond length");if(l>=o)for(n.push(n[0].slice(-o)),l-=o;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-o,-o+l))}}var f=Zi(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function T2(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(E2(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Zi(t)}function y2(e,t,r,a){var n=H0(e),s=n.getUint32(4,!0),i=(a>1?12:8)+Io(s&(a>1?3470:398))*4,c=-1,o=-1,l=NaN,f=new Date(2001,0,1);s&512&&(c=n.getUint32(i,!0),i+=4),i+=Io(s&(a>1?12288:4096))*4,s&16&&(o=n.getUint32(i,!0),i+=4),s&32&&(l=n.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(c>-1)h={t:"s",v:r[c]};else if(o>-1)h={t:"s",v:t[o]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function A2(e,t,r){var a=H0(e),n=a.getUint32(8,!0),s=12,i=-1,c=-1,o=NaN,l=NaN,f=new Date(2001,0,1);n&1&&(o=w2(e,s),s+=16),n&2&&(l=a.getFloat64(s,!0),s+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(c=a.getUint32(s,!0),s+=4),n&16&&(i=a.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:o};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return h}function S2(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return y2(e,t,r,e[0]);case 5:return A2(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function fa(e){var t=Hr(e);return Jn(t[1][0].data)}function Oo(e,t){var r=Hr(t.data),a=yr(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(i){var c=Hr(i.data),o=yr(c[1][0].data)>>>0;switch(a){case 1:s[o]=qi(c[3][0].data);break;case 8:{var l=e[fa(c[9][0].data)][0],f=Hr(l.data),h=e[fa(f[1][0].data)][0],u=yr(h.meta[1][0].data);if(u!=2001)throw new Error("2000 unexpected reference to ".concat(u));var d=Hr(h.data);s[o]=d[3].map(function(p){return qi(p.data)}).join("")}break}}),s}function F2(e,t){var r,a,n,s,i,c,o,l,f,h,u,d,p,x,m=Hr(e),w=yr(m[1][0].data)>>>0,_=yr(m[2][0].data)>>>0,v=((a=(r=m[8])==null?void 0:r[0])==null?void 0:a.data)&&yr(m[8][0].data)>0||!1,C,O;if((s=(n=m[7])==null?void 0:n[0])!=null&&s.data&&t!=0)C=(c=(i=m[7])==null?void 0:i[0])==null?void 0:c.data,O=(l=(o=m[6])==null?void 0:o[0])==null?void 0:l.data;else if((h=(f=m[4])==null?void 0:f[0])!=null&&h.data&&t!=1)C=(d=(u=m[4])==null?void 0:u[0])==null?void 0:d.data,O=(x=(p=m[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=v?4:1,E=H0(C),M=[],I=0;I<C.length/2;++I){var W=E.getUint16(I*2,!0);W<65535&&M.push([I,W])}if(M.length!=_)throw"Expected ".concat(_," cells, found ").concat(M.length);var L=[];for(I=0;I<M.length-1;++I)L[M[I][0]]=O.subarray(M[I][1]*R,M[I+1][1]*R);return M.length>=1&&(L[M[M.length-1][0]]=O.subarray(M[M.length-1][1]*R)),{R:w,cells:L}}function b2(e,t){var r,a=Hr(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?yr(a[7][0].data)>>>0>0?1:0:-1,s=W0(a[5],function(i){return F2(i,n)});return{nrows:yr(a[4][0].data)>>>0,data:s.reduce(function(i,c){return i[c.R]||(i[c.R]=[]),c.cells.forEach(function(o,l){if(i[c.R][l])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(l));i[c.R][l]=o}),i},[])}}function C2(e,t,r){var a,n=Hr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(yr(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(yr(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Be(s);var i=Hr(n[4][0].data),c=Oo(e,e[fa(i[4][0].data)][0]),o=(a=i[17])!=null&&a[0]?Oo(e,e[fa(i[17][0].data)][0]):[],l=Hr(i[3][0].data),f=0;l[1].forEach(function(h){var u=Hr(h.data),d=e[fa(u[2][0].data)][0],p=yr(d.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=b2(e,d);x.data.forEach(function(m,w){m.forEach(function(_,v){var C=Ce({r:f+w,c:v}),O=S2(_,c,o);O&&(r[C]=O)})}),f+=x.nrows})}function R2(e,t){var r=Hr(t.data),a={"!ref":"A1"},n=e[fa(r[2][0].data)],s=yr(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return C2(e,n[0],a),a}function I2(e,t){var r,a=Hr(t.data),n={name:(r=a[1])!=null&&r[0]?qi(a[1][0].data):"",sheets:[]},s=W0(a[2],fa);return s.forEach(function(i){e[i].forEach(function(c){var o=yr(c.meta[1][0].data);o==6e3&&n.sheets.push(R2(e,c))})}),n}function O2(e,t){var r=z0(),a=Hr(t.data),n=W0(a[1],fa);if(n.forEach(function(s){e[s].forEach(function(i){var c=yr(i.meta[1][0].data);if(c==2){var o=I2(e,i);o.sheets.forEach(function(l,f){X0(r,l,f==0?o.name:o.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Oi(e){var t,r,a,n,s={},i=[];if(e.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var l;try{l=T2(o.content)}catch(h){return console.log("?? "+o.content.length+" "+(h.message||h))}var f;try{f=k2(l)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var c=((n=(a=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&yr(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||i.forEach(function(o){s[o].forEach(function(l){var f=yr(l.meta[1][0].data)>>>0;if(f==1)if(!c)c=l;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return O2(s,c)}function D2(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function V0(e){D2([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function P2(e){return Ja.WS.indexOf(e)>-1?"sheet":e==Ja.CS?"chart":e==Ja.DS?"dialog":e==Ja.MS?"macro":e&&e.length?e:"sheet"}function N2(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,P2(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function M2(e,t,r,a,n,s,i,c,o,l,f,h){try{s[a]=Nn(lt(e,r,!0),t);var u=gr(e,t),d;switch(c){case"sheet":d=W_(u,t,n,o,s[a],l,f,h);break;case"chart":if(d=V_(u,t,n,o,s[a],l,f,h),!d||!d["!drawel"])break;var p=Tn(d["!drawel"].Target,t),x=Xi(p),m=Hm(lt(e,p,!0),Nn(lt(e,x,!0),p)),w=Tn(m,p),_=Xi(w);d=A_(lt(e,w,!0),w,o,Nn(lt(e,_,!0),w),l,d);break;case"macro":d=G_(u,t,n,o,s[a],l,f,h);break;case"dialog":d=z_(u,t,n,o,s[a],l,f,h);break;default:throw new Error("Unrecognized sheet type "+c)}i[a]=d;var v=[];s&&s[a]&&Ut(s[a]).forEach(function(C){var O="";if(s[a][C].Type==Ja.CMNT){O=Tn(s[a][C].Target,t);var R=Y_(gr(e,O,!0),O,o);if(!R||!R.length)return;go(d,R,!1)}s[a][C].Type==Ja.TCMNT&&(O=Tn(s[a][C].Target,t),v=v.concat(Vm(gr(e,O,!0),o)))}),v&&v.length&&go(d,v,!0,o.people||[])}catch(C){if(o.WTF)throw C}}function ht(e){return e.charAt(0)=="/"?e.slice(1):e}function L2(e,t){if(Rl(),t=t||{},V0(t),xt(e,"META-INF/manifest.xml")||xt(e,"objectdata.xml"))return Co(e,t);if(xt(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Oi<"u"){if(e.FileIndex)return Oi(e);var r=Le.utils.cfb_new();return Vc(e).forEach(function(le){Bd(r,le,Ld(e,le))}),Oi(r)}throw new Error("Unsupported NUMBERS file")}if(!xt(e,"[Content_Types].xml"))throw xt(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xt(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Vc(e),n=D1(lt(e,"[Content_Types].xml")),s=!1,i,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",gr(e,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!gr(e,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var o={},l={};if(!t.bookSheets&&!t.bookProps){if(Bn=[],n.sst)try{Bn=K_(gr(e,ht(n.sst)),n.sst,t)}catch(le){if(t.WTF)throw le}t.cellStyles&&n.themes.length&&(o=j_(lt(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(l=X_(gr(e,ht(n.style)),n.style,o,t))}n.links.map(function(le){try{var Z=Nn(lt(e,Xi(ht(le))),le);return q_(gr(e,ht(le)),Z,le,t)}catch{}});var f=H_(gr(e,ht(n.workbooks[0])),n.workbooks[0],t),h={},u="";n.coreprops.length&&(u=gr(e,ht(n.coreprops[0]),!0),u&&(h=sf(u)),n.extprops.length!==0&&(u=gr(e,ht(n.extprops[0]),!0),u&&B1(u,h,t)));var d={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(u=lt(e,ht(n.custprops[0]),!0),u&&(d=$1(u,t)));var p={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(Z){return Z.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=d),t.bookSheets&&typeof i<"u"&&(p.SheetNames=i),t.bookSheets?p.SheetNames:t.bookProps))return p;i={};var x={};t.bookDeps&&n.calcchain&&(x=J_(gr(e,ht(n.calcchain)),n.calcchain));var m=0,w={},_,v;{var C=f.Sheets;h.Worksheets=C.length,h.SheetNames=[];for(var O=0;O!=C.length;++O)h.SheetNames[O]=C[O].name}var R=s?"bin":"xml",E=n.workbooks[0].lastIndexOf("/"),M=(n.workbooks[0].slice(0,E+1)+"_rels/"+n.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");xt(e,M)||(M="xl/_rels/workbook."+R+".rels");var I=Nn(lt(e,M,!0),M.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=Z_(gr(e,ht(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=Gm(gr(e,ht(n.people[0])),t)),I&&(I=N2(I,f.Sheets));var W=gr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=h.Worksheets;++m){var L="sheet";if(I&&I[m]?(_="xl/"+I[m][1].replace(/[\/]?xl\//,""),xt(e,_)||(_=I[m][1]),xt(e,_)||(_=M.replace(/_rels\/.*$/,"")+I[m][1]),L=I[m][2]):(_="xl/worksheets/sheet"+(m+1-W)+"."+R,_=_.replace(/sheet0\./,"sheet.")),v=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(m!=t.sheets)continue e;break;case"string":if(h.SheetNames[m].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var N=!1,J=0;J!=t.sheets.length;++J)typeof t.sheets[J]=="number"&&t.sheets[J]==m&&(N=1),typeof t.sheets[J]=="string"&&t.sheets[J].toLowerCase()==h.SheetNames[m].toLowerCase()&&(N=1);if(!N)continue e}}M2(e,_,v,h.SheetNames[m],m,w,i,L,t,f,o,l)}return p={Directory:n,Workbook:f,Props:h,Custprops:d,Deps:x,Sheets:i,SheetNames:h.SheetNames,Strings:Bn,Styles:l,Themes:o,SSF:Or(Ie)},t&&t.bookFiles&&(e.files?(p.keys=a,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(le,Z){le=le.replace(/^Root Entry[\/]/,""),p.keys.push(le),p.files[le]=e.FileIndex[Z]}))),t&&t.bookVBA&&(n.vba.length>0?p.vbaraw=gr(e,ht(n.vba[0]),!0):n.defaults&&n.defaults.bin===Km&&(p.vbaraw=gr(e,"xl/vbaProject.bin",!0))),p}function B2(e,t){var r=t||{},a="Workbook",n=Le.find(e,a);try{if(a="/!DataSpaces/Version",n=Le.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Rp(n.content),a="/!DataSpaces/DataSpaceMap",n=Le.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=Op(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Le.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Dp(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Le.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);Np(n.content)}catch{}if(a="/EncryptionInfo",n=Le.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=Mp(n.content);if(a="/EncryptedPackage",n=Le.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function G0(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ft(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function U2(e,t){return Le.find(e,"EncryptedPackage")?B2(e,t):Gf(e,t)}function $2(e,t){var r,a=e,n=t||{};return n.type||(n.type=Me&&Buffer.isBuffer(e)?"buffer":"base64"),r=Ml(a,n),L2(r,n)}function Kf(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Yi(e.slice(r),t);default:break e}return jn.to_workbook(e,t)}function H2(e,t){var r="",a=G0(e,t);switch(t.type){case"base64":r=ft(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Fa(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Ze(r)),t.type="binary",Kf(r,t)}function W2(e,t){var r=e;return t.type=="base64"&&(r=ft(r)),r=ia.utils.decode(1200,r.slice(2),"str"),t.type="binary",Kf(r,t)}function V2(e){return e.match(/[^\x00-\x7F]/)?yn(e):e}function Di(e,t,r,a){return a?(r.type="string",jn.to_workbook(e,r)):jn.to_workbook(t,r)}function Qi(e,t){vl();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Qi(new Uint8Array(e),(r=Or(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),en={},r.dateNF&&(en.dateNF=r.dateNF),r.type||(r.type=Me&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Me?"buffer":"binary",a=Rd(e),typeof Uint8Array<"u"&&!Me&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=V2(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),c=new Uint8Array(i);if(c.foo="bar",!c.foo)return r=Or(r),r.type="array",Qi(E0(a),r)}switch((n=G0(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return U2(Le.read(a,r),r);break;case 9:if(n[1]<=8)return Gf(a,r);break;case 60:return Yi(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return gp(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return pp.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?$2(a,r):Di(e,a,r,s);case 239:return n[3]===60?Yi(a,r):Di(e,a,r,s);case 255:if(n[1]===254)return W2(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Ln.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Ln.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return mo.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return Kp.to_workbook(a,r);break;case 10:case 13:case 32:return H2(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return dp.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?mo.to_workbook(a,r):Di(e,a,r,s)}function G2(e,t,r,a,n,s,i,c){var o=Dr(r),l=c.defval,f=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),h=!0,u=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch{u.__rowNum__=r}else u.__rowNum__=r;if(!i||e[r])for(var d=t.s.c;d<=t.e.c;++d){var p=i?e[r][d]:e[a[d]+o];if(p===void 0||p.t===void 0){if(l===void 0)continue;s[d]!=null&&(u[s[d]]=l);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[d]!=null){if(x==null)if(p.t=="e"&&x===null)u[s[d]]=null;else if(l!==void 0)u[s[d]]=l;else if(f&&x===null)u[s[d]]=null;else continue;else u[s[d]]=f&&(p.t!=="n"||p.t==="n"&&c.rawNumbers!==!1)?x:Zt(p,x,c);x!=null&&(h=!1)}}return{row:u,isempty:h}}function e0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],i=0,c="",o={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":o=ur(f);break;case"number":o=ur(e["!ref"]),o.s.r=f;break;default:o=f}a>0&&(n=0);var h=Dr(o.s.r),u=[],d=[],p=0,x=0,m=Array.isArray(e),w=o.s.r,_=0,v={};m&&!e[w]&&(e[w]=[]);var C=l.skipHidden&&e["!cols"]||[],O=l.skipHidden&&e["!rows"]||[];for(_=o.s.c;_<=o.e.c;++_)if(!(C[_]||{}).hidden)switch(u[_]=Tr(_),r=m?e[w][_]:e[u[_]+h],a){case 1:s[_]=_-o.s.c;break;case 2:s[_]=u[_];break;case 3:s[_]=l.header[_-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=i=Zt(r,null,l),x=v[i]||0,!x)v[i]=1;else{do c=i+"_"+x++;while(v[c]);v[i]=x,v[c]=1}s[_]=c}for(w=o.s.r+n;w<=o.e.r;++w)if(!(O[w]||{}).hidden){var R=G2(e,o,w,u,a,s,m,l);(R.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(d[p++]=R.row)}return d.length=p,d}var Do=/"/g;function z2(e,t,r,a,n,s,i,c){for(var o=!0,l=[],f="",h=Dr(r),u=t.s.c;u<=t.e.c;++u)if(a[u]){var d=c.dense?(e[r]||[])[u]:e[a[u]+h];if(d==null)f="";else if(d.v!=null){o=!1,f=""+(c.rawNumbers&&d.t=="n"?d.v:Zt(d,null,c));for(var p=0,x=0;p!==f.length;++p)if((x=f.charCodeAt(p))===n||x===s||x===34||c.forceQuotes){f='"'+f.replace(Do,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(o=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(Do,'""')+'"')):f="";l.push(f)}return c.blankrows===!1&&o?null:l.join(i)}function Yf(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=ur(e["!ref"]),s=a.FS!==void 0?a.FS:",",i=s.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,o=c.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];a.dense=Array.isArray(e);for(var u=a.skipHidden&&e["!cols"]||[],d=a.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(u[p]||{}).hidden||(h[p]=Tr(p));for(var x=0,m=n.s.r;m<=n.e.r;++m)(d[m]||{}).hidden||(f=z2(e,n,m,h,i,o,s,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&r.push((x++?c:"")+f)));return delete a.dense,r.join("")}function X2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Yf(e,t);return r}function j2(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=ur(e["!ref"]),s="",i=[],c,o=[],l=Array.isArray(e);for(c=n.s.c;c<=n.e.c;++c)i[c]=Tr(c);for(var f=n.s.r;f<=n.e.r;++f)for(s=Dr(f),c=n.s.c;c<=n.e.c;++c)if(t=i[c]+s,r=l?(e[f]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}o[o.length]=t+"="+a}return o}function Jf(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},i=0,c=0;if(s&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var o=typeof a.origin=="string"?qr(a.origin):a.origin;i=o.r,c=o.c}var l,f={s:{c:0,r:0},e:{c,r:i+t.length-1+n}};if(s["!ref"]){var h=ur(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(i=h.e.r+1,f.e.r=i+t.length-1+n)}else i==-1&&(i=0,f.e.r=t.length-1+n);var u=a.header||[],d=0;t.forEach(function(x,m){Ut(x).forEach(function(w){(d=u.indexOf(w))==-1&&(u[d=u.length]=w);var _=x[w],v="z",C="",O=Ce({c:c+d,r:i+m+n});l=qn(s,O),_&&typeof _=="object"&&!(_ instanceof Date)?s[O]=_:(typeof _=="number"?v="n":typeof _=="boolean"?v="b":typeof _=="string"?v="s":_ instanceof Date?(v="d",a.cellDates||(v="n",_=Qr(_)),C=a.dateNF||Ie[14]):_===null&&a.nullError&&(v="e",_=0),l?(l.t=v,l.v=_,delete l.w,delete l.R,C&&(l.z=C)):s[O]=l={t:v,v:_},C&&(l.z=C))})}),f.e.c=Math.max(f.e.c,c+u.length-1);var p=Dr(i);if(n)for(d=0;d<u.length;++d)s[Tr(d+c)+p]={t:"s",v:u[d]};return s["!ref"]=Be(f),s}function K2(e,t){return Jf(null,e,t)}function qn(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=qr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?qn(e,Ce(t)):qn(e,Ce({r:t,c:r||0}))}function Y2(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function z0(){return{SheetNames:[],Sheets:{}}}function X0(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=i+n)!=-1;++n);}if(D_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function J2(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=Y2(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function q2(e,t){return e.z=t,e}function qf(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Z2(e,t,r){return qf(e,"#"+t,r)}function Q2(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function ew(e,t,r,a){for(var n=typeof t!="string"?t:ur(t),s=typeof t=="string"?t:Be(t),i=n.s.r;i<=n.e.r;++i)for(var c=n.s.c;c<=n.e.c;++c){var o=qn(e,i,c);o.t="n",o.F=s,delete o.v,i==n.s.r&&c==n.s.c&&(o.f=r,a&&(o.D=!0))}return e}var rw={encode_col:Tr,encode_row:Dr,encode_cell:Ce,encode_range:Be,decode_col:I0,decode_row:R0,split_cell:h1,decode_cell:qr,decode_range:fn,format_cell:Zt,sheet_add_aoa:ef,sheet_add_json:Jf,sheet_add_dom:zf,aoa_to_sheet:un,json_to_sheet:K2,table_to_sheet:Xf,table_to_book:g2,sheet_to_csv:Yf,sheet_to_txt:X2,sheet_to_json:e0,sheet_to_html:m2,sheet_to_formulae:j2,sheet_to_row_object_array:e0,sheet_get_cell:qn,book_new:z0,book_append_sheet:X0,book_set_sheet_visibility:J2,cell_set_number_format:q2,cell_set_hyperlink:qf,cell_set_internal_link:Z2,cell_add_comment:Q2,sheet_set_array_formula:ew,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const r0="RFC3986",t0={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},tw="RFC1738",aw=Array.isArray,Dt=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),Pi=1024,nw=(e,t,r,a,n)=>{if(e.length===0)return e;let s=e;if(typeof e=="symbol"?s=Symbol.prototype.toString.call(e):typeof e!="string"&&(s=String(e)),r==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let i="";for(let c=0;c<s.length;c+=Pi){const o=s.length>=Pi?s.slice(c,c+Pi):s,l=[];for(let f=0;f<o.length;++f){let h=o.charCodeAt(f);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===tw&&(h===40||h===41)){l[l.length]=o.charAt(f);continue}if(h<128){l[l.length]=Dt[h];continue}if(h<2048){l[l.length]=Dt[192|h>>6]+Dt[128|h&63];continue}if(h<55296||h>=57344){l[l.length]=Dt[224|h>>12]+Dt[128|h>>6&63]+Dt[128|h&63];continue}f+=1,h=65536+((h&1023)<<10|o.charCodeAt(f)&1023),l[l.length]=Dt[240|h>>18]+Dt[128|h>>12&63]+Dt[128|h>>6&63]+Dt[128|h&63]}i+=l.join("")}return i};function sw(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function Po(e,t){if(aw(e)){const r=[];for(let a=0;a<e.length;a+=1)r.push(t(e[a]));return r}return t(e)}const iw=Object.prototype.hasOwnProperty,Zf={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Nt=Array.isArray,cw=Array.prototype.push,Qf=function(e,t){cw.apply(e,Nt(t)?t:[t])},ow=Date.prototype.toISOString,wr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:nw,encodeValuesOnly:!1,format:r0,formatter:t0[r0],indices:!1,serializeDate(e){return ow.call(e)},skipNulls:!1,strictNullHandling:!1};function lw(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Ni={};function eu(e,t,r,a,n,s,i,c,o,l,f,h,u,d,p,x,m,w){let _=e,v=w,C=0,O=!1;for(;(v=v.get(Ni))!==void 0&&!O;){const W=v.get(e);if(C+=1,typeof W<"u"){if(W===C)throw new RangeError("Cyclic object value");O=!0}typeof v.get(Ni)>"u"&&(C=0)}if(typeof l=="function"?_=l(t,_):_ instanceof Date?_=u==null?void 0:u(_):r==="comma"&&Nt(_)&&(_=Po(_,function(W){return W instanceof Date?u==null?void 0:u(W):W})),_===null){if(s)return o&&!x?o(t,wr.encoder,m,"key",d):t;_=""}if(lw(_)||sw(_)){if(o){const W=x?t:o(t,wr.encoder,m,"key",d);return[(p==null?void 0:p(W))+"="+(p==null?void 0:p(o(_,wr.encoder,m,"value",d)))]}return[(p==null?void 0:p(t))+"="+(p==null?void 0:p(String(_)))]}const R=[];if(typeof _>"u")return R;let E;if(r==="comma"&&Nt(_))x&&o&&(_=Po(_,o)),E=[{value:_.length>0?_.join(",")||null:void 0}];else if(Nt(l))E=l;else{const W=Object.keys(_);E=f?W.sort(f):W}const M=c?String(t).replace(/\./g,"%2E"):String(t),I=a&&Nt(_)&&_.length===1?M+"[]":M;if(n&&Nt(_)&&_.length===0)return I+"[]";for(let W=0;W<E.length;++W){const L=E[W],N=typeof L=="object"&&typeof L.value<"u"?L.value:_[L];if(i&&N===null)continue;const J=h&&c?L.replace(/\./g,"%2E"):L,le=Nt(_)?typeof r=="function"?r(I,J):I:I+(h?"."+J:"["+J+"]");w.set(e,C);const Z=new WeakMap;Z.set(Ni,w),Qf(R,eu(N,le,r,a,n,s,i,c,r==="comma"&&x&&Nt(_)?null:o,l,f,h,u,d,p,x,m,Z))}return R}function fw(e=wr){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||wr.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=r0;if(typeof e.format<"u"){if(!iw.call(t0,e.format))throw new TypeError("Unknown format option provided.");r=e.format}const a=t0[r];let n=wr.filter;(typeof e.filter=="function"||Nt(e.filter))&&(n=e.filter);let s;if(e.arrayFormat&&e.arrayFormat in Zf?s=e.arrayFormat:"indices"in e?s=e.indices?"indices":"repeat":s=wr.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:wr.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:wr.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:wr.allowEmptyArrays,arrayFormat:s,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:wr.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?wr.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:wr.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:wr.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:wr.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:wr.encodeValuesOnly,filter:n,format:r,formatter:a,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:wr.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:wr.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:wr.strictNullHandling}}function uw(e,t={}){let r=e;const a=fw(t);let n,s;typeof a.filter=="function"?(s=a.filter,r=s("",r)):Nt(a.filter)&&(s=a.filter,n=s);const i=[];if(typeof r!="object"||r===null)return"";const c=Zf[a.arrayFormat],o=c==="comma"&&a.commaRoundTrip;n||(n=Object.keys(r)),a.sort&&n.sort(a.sort);const l=new WeakMap;for(let u=0;u<n.length;++u){const d=n[u];a.skipNulls&&r[d]===null||Qf(i,eu(r[d],d,c,o,a.allowEmptyArrays,a.strictNullHandling,a.skipNulls,a.encodeDotInKeys,a.encode?a.encoder:null,a.filter,a.sort,a.allowDots,a.serializeDate,a.format,a.formatter,a.encodeValuesOnly,a.charset,l))}const f=i.join(a.delimiter);let h=a.addQueryPrefix===!0?"?":"";return a.charsetSentinel&&(a.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),f.length>0?h+f:""}const Ka="4.77.0";let No=!1,Hn,ru,tu,a0,au,nu,su,iu,cu;function hw(e,t={auto:!1}){if(No)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(Hn)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${Hn}'\``);No=t.auto,Hn=e.kind,ru=e.fetch,tu=e.FormData,a0=e.File,au=e.ReadableStream,nu=e.getMultipartRequestOptions,su=e.getDefaultAgent,iu=e.fileFromPath,cu=e.isFsReadStream}class dw{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function xw({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,a,n,s;try{r=fetch,a=Request,n=Response,s=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${t}`)}return{kind:"web",fetch:r,Request:a,Response:n,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(i,c)=>({...c,body:new dw(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}Hn||hw(xw(),{auto:!0});class Ne extends Error{}class Pr extends Ne{constructor(t,r,a,n){super(`${Pr.makeMessage(t,r,a)}`),this.status=t,this.headers=n,this.request_id=n==null?void 0:n["x-request-id"],this.error=r;const s=r;this.code=s==null?void 0:s.code,this.param=s==null?void 0:s.param,this.type=s==null?void 0:s.type}static makeMessage(t,r,a){const n=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):a;return t&&n?`${t} ${n}`:t?`${t} status code (no body)`:n||"(no status code or body)"}static generate(t,r,a,n){if(!t||!n)return new hi({message:a,cause:s0(r)});const s=r==null?void 0:r.error;return t===400?new ou(t,s,a,n):t===401?new lu(t,s,a,n):t===403?new fu(t,s,a,n):t===404?new uu(t,s,a,n):t===409?new hu(t,s,a,n):t===422?new du(t,s,a,n):t===429?new xu(t,s,a,n):t>=500?new pu(t,s,a,n):new Pr(t,s,a,n)}}class St extends Pr{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class hi extends Pr{constructor({message:t,cause:r}){super(void 0,void 0,t||"Connection error.",void 0),r&&(this.cause=r)}}class j0 extends hi{constructor({message:t}={}){super({message:t??"Request timed out."})}}class ou extends Pr{}class lu extends Pr{}class fu extends Pr{}class uu extends Pr{}class hu extends Pr{}class du extends Pr{}class xu extends Pr{}class pu extends Pr{}class mu extends Ne{constructor(){super("Could not parse response content as the length limit was reached")}}class gu extends Ne{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ca{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let r=this.decodeText(t);if(this.trailingCR&&(r="\r"+r,this.trailingCR=!1),r.endsWith("\r")&&(this.trailingCR=!0,r=r.slice(0,-1)),!r)return[];const a=Ca.NEWLINE_CHARS.has(r[r.length-1]||"");let n=r.split(Ca.NEWLINE_REGEXP);return a&&n.pop(),n.length===1&&!a?(this.buffer.push(n[0]),[]):(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),a||(this.buffer=[n.pop()||""]),n)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof Buffer<"u"){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new Ne(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new Ne(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new Ne("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}Ca.NEWLINE_CHARS=new Set([`
`,"\r"]);Ca.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Lt{constructor(t,r){this.iterator=t,this.controller=r}static fromSSEResponse(t,r){let a=!1;async function*n(){if(a)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let s=!1;try{for await(const i of pw(t,r))if(!s){if(i.data.startsWith("[DONE]")){s=!0;continue}if(i.event===null){let c;try{c=JSON.parse(i.data)}catch(o){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),o}if(c&&c.error)throw new Pr(void 0,c.error,void 0,void 0);yield c}else{let c;try{c=JSON.parse(i.data)}catch(o){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),o}if(i.event=="error")throw new Pr(void 0,c.error,c.message,void 0);yield{event:i.event,data:c}}}s=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{s||r.abort()}}return new Lt(n,r)}static fromReadableStream(t,r){let a=!1;async function*n(){const i=new Ca,c=vu(t);for await(const o of c)for(const l of i.decode(o))yield l;for(const o of i.flush())yield o}async function*s(){if(a)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let i=!1;try{for await(const c of n())i||c&&(yield JSON.parse(c));i=!0}catch(c){if(c instanceof Error&&c.name==="AbortError")return;throw c}finally{i||r.abort()}}return new Lt(s,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],r=[],a=this.iterator(),n=s=>({next:()=>{if(s.length===0){const i=a.next();t.push(i),r.push(i)}return s.shift()}});return[new Lt(()=>n(t),this.controller),new Lt(()=>n(r),this.controller)]}toReadableStream(){const t=this;let r;const a=new TextEncoder;return new au({async start(){r=t[Symbol.asyncIterator]()},async pull(n){try{const{value:s,done:i}=await r.next();if(i)return n.close();const c=a.encode(JSON.stringify(s)+`
`);n.enqueue(c)}catch(s){n.error(s)}},async cancel(){var n;await((n=r.return)==null?void 0:n.call(r))}})}}async function*pw(e,t){if(!e.body)throw t.abort(),new Ne("Attempted to iterate over a response with no body");const r=new vw,a=new Ca,n=vu(e.body);for await(const s of mw(n))for(const i of a.decode(s)){const c=r.decode(i);c&&(yield c)}for(const s of a.flush()){const i=r.decode(s);i&&(yield i)}}async function*mw(e){let t=new Uint8Array;for await(const r of e){if(r==null)continue;const a=r instanceof ArrayBuffer?new Uint8Array(r):typeof r=="string"?new TextEncoder().encode(r):r;let n=new Uint8Array(t.length+a.length);n.set(t),n.set(a,t.length),t=n;let s;for(;(s=gw(t))!==-1;)yield t.slice(0,s),t=t.slice(s)}t.length>0&&(yield t)}function gw(e){for(let a=0;a<e.length-2;a++){if(e[a]===10&&e[a+1]===10||e[a]===13&&e[a+1]===13)return a+2;if(e[a]===13&&e[a+1]===10&&a+3<e.length&&e[a+2]===13&&e[a+3]===10)return a+4}return-1}class vw{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(t),t.startsWith(":"))return null;let[r,a,n]=_w(t,":");return n.startsWith(" ")&&(n=n.substring(1)),r==="event"?this.event=n:r==="data"&&this.data.push(n),null}}function _w(e,t){const r=e.indexOf(t);return r!==-1?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}function vu(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const r=await t.read();return r!=null&&r.done&&t.releaseLock(),r}catch(r){throw t.releaseLock(),r}},async return(){const r=t.cancel();return t.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const _u=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function",wu=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&di(e),di=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",ww=e=>wu(e)||_u(e)||cu(e);async function ku(e,t,r){var n;if(e=await e,wu(e))return e;if(_u(e)){const s=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=di(s)?[await s.arrayBuffer()]:[s];return new a0(i,t,r)}const a=await kw(e);if(t||(t=Tw(e)??"unknown_file"),!(r!=null&&r.type)){const s=(n=a[0])==null?void 0:n.type;typeof s=="string"&&(r={...r,type:s})}return new a0(a,t,r)}async function kw(e){var r;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(di(e))t.push(await e.arrayBuffer());else if(yw(e))for await(const a of e)t.push(a);else throw new Error(`Unexpected data type: ${typeof e}; constructor: ${(r=e==null?void 0:e.constructor)==null?void 0:r.name}; props: ${Ew(e)}`);return t}function Ew(e){return`[${Object.getOwnPropertyNames(e).map(r=>`"${r}"`).join(", ")}]`}function Tw(e){var t;return Mi(e.name)||Mi(e.filename)||((t=Mi(e.path))==null?void 0:t.split(/[\\/]/).pop())}const Mi=e=>{if(typeof e=="string")return e;if(typeof Buffer<"u"&&e instanceof Buffer)return String(e)},yw=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",Mo=e=>e&&typeof e=="object"&&e.body&&e[Symbol.toStringTag]==="MultipartBody",on=async e=>{const t=await Aw(e.body);return nu(t,e)},Aw=async e=>{const t=new tu;return await Promise.all(Object.entries(e||{}).map(([r,a])=>n0(t,r,a))),t},n0=async(e,t,r)=>{if(r!==void 0){if(r==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")e.append(t,String(r));else if(ww(r)){const a=await ku(r);e.append(t,a)}else if(Array.isArray(r))await Promise.all(r.map(a=>n0(e,t+"[]",a)));else if(typeof r=="object")await Promise.all(Object.entries(r).map(([a,n])=>n0(e,`${t}[${a}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var rn={},Sw=function(e,t,r,a,n){if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r},Fw=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},bs;async function Eu(e){const{response:t}=e;if(e.options.stream)return tn("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):Lt.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const r=t.headers.get("content-type");if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.includes("application/vnd.api+json"))){const s=await t.json();return tn("response",t.status,t.url,t.headers,s),Tu(s,t)}const n=await t.text();return tn("response",t.status,t.url,t.headers,n),n}function Tu(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class xi extends Promise{constructor(t,r=Eu){super(a=>{a(null)}),this.responsePromise=t,this.parseResponse=r}_thenUnwrap(t){return new xi(this.responsePromise,async r=>Tu(t(await this.parseResponse(r),r),r.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:r,request_id:r.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,r){return this.parse().then(t,r)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class bw{constructor({baseURL:t,maxRetries:r=2,timeout:a=6e5,httpAgent:n,fetch:s}){this.baseURL=t,this.maxRetries=Li("maxRetries",r),this.timeout=Li("timeout",a),this.httpAgent=n,this.fetch=s??ru}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Pw(),...this.authHeaders(t)}}validateHeaders(t,r){}defaultIdempotencyKey(){return`stainless-node-retry-${Bw()}`}get(t,r){return this.methodRequest("get",t,r)}post(t,r){return this.methodRequest("post",t,r)}patch(t,r){return this.methodRequest("patch",t,r)}put(t,r){return this.methodRequest("put",t,r)}delete(t,r){return this.methodRequest("delete",t,r)}methodRequest(t,r,a){return this.request(Promise.resolve(a).then(async n=>{const s=n&&di(n==null?void 0:n.body)?new DataView(await n.body.arrayBuffer()):(n==null?void 0:n.body)instanceof DataView?n.body:(n==null?void 0:n.body)instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n==null?void 0:n.body)?new DataView(n.body.buffer):n==null?void 0:n.body;return{method:t,path:r,...n,body:s}}))}getAPIList(t,r,a){return this.requestAPIList(r,{method:"get",path:t,...a})}calculateContentLength(t){if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:r=0}={}){var x;const{method:a,path:n,query:s,headers:i={}}=t,c=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:Mo(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,o=this.calculateContentLength(c),l=this.buildURL(n,s);"timeout"in t&&Li("timeout",t.timeout);const f=t.timeout??this.timeout,h=t.httpAgent??this.httpAgent??su(l),u=f+1e3;typeof((x=h==null?void 0:h.options)==null?void 0:x.timeout)=="number"&&u>(h.options.timeout??0)&&(h.options.timeout=u),this.idempotencyHeader&&a!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=t.idempotencyKey);const d=this.buildHeaders({options:t,headers:i,contentLength:o,retryCount:r});return{req:{method:a,...c&&{body:c},headers:d,...h&&{agent:h},signal:t.signal??null},url:l,timeout:f}}buildHeaders({options:t,headers:r,contentLength:a,retryCount:n}){const s={};a&&(s["content-length"]=a);const i=this.defaultHeaders(t);return $o(s,i),$o(s,r),Mo(t.body)&&Hn!=="node"&&delete s["content-type"],Ho(i,"x-stainless-retry-count")===void 0&&Ho(r,"x-stainless-retry-count")===void 0&&(s["x-stainless-retry-count"]=String(n)),this.validateHeaders(s,r),s}async prepareOptions(t){}async prepareRequest(t,{url:r,options:a}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(r=>[...r])):{...t}:{}}makeStatusError(t,r,a,n){return Pr.generate(t,r,a,n)}request(t,r=null){return new xi(this.makeRequest(t,r))}async makeRequest(t,r){var h,u;const a=await t,n=a.maxRetries??this.maxRetries;r==null&&(r=n),await this.prepareOptions(a);const{req:s,url:i,timeout:c}=this.buildRequest(a,{retryCount:n-r});if(await this.prepareRequest(s,{url:i,options:a}),tn("request",i,a,s.headers),(h=a.signal)!=null&&h.aborted)throw new St;const o=new AbortController,l=await this.fetchWithTimeout(i,s,c,o).catch(s0);if(l instanceof Error){if((u=a.signal)!=null&&u.aborted)throw new St;if(r)return this.retryRequest(a,r);throw l.name==="AbortError"?new j0:new hi({cause:l})}const f=Rw(l.headers);if(!l.ok){if(r&&this.shouldRetry(l)){const _=`retrying, ${r} attempts remaining`;return tn(`response (error; ${_})`,l.status,i,f),this.retryRequest(a,r,f)}const d=await l.text().catch(_=>s0(_).message),p=Nw(d),x=p?void 0:d;throw tn(`response (error; ${r?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,f,x),this.makeStatusError(l.status,p,x,f)}return{response:l,options:a,controller:o}}requestAPIList(t,r){const a=this.makeRequest(r,null);return new Cw(this,a,t)}buildURL(t,r){const a=Lw(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),n=this.defaultQuery();return Au(n)||(r={...n,...r}),typeof r=="object"&&r&&!Array.isArray(r)&&(a.search=this.stringifyQuery(r)),a.toString()}stringifyQuery(t){return Object.entries(t).filter(([r,a])=>typeof a<"u").map(([r,a])=>{if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(a)}`;if(a===null)return`${encodeURIComponent(r)}=`;throw new Ne(`Cannot stringify type ${typeof a}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,r,a,n){const{signal:s,...i}=r||{};s&&s.addEventListener("abort",()=>n.abort());const c=setTimeout(()=>n.abort(),a);return this.fetch.call(void 0,t,{signal:n.signal,...i}).finally(()=>{clearTimeout(c)})}shouldRetry(t){const r=t.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,r,a){let n;const s=a==null?void 0:a["retry-after-ms"];if(s){const c=parseFloat(s);Number.isNaN(c)||(n=c)}const i=a==null?void 0:a["retry-after"];if(i&&!n){const c=parseFloat(i);Number.isNaN(c)?n=Date.parse(i)-Date.now():n=c*1e3}if(!(n&&0<=n&&n<60*1e3)){const c=t.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(r,c)}return await fs(n),this.makeRequest(t,r-1)}calculateDefaultRetryTimeoutMillis(t,r){const s=r-t,i=Math.min(.5*Math.pow(2,s),8),c=1-Math.random()*.25;return i*c*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ka}`}}class yu{constructor(t,r,a,n){bs.set(this,void 0),Sw(this,bs,t),this.options=n,this.response=r,this.body=a}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new Ne("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const r={...this.options};if("params"in t&&typeof r.query=="object")r.query={...r.query,...t.params};else if("url"in t){const a=[...Object.entries(r.query||{}),...t.url.searchParams.entries()];for(const[n,s]of a)t.url.searchParams.set(n,s);r.query=void 0,r.path=t.url.toString()}return await Fw(this,bs,"f").requestAPIList(this.constructor,r)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(bs=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const r of t.getPaginatedItems())yield r}}class Cw extends xi{constructor(t,r,a){super(r,async n=>new a(t,n.response,await Eu(n),n.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const r of t)yield r}}const Rw=e=>new Proxy(Object.fromEntries(e.entries()),{get(t,r){const a=r.toString();return t[a.toLowerCase()]||t[a]}}),Iw={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},nt=e=>typeof e=="object"&&e!==null&&!Au(e)&&Object.keys(e).every(t=>Su(Iw,t)),Ow=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ka,"X-Stainless-OS":Bo(Deno.build.os),"X-Stainless-Arch":Lo(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ka,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ka,"X-Stainless-OS":Bo(process.platform),"X-Stainless-Arch":Lo(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=Dw();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ka,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ka,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Dw(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of e){const a=r.exec(navigator.userAgent);if(a){const n=a[1]||0,s=a[2]||0,i=a[3]||0;return{browser:t,version:`${n}.${s}.${i}`}}}return null}const Lo=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",Bo=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let Uo;const Pw=()=>Uo??(Uo=Ow()),Nw=e=>{try{return JSON.parse(e)}catch{return}},Mw=/^[a-z][a-z0-9+.-]*:/i,Lw=e=>Mw.test(e),fs=e=>new Promise(t=>setTimeout(t,e)),Li=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new Ne(`${e} must be an integer`);if(t<0)throw new Ne(`${e} must be a positive integer`);return t},s0=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},Cs=e=>{var t,r,a,n;if(typeof process<"u")return((t=rn==null?void 0:rn[e])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(n=(a=(r=Deno.env)==null?void 0:r.get)==null?void 0:a.call(r,e))==null?void 0:n.trim()};function Au(e){if(!e)return!0;for(const t in e)return!1;return!0}function Su(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function $o(e,t){for(const r in t){if(!Su(t,r))continue;const a=r.toLowerCase();if(!a)continue;const n=t[r];n===null?delete e[a]:n!==void 0&&(e[a]=n)}}function tn(e,...t){typeof process<"u"&&(rn==null?void 0:rn.DEBUG)==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}const Bw=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),Uw=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",$w=e=>typeof(e==null?void 0:e.get)=="function",Ho=(e,t)=>{var a;const r=t.toLowerCase();if($w(e)){const n=((a=t[0])==null?void 0:a.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(s,i,c)=>i+c.toUpperCase());for(const s of[t,r,t.toUpperCase(),n]){const i=e.get(s);if(i)return i}}for(const[n,s]of Object.entries(e))if(n.toLowerCase()===r)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${t} header, using the first entry.`),s[0]):s};function Bi(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}class Hw extends yu{constructor(t,r,a,n){super(t,r,a,n),this.data=a.data||[],this.object=a.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Rt extends yu{constructor(t,r,a,n){super(t,r,a,n),this.data=a.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const r=Object.fromEntries(t.url.searchParams);return Object.keys(r).length?r:null}nextPageInfo(){var a;const t=this.getPaginatedItems();if(!t.length)return null;const r=(a=t[t.length-1])==null?void 0:a.id;return r?{params:{after:r}}:null}}class je{constructor(t){this._client=t}}let Fu=class extends je{create(t,r){return this._client.post("/chat/completions",{body:t,...r,stream:t.stream??!1})}},K0=class extends je{constructor(){super(...arguments),this.completions=new Fu(this._client)}};K0.Completions=Fu;class bu extends je{create(t,r){return this._client.post("/audio/speech",{body:t,...r,__binaryResponse:!0})}}class Cu extends je{create(t,r){return this._client.post("/audio/transcriptions",on({body:t,...r}))}}class Ru extends je{create(t,r){return this._client.post("/audio/translations",on({body:t,...r}))}}class us extends je{constructor(){super(...arguments),this.transcriptions=new Cu(this._client),this.translations=new Ru(this._client),this.speech=new bu(this._client)}}us.Transcriptions=Cu;us.Translations=Ru;us.Speech=bu;class Y0 extends je{create(t,r){return this._client.post("/batches",{body:t,...r})}retrieve(t,r){return this._client.get(`/batches/${t}`,r)}list(t={},r){return nt(t)?this.list({},t):this._client.getAPIList("/batches",J0,{query:t,...r})}cancel(t,r){return this._client.post(`/batches/${t}/cancel`,r)}}class J0 extends Rt{}Y0.BatchesPage=J0;class q0 extends je{create(t,r){return this._client.post("/assistants",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/assistants/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,a){return this._client.post(`/assistants/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t={},r){return nt(t)?this.list({},t):this._client.getAPIList("/assistants",Z0,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,r){return this._client.delete(`/assistants/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Z0 extends Rt{}q0.AssistantsPage=Z0;function Wo(e){return typeof e.parse=="function"}const an=e=>(e==null?void 0:e.role)==="assistant",Iu=e=>(e==null?void 0:e.role)==="function",Ou=e=>(e==null?void 0:e.role)==="tool";var wt=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},sr=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},i0,Ms,Ls,An,Sn,Bs,Fn,jt,bn,ri,ti,Ya,Du;class Pu{constructor(){i0.add(this),this.controller=new AbortController,Ms.set(this,void 0),Ls.set(this,()=>{}),An.set(this,()=>{}),Sn.set(this,void 0),Bs.set(this,()=>{}),Fn.set(this,()=>{}),jt.set(this,{}),bn.set(this,!1),ri.set(this,!1),ti.set(this,!1),Ya.set(this,!1),wt(this,Ms,new Promise((t,r)=>{wt(this,Ls,t,"f"),wt(this,An,r,"f")}),"f"),wt(this,Sn,new Promise((t,r)=>{wt(this,Bs,t,"f"),wt(this,Fn,r,"f")}),"f"),sr(this,Ms,"f").catch(()=>{}),sr(this,Sn,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},sr(this,i0,"m",Du).bind(this))},0)}_connected(){this.ended||(sr(this,Ls,"f").call(this),this._emit("connect"))}get ended(){return sr(this,bn,"f")}get errored(){return sr(this,ri,"f")}get aborted(){return sr(this,ti,"f")}abort(){this.controller.abort()}on(t,r){return(sr(this,jt,"f")[t]||(sr(this,jt,"f")[t]=[])).push({listener:r}),this}off(t,r){const a=sr(this,jt,"f")[t];if(!a)return this;const n=a.findIndex(s=>s.listener===r);return n>=0&&a.splice(n,1),this}once(t,r){return(sr(this,jt,"f")[t]||(sr(this,jt,"f")[t]=[])).push({listener:r,once:!0}),this}emitted(t){return new Promise((r,a)=>{wt(this,Ya,!0,"f"),t!=="error"&&this.once("error",a),this.once(t,r)})}async done(){wt(this,Ya,!0,"f"),await sr(this,Sn,"f")}_emit(t,...r){if(sr(this,bn,"f"))return;t==="end"&&(wt(this,bn,!0,"f"),sr(this,Bs,"f").call(this));const a=sr(this,jt,"f")[t];if(a&&(sr(this,jt,"f")[t]=a.filter(n=>!n.once),a.forEach(({listener:n})=>n(...r))),t==="abort"){const n=r[0];!sr(this,Ya,"f")&&!(a!=null&&a.length)&&Promise.reject(n),sr(this,An,"f").call(this,n),sr(this,Fn,"f").call(this,n),this._emit("end");return}if(t==="error"){const n=r[0];!sr(this,Ya,"f")&&!(a!=null&&a.length)&&Promise.reject(n),sr(this,An,"f").call(this,n),sr(this,Fn,"f").call(this,n),this._emit("end")}}_emitFinal(){}}Ms=new WeakMap,Ls=new WeakMap,An=new WeakMap,Sn=new WeakMap,Bs=new WeakMap,Fn=new WeakMap,jt=new WeakMap,bn=new WeakMap,ri=new WeakMap,ti=new WeakMap,Ya=new WeakMap,i0=new WeakSet,Du=function(t){if(wt(this,ri,!0,"f"),t instanceof Error&&t.name==="AbortError"&&(t=new St),t instanceof St)return wt(this,ti,!0,"f"),this._emit("abort",t);if(t instanceof Ne)return this._emit("error",t);if(t instanceof Error){const r=new Ne(t.message);return r.cause=t,this._emit("error",r)}return this._emit("error",new Ne(String(t)))};function Nu(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function hs(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Ww(e,t){return!t||!Mu(t)?{...e,choices:e.choices.map(r=>({...r,message:{...r.message,parsed:null,tool_calls:r.message.tool_calls??[]}}))}:Q0(e,t)}function Q0(e,t){const r=e.choices.map(a=>{var n;if(a.finish_reason==="length")throw new mu;if(a.finish_reason==="content_filter")throw new gu;return{...a,message:{...a.message,tool_calls:((n=a.message.tool_calls)==null?void 0:n.map(s=>Gw(t,s)))??[],parsed:a.message.content&&!a.message.refusal?Vw(t,a.message.content):null}}});return{...e,choices:r}}function Vw(e,t){var r,a;return((r=e.response_format)==null?void 0:r.type)!=="json_schema"?null:((a=e.response_format)==null?void 0:a.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function Gw(e,t){var a;const r=(a=e.tools)==null?void 0:a.find(n=>{var s;return((s=n.function)==null?void 0:s.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:hs(r)?r.$parseRaw(t.function.arguments):r!=null&&r.function.strict?JSON.parse(t.function.arguments):null}}}function zw(e,t){var a;if(!e)return!1;const r=(a=e.tools)==null?void 0:a.find(n=>{var s;return((s=n.function)==null?void 0:s.name)===t.function.name});return hs(r)||(r==null?void 0:r.function.strict)||!1}function Mu(e){var t;return Nu(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(r=>hs(r)||r.type==="function"&&r.function.strict===!0))??!1}function Xw(e){for(const t of e??[]){if(t.type!=="function")throw new Ne(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new Ne(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var et=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},Lr,c0,ai,o0,l0,f0,Lu,u0;const Vo=10;class Bu extends Pu{constructor(){super(...arguments),Lr.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var a;this._chatCompletions.push(t),this._emit("chatCompletion",t);const r=(a=t.choices[0])==null?void 0:a.message;return r&&this._addMessage(r),t}_addMessage(t,r=!0){if("content"in t||(t.content=null),this.messages.push(t),r){if(this._emit("message",t),(Iu(t)||Ou(t))&&t.content)this._emit("functionCallResult",t.content);else if(an(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(an(t)&&t.tool_calls)for(const a of t.tool_calls)a.type==="function"&&this._emit("functionCall",a.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new Ne("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),et(this,Lr,"m",c0).call(this)}async finalMessage(){return await this.done(),et(this,Lr,"m",ai).call(this)}async finalFunctionCall(){return await this.done(),et(this,Lr,"m",o0).call(this)}async finalFunctionCallResult(){return await this.done(),et(this,Lr,"m",l0).call(this)}async totalUsage(){return await this.done(),et(this,Lr,"m",f0).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const r=et(this,Lr,"m",ai).call(this);r&&this._emit("finalMessage",r);const a=et(this,Lr,"m",c0).call(this);a&&this._emit("finalContent",a);const n=et(this,Lr,"m",o0).call(this);n&&this._emit("finalFunctionCall",n);const s=et(this,Lr,"m",l0).call(this);s!=null&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",et(this,Lr,"m",f0).call(this))}async _createChatCompletion(t,r,a){const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),et(this,Lr,"m",Lu).call(this,r);const s=await t.chat.completions.create({...r,stream:!1},{...a,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Q0(s,r))}async _runChatCompletion(t,r,a){for(const n of r.messages)this._addMessage(n,!1);return await this._createChatCompletion(t,r,a)}async _runFunctions(t,r,a){var u;const n="function",{function_call:s="auto",stream:i,...c}=r,o=typeof s!="string"&&(s==null?void 0:s.name),{maxChatCompletions:l=Vo}=a||{},f={};for(const d of r.functions)f[d.name||d.function.name]=d;const h=r.functions.map(d=>({name:d.name||d.function.name,parameters:d.parameters,description:d.description}));for(const d of r.messages)this._addMessage(d,!1);for(let d=0;d<l;++d){const x=(u=(await this._createChatCompletion(t,{...c,function_call:s,functions:h,messages:[...this.messages]},a)).choices[0])==null?void 0:u.message;if(!x)throw new Ne("missing message in ChatCompletion response");if(!x.function_call)return;const{name:m,arguments:w}=x.function_call,_=f[m];if(_){if(o&&o!==m){const R=`Invalid function_call: ${JSON.stringify(m)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:n,name:m,content:R});continue}}else{const R=`Invalid function_call: ${JSON.stringify(m)}. Available options are: ${h.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:m,content:R});continue}let v;try{v=Wo(_)?await _.parse(w):w}catch(R){this._addMessage({role:n,name:m,content:R instanceof Error?R.message:String(R)});continue}const C=await _.function(v,this),O=et(this,Lr,"m",u0).call(this,C);if(this._addMessage({role:n,name:m,content:O}),o)return}}async _runTools(t,r,a){var d,p,x;const n="tool",{tool_choice:s="auto",stream:i,...c}=r,o=typeof s!="string"&&((d=s==null?void 0:s.function)==null?void 0:d.name),{maxChatCompletions:l=Vo}=a||{},f=r.tools.map(m=>{if(hs(m)){if(!m.$callback)throw new Ne("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:m.$callback,name:m.function.name,description:m.function.description||"",parameters:m.function.parameters,parse:m.$parseRaw,strict:!0}}}return m}),h={};for(const m of f)m.type==="function"&&(h[m.function.name||m.function.function.name]=m.function);const u="tools"in r?f.map(m=>m.type==="function"?{type:"function",function:{name:m.function.name||m.function.function.name,parameters:m.function.parameters,description:m.function.description,strict:m.function.strict}}:m):void 0;for(const m of r.messages)this._addMessage(m,!1);for(let m=0;m<l;++m){const _=(p=(await this._createChatCompletion(t,{...c,tool_choice:s,tools:u,messages:[...this.messages]},a)).choices[0])==null?void 0:p.message;if(!_)throw new Ne("missing message in ChatCompletion response");if(!((x=_.tool_calls)!=null&&x.length))return;for(const v of _.tool_calls){if(v.type!=="function")continue;const C=v.id,{name:O,arguments:R}=v.function,E=h[O];if(E){if(o&&o!==O){const L=`Invalid tool_call: ${JSON.stringify(O)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:n,tool_call_id:C,content:L});continue}}else{const L=`Invalid tool_call: ${JSON.stringify(O)}. Available options are: ${Object.keys(h).map(N=>JSON.stringify(N)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:C,content:L});continue}let M;try{M=Wo(E)?await E.parse(R):R}catch(L){const N=L instanceof Error?L.message:String(L);this._addMessage({role:n,tool_call_id:C,content:N});continue}const I=await E.function(M,this),W=et(this,Lr,"m",u0).call(this,I);if(this._addMessage({role:n,tool_call_id:C,content:W}),o)return}}}}Lr=new WeakSet,c0=function(){return et(this,Lr,"m",ai).call(this).content??null},ai=function(){let t=this.messages.length;for(;t-- >0;){const r=this.messages[t];if(an(r)){const{function_call:a,...n}=r,s={...n,content:r.content??null,refusal:r.refusal??null};return a&&(s.function_call=a),s}}throw new Ne("stream ended without producing a ChatCompletionMessage with role=assistant")},o0=function(){var t,r;for(let a=this.messages.length-1;a>=0;a--){const n=this.messages[a];if(an(n)&&(n!=null&&n.function_call))return n.function_call;if(an(n)&&((t=n==null?void 0:n.tool_calls)!=null&&t.length))return(r=n.tool_calls.at(-1))==null?void 0:r.function}},l0=function(){for(let t=this.messages.length-1;t>=0;t--){const r=this.messages[t];if(Iu(r)&&r.content!=null||Ou(r)&&r.content!=null&&typeof r.content=="string"&&this.messages.some(a=>{var n;return a.role==="assistant"&&((n=a.tool_calls)==null?void 0:n.some(s=>s.type==="function"&&s.id===r.tool_call_id))}))return r.content}},f0=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:r}of this._chatCompletions)r&&(t.completion_tokens+=r.completion_tokens,t.prompt_tokens+=r.prompt_tokens,t.total_tokens+=r.total_tokens);return t},Lu=function(t){if(t.n!=null&&t.n>1)throw new Ne("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},u0=function(t){return typeof t=="string"?t:t===void 0?"undefined":JSON.stringify(t)};class Zn extends Bu{static runFunctions(t,r,a){const n=new Zn,s={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(t,r,s)),n}static runTools(t,r,a){const n=new Zn,s={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(t,r,s)),n}_addMessage(t,r=!0){super._addMessage(t,r),an(t)&&t.content&&this._emit("content",t.content)}}const Uu=1,$u=2,Hu=4,Wu=8,Vu=16,Gu=32,zu=64,Xu=128,ju=256,Ku=Xu|ju,Yu=Vu|Gu|Ku|zu,Ju=Uu|$u|Yu,qu=Hu|Wu,jw=Ju|qu,Sr={STR:Uu,NUM:$u,ARR:Hu,OBJ:Wu,NULL:Vu,BOOL:Gu,NAN:zu,INFINITY:Xu,MINUS_INFINITY:ju,INF:Ku,SPECIAL:Yu,ATOM:Ju,COLLECTION:qu,ALL:jw};class Kw extends Error{}class Yw extends Error{}function Jw(e,t=Sr.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return qw(e.trim(),t)}const qw=(e,t)=>{const r=e.length;let a=0;const n=u=>{throw new Kw(`${u} at position ${a}`)},s=u=>{throw new Yw(`${u} at position ${a}`)},i=()=>(h(),a>=r&&n("Unexpected end of input"),e[a]==='"'?c():e[a]==="{"?o():e[a]==="["?l():e.substring(a,a+4)==="null"||Sr.NULL&t&&r-a<4&&"null".startsWith(e.substring(a))?(a+=4,null):e.substring(a,a+4)==="true"||Sr.BOOL&t&&r-a<4&&"true".startsWith(e.substring(a))?(a+=4,!0):e.substring(a,a+5)==="false"||Sr.BOOL&t&&r-a<5&&"false".startsWith(e.substring(a))?(a+=5,!1):e.substring(a,a+8)==="Infinity"||Sr.INFINITY&t&&r-a<8&&"Infinity".startsWith(e.substring(a))?(a+=8,1/0):e.substring(a,a+9)==="-Infinity"||Sr.MINUS_INFINITY&t&&1<r-a&&r-a<9&&"-Infinity".startsWith(e.substring(a))?(a+=9,-1/0):e.substring(a,a+3)==="NaN"||Sr.NAN&t&&r-a<3&&"NaN".startsWith(e.substring(a))?(a+=3,NaN):f()),c=()=>{const u=a;let d=!1;for(a++;a<r&&(e[a]!=='"'||d&&e[a-1]==="\\");)d=e[a]==="\\"?!d:!1,a++;if(e.charAt(a)=='"')try{return JSON.parse(e.substring(u,++a-Number(d)))}catch(p){s(String(p))}else if(Sr.STR&t)try{return JSON.parse(e.substring(u,a-Number(d))+'"')}catch{return JSON.parse(e.substring(u,e.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},o=()=>{a++,h();const u={};try{for(;e[a]!=="}";){if(h(),a>=r&&Sr.OBJ&t)return u;const d=c();h(),a++;try{const p=i();Object.defineProperty(u,d,{value:p,writable:!0,enumerable:!0,configurable:!0})}catch(p){if(Sr.OBJ&t)return u;throw p}h(),e[a]===","&&a++}}catch{if(Sr.OBJ&t)return u;n("Expected '}' at end of object")}return a++,u},l=()=>{a++;const u=[];try{for(;e[a]!=="]";)u.push(i()),h(),e[a]===","&&a++}catch{if(Sr.ARR&t)return u;n("Expected ']' at end of array")}return a++,u},f=()=>{if(a===0){e==="-"&&Sr.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e)}catch(d){if(Sr.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}s(String(d))}}const u=a;for(e[a]==="-"&&a++;e[a]&&!",]}".includes(e[a]);)a++;a==r&&!(Sr.NUM&t)&&n("Unterminated number literal");try{return JSON.parse(e.substring(u,a))}catch{e.substring(u,a)==="-"&&Sr.NUM&t&&n("Not sure what '-' is");try{return JSON.parse(e.substring(u,e.lastIndexOf("e")))}catch(p){s(String(p))}}},h=()=>{for(;a<r&&` 
\r	`.includes(e[a]);)a++};return i()},Go=e=>Jw(e,Sr.ALL^Sr.NUM);var za=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},Ye=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},_r,Xt,Xa,na,Ui,Rs,$i,Hi,Wi,Is,Vi,zo;class Qn extends Bu{constructor(t){super(),_r.add(this),Xt.set(this,void 0),Xa.set(this,void 0),na.set(this,void 0),za(this,Xt,t,"f"),za(this,Xa,[],"f")}get currentChatCompletionSnapshot(){return Ye(this,na,"f")}static fromReadableStream(t){const r=new Qn(null);return r._run(()=>r._fromReadableStream(t)),r}static createChatCompletion(t,r,a){const n=new Qn(r);return n._run(()=>n._runChatCompletion(t,{...r,stream:!0},{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(t,r,a){var i;super._createChatCompletion;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Ye(this,_r,"m",Ui).call(this);const s=await t.chat.completions.create({...r,stream:!0},{...a,signal:this.controller.signal});this._connected();for await(const c of s)Ye(this,_r,"m",$i).call(this,c);if((i=s.controller.signal)!=null&&i.aborted)throw new St;return this._addChatCompletion(Ye(this,_r,"m",Is).call(this))}async _fromReadableStream(t,r){var i;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),Ye(this,_r,"m",Ui).call(this),this._connected();const n=Lt.fromReadableStream(t,this.controller);let s;for await(const c of n)s&&s!==c.id&&this._addChatCompletion(Ye(this,_r,"m",Is).call(this)),Ye(this,_r,"m",$i).call(this,c),s=c.id;if((i=n.controller.signal)!=null&&i.aborted)throw new St;return this._addChatCompletion(Ye(this,_r,"m",Is).call(this))}[(Xt=new WeakMap,Xa=new WeakMap,na=new WeakMap,_r=new WeakSet,Ui=function(){this.ended||za(this,na,void 0,"f")},Rs=function(r){let a=Ye(this,Xa,"f")[r.index];return a||(a={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ye(this,Xa,"f")[r.index]=a,a)},$i=function(r){var n,s,i,c,o,l,f,h,u,d,p,x,m,w,_;if(this.ended)return;const a=Ye(this,_r,"m",zo).call(this,r);this._emit("chunk",r,a);for(const v of r.choices){const C=a.choices[v.index];v.delta.content!=null&&((n=C.message)==null?void 0:n.role)==="assistant"&&((s=C.message)!=null&&s.content)&&(this._emit("content",v.delta.content,C.message.content),this._emit("content.delta",{delta:v.delta.content,snapshot:C.message.content,parsed:C.message.parsed})),v.delta.refusal!=null&&((i=C.message)==null?void 0:i.role)==="assistant"&&((c=C.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:v.delta.refusal,snapshot:C.message.refusal}),((o=v.logprobs)==null?void 0:o.content)!=null&&((l=C.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(f=v.logprobs)==null?void 0:f.content,snapshot:((h=C.logprobs)==null?void 0:h.content)??[]}),((u=v.logprobs)==null?void 0:u.refusal)!=null&&((d=C.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(p=v.logprobs)==null?void 0:p.refusal,snapshot:((x=C.logprobs)==null?void 0:x.refusal)??[]});const O=Ye(this,_r,"m",Rs).call(this,C);C.finish_reason&&(Ye(this,_r,"m",Wi).call(this,C),O.current_tool_call_index!=null&&Ye(this,_r,"m",Hi).call(this,C,O.current_tool_call_index));for(const R of v.delta.tool_calls??[])O.current_tool_call_index!==R.index&&(Ye(this,_r,"m",Wi).call(this,C),O.current_tool_call_index!=null&&Ye(this,_r,"m",Hi).call(this,C,O.current_tool_call_index)),O.current_tool_call_index=R.index;for(const R of v.delta.tool_calls??[]){const E=(m=C.message.tool_calls)==null?void 0:m[R.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(w=E.function)==null?void 0:w.name,index:R.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((_=R.function)==null?void 0:_.arguments)??""}):(E==null||E.type,void 0))}}},Hi=function(r,a){var i,c,o;if(Ye(this,_r,"m",Rs).call(this,r).done_tool_calls.has(a))return;const s=(i=r.message.tool_calls)==null?void 0:i[a];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const l=(o=(c=Ye(this,Xt,"f"))==null?void 0:c.tools)==null?void 0:o.find(f=>f.type==="function"&&f.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:a,arguments:s.function.arguments,parsed_arguments:hs(l)?l.$parseRaw(s.function.arguments):l!=null&&l.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Wi=function(r){var n,s;const a=Ye(this,_r,"m",Rs).call(this,r);if(r.message.content&&!a.content_done){a.content_done=!0;const i=Ye(this,_r,"m",Vi).call(this);this._emit("content.done",{content:r.message.content,parsed:i?i.$parseRaw(r.message.content):null})}r.message.refusal&&!a.refusal_done&&(a.refusal_done=!0,this._emit("refusal.done",{refusal:r.message.refusal})),(n=r.logprobs)!=null&&n.content&&!a.logprobs_content_done&&(a.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:r.logprobs.content})),(s=r.logprobs)!=null&&s.refusal&&!a.logprobs_refusal_done&&(a.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:r.logprobs.refusal}))},Is=function(){if(this.ended)throw new Ne("stream has ended, this shouldn't happen");const r=Ye(this,na,"f");if(!r)throw new Ne("request ended without sending any chunks");return za(this,na,void 0,"f"),za(this,Xa,[],"f"),Zw(r,Ye(this,Xt,"f"))},Vi=function(){var a;const r=(a=Ye(this,Xt,"f"))==null?void 0:a.response_format;return Nu(r)?r:null},zo=function(r){var a,n,s,i;let c=Ye(this,na,"f");const{choices:o,...l}=r;c?Object.assign(c,l):c=za(this,na,{...l,choices:[]},"f");for(const{delta:f,finish_reason:h,index:u,logprobs:d=null,...p}of r.choices){let x=c.choices[u];if(x||(x=c.choices[u]={finish_reason:h,index:u,message:{},logprobs:d,...p}),d)if(!x.logprobs)x.logprobs=Object.assign({},d);else{const{content:R,refusal:E,...M}=d;Object.assign(x.logprobs,M),R&&((a=x.logprobs).content??(a.content=[]),x.logprobs.content.push(...R)),E&&((n=x.logprobs).refusal??(n.refusal=[]),x.logprobs.refusal.push(...E))}if(h&&(x.finish_reason=h,Ye(this,Xt,"f")&&Mu(Ye(this,Xt,"f")))){if(h==="length")throw new mu;if(h==="content_filter")throw new gu}if(Object.assign(x,p),!f)continue;const{content:m,refusal:w,function_call:_,role:v,tool_calls:C,...O}=f;if(Object.assign(x.message,O),w&&(x.message.refusal=(x.message.refusal||"")+w),v&&(x.message.role=v),_&&(x.message.function_call?(_.name&&(x.message.function_call.name=_.name),_.arguments&&((s=x.message.function_call).arguments??(s.arguments=""),x.message.function_call.arguments+=_.arguments)):x.message.function_call=_),m&&(x.message.content=(x.message.content||"")+m,!x.message.refusal&&Ye(this,_r,"m",Vi).call(this)&&(x.message.parsed=Go(x.message.content))),C){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:R,id:E,type:M,function:I,...W}of C){const L=(i=x.message.tool_calls)[R]??(i[R]={});Object.assign(L,W),E&&(L.id=E),M&&(L.type=M),I&&(L.function??(L.function={name:I.name??"",arguments:""})),I!=null&&I.name&&(L.function.name=I.name),I!=null&&I.arguments&&(L.function.arguments+=I.arguments,zw(Ye(this,Xt,"f"),L)&&(L.function.parsed_arguments=Go(L.function.arguments)))}}}return c},Symbol.asyncIterator)](){const t=[],r=[];let a=!1;return this.on("chunk",n=>{const s=r.shift();s?s.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of r)n.resolve(void 0);r.length=0}),this.on("abort",n=>{a=!0;for(const s of r)s.reject(n);r.length=0}),this.on("error",n=>{a=!0;for(const s of r)s.reject(n);r.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((s,i)=>r.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Lt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Zw(e,t){const{id:r,choices:a,created:n,model:s,system_fingerprint:i,...c}=e,o={...c,id:r,choices:a.map(({message:l,finish_reason:f,index:h,logprobs:u,...d})=>{if(!f)throw new Ne(`missing finish_reason for choice ${h}`);const{content:p=null,function_call:x,tool_calls:m,...w}=l,_=l.role;if(!_)throw new Ne(`missing role for choice ${h}`);if(x){const{arguments:v,name:C}=x;if(v==null)throw new Ne(`missing function_call.arguments for choice ${h}`);if(!C)throw new Ne(`missing function_call.name for choice ${h}`);return{...d,message:{content:p,function_call:{arguments:v,name:C},role:_,refusal:l.refusal??null},finish_reason:f,index:h,logprobs:u}}return m?{...d,index:h,finish_reason:f,logprobs:u,message:{...w,role:_,content:p,refusal:l.refusal??null,tool_calls:m.map((v,C)=>{const{function:O,type:R,id:E,...M}=v,{arguments:I,name:W,...L}=O||{};if(E==null)throw new Ne(`missing choices[${h}].tool_calls[${C}].id
${Os(e)}`);if(R==null)throw new Ne(`missing choices[${h}].tool_calls[${C}].type
${Os(e)}`);if(W==null)throw new Ne(`missing choices[${h}].tool_calls[${C}].function.name
${Os(e)}`);if(I==null)throw new Ne(`missing choices[${h}].tool_calls[${C}].function.arguments
${Os(e)}`);return{...M,id:E,type:R,function:{...L,name:W,arguments:I}}})}}:{...d,message:{...w,content:p,role:_,refusal:l.refusal??null},finish_reason:f,index:h,logprobs:u}}),created:n,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Ww(o,t)}function Os(e){return JSON.stringify(e)}class nn extends Qn{static fromReadableStream(t){const r=new nn(null);return r._run(()=>r._fromReadableStream(t)),r}static runFunctions(t,r,a){const n=new nn(null),s={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(t,r,s)),n}static runTools(t,r,a){const n=new nn(r),s={...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(t,r,s)),n}}let Zu=class extends je{parse(t,r){return Xw(t.tools),this._client.chat.completions.create(t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(a=>Q0(a,t))}runFunctions(t,r){return t.stream?nn.runFunctions(this._client,t,r):Zn.runFunctions(this._client,t,r)}runTools(t,r){return t.stream?nn.runTools(this._client,t,r):Zn.runTools(this._client,t,r)}stream(t,r){return Qn.createChatCompletion(this._client,t,r)}};class h0 extends je{constructor(){super(...arguments),this.completions=new Zu(this._client)}}(function(e){e.Completions=Zu})(h0||(h0={}));var ke=function(e,t,r,a){if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?a:r==="a"?a.call(e):a?a.value:t.get(e)},it=function(e,t,r,a,n){if(a==="m")throw new TypeError("Private method is not writable");if(a==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return a==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r},Rr,d0,Mt,Us,kt,Ta,qa,ka,ni,ct,$s,Hs,Wn,Cn,Rn,Xo,jo,Ko,Yo,Jo,qo,Zo;class Ft extends Pu{constructor(){super(...arguments),Rr.add(this),d0.set(this,[]),Mt.set(this,{}),Us.set(this,{}),kt.set(this,void 0),Ta.set(this,void 0),qa.set(this,void 0),ka.set(this,void 0),ni.set(this,void 0),ct.set(this,void 0),$s.set(this,void 0),Hs.set(this,void 0),Wn.set(this,void 0)}[(d0=new WeakMap,Mt=new WeakMap,Us=new WeakMap,kt=new WeakMap,Ta=new WeakMap,qa=new WeakMap,ka=new WeakMap,ni=new WeakMap,ct=new WeakMap,$s=new WeakMap,Hs=new WeakMap,Wn=new WeakMap,Rr=new WeakSet,Symbol.asyncIterator)](){const t=[],r=[];let a=!1;return this.on("event",n=>{const s=r.shift();s?s.resolve(n):t.push(n)}),this.on("end",()=>{a=!0;for(const n of r)n.resolve(void 0);r.length=0}),this.on("abort",n=>{a=!0;for(const s of r)s.reject(n);r.length=0}),this.on("error",n=>{a=!0;for(const s of r)s.reject(n);r.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((s,i)=>r.push({resolve:s,reject:i})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const r=new Ft;return r._run(()=>r._fromReadableStream(t)),r}async _fromReadableStream(t,r){var s;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=Lt.fromReadableStream(t,this.controller);for await(const i of n)ke(this,Rr,"m",Cn).call(this,i);if((s=n.controller.signal)!=null&&s.aborted)throw new St;return this._addRun(ke(this,Rr,"m",Rn).call(this))}toReadableStream(){return new Lt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,r,a,n,s){const i=new Ft;return i._run(()=>i._runToolAssistantStream(t,r,a,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(t,r,a,n,s){var l;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const c={...n,stream:!0},o=await t.submitToolOutputs(r,a,c,{...s,signal:this.controller.signal});this._connected();for await(const f of o)ke(this,Rr,"m",Cn).call(this,f);if((l=o.controller.signal)!=null&&l.aborted)throw new St;return this._addRun(ke(this,Rr,"m",Rn).call(this))}static createThreadAssistantStream(t,r,a){const n=new Ft;return n._run(()=>n._threadAssistantStream(t,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(t,r,a,n){const s=new Ft;return s._run(()=>s._runAssistantStream(t,r,a,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return ke(this,$s,"f")}currentRun(){return ke(this,Hs,"f")}currentMessageSnapshot(){return ke(this,kt,"f")}currentRunStepSnapshot(){return ke(this,Wn,"f")}async finalRunSteps(){return await this.done(),Object.values(ke(this,Mt,"f"))}async finalMessages(){return await this.done(),Object.values(ke(this,Us,"f"))}async finalRun(){if(await this.done(),!ke(this,Ta,"f"))throw Error("Final run was not received.");return ke(this,Ta,"f")}async _createThreadAssistantStream(t,r,a){var c;const n=a==null?void 0:a.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const s={...r,stream:!0},i=await t.createAndRun(s,{...a,signal:this.controller.signal});this._connected();for await(const o of i)ke(this,Rr,"m",Cn).call(this,o);if((c=i.controller.signal)!=null&&c.aborted)throw new St;return this._addRun(ke(this,Rr,"m",Rn).call(this))}async _createAssistantStream(t,r,a,n){var o;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...a,stream:!0},c=await t.create(r,i,{...n,signal:this.controller.signal});this._connected();for await(const l of c)ke(this,Rr,"m",Cn).call(this,l);if((o=c.controller.signal)!=null&&o.aborted)throw new St;return this._addRun(ke(this,Rr,"m",Rn).call(this))}static accumulateDelta(t,r){for(const[a,n]of Object.entries(r)){if(!t.hasOwnProperty(a)){t[a]=n;continue}let s=t[a];if(s==null){t[a]=n;continue}if(a==="index"||a==="type"){t[a]=n;continue}if(typeof s=="string"&&typeof n=="string")s+=n;else if(typeof s=="number"&&typeof n=="number")s+=n;else if(Bi(s)&&Bi(n))s=this.accumulateDelta(s,n);else if(Array.isArray(s)&&Array.isArray(n)){if(s.every(i=>typeof i=="string"||typeof i=="number")){s.push(...n);continue}for(const i of n){if(!Bi(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const c=i.index;if(c==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const o=s[c];o==null?s.push(i):s[c]=this.accumulateDelta(o,i)}continue}else throw Error(`Unhandled record type: ${a}, deltaValue: ${n}, accValue: ${s}`);t[a]=s}return t}_addRun(t){return t}async _threadAssistantStream(t,r,a){return await this._createThreadAssistantStream(r,t,a)}async _runAssistantStream(t,r,a,n){return await this._createAssistantStream(r,t,a,n)}async _runToolAssistantStream(t,r,a,n,s){return await this._createToolAssistantStream(a,t,r,n,s)}}Cn=function(t){if(!this.ended)switch(it(this,$s,t,"f"),ke(this,Rr,"m",Ko).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ke(this,Rr,"m",Zo).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ke(this,Rr,"m",jo).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ke(this,Rr,"m",Xo).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Rn=function(){if(this.ended)throw new Ne("stream has ended, this shouldn't happen");if(!ke(this,Ta,"f"))throw Error("Final run has not been received");return ke(this,Ta,"f")},Xo=function(t){const[r,a]=ke(this,Rr,"m",Jo).call(this,t,ke(this,kt,"f"));it(this,kt,r,"f"),ke(this,Us,"f")[r.id]=r;for(const n of a){const s=r.content[n.index];(s==null?void 0:s.type)=="text"&&this._emit("textCreated",s.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,r),t.data.delta.content)for(const n of t.data.delta.content){if(n.type=="text"&&n.text){let s=n.text,i=r.content[n.index];if(i&&i.type=="text")this._emit("textDelta",s,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=ke(this,qa,"f")){if(ke(this,ka,"f"))switch(ke(this,ka,"f").type){case"text":this._emit("textDone",ke(this,ka,"f").text,ke(this,kt,"f"));break;case"image_file":this._emit("imageFileDone",ke(this,ka,"f").image_file,ke(this,kt,"f"));break}it(this,qa,n.index,"f")}it(this,ka,r.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(ke(this,qa,"f")!==void 0){const n=t.data.content[ke(this,qa,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,ke(this,kt,"f"));break;case"text":this._emit("textDone",n.text,ke(this,kt,"f"));break}}ke(this,kt,"f")&&this._emit("messageDone",t.data),it(this,kt,void 0,"f")}},jo=function(t){const r=ke(this,Rr,"m",Yo).call(this,t);switch(it(this,Wn,r,"f"),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const a=t.data.delta;if(a.step_details&&a.step_details.type=="tool_calls"&&a.step_details.tool_calls&&r.step_details.type=="tool_calls")for(const s of a.step_details.tool_calls)s.index==ke(this,ni,"f")?this._emit("toolCallDelta",s,r.step_details.tool_calls[s.index]):(ke(this,ct,"f")&&this._emit("toolCallDone",ke(this,ct,"f")),it(this,ni,s.index,"f"),it(this,ct,r.step_details.tool_calls[s.index],"f"),ke(this,ct,"f")&&this._emit("toolCallCreated",ke(this,ct,"f")));this._emit("runStepDelta",t.data.delta,r);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":it(this,Wn,void 0,"f"),t.data.step_details.type=="tool_calls"&&ke(this,ct,"f")&&(this._emit("toolCallDone",ke(this,ct,"f")),it(this,ct,void 0,"f")),this._emit("runStepDone",t.data,r);break}},Ko=function(t){ke(this,d0,"f").push(t),this._emit("event",t)},Yo=function(t){switch(t.event){case"thread.run.step.created":return ke(this,Mt,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let r=ke(this,Mt,"f")[t.data.id];if(!r)throw Error("Received a RunStepDelta before creation of a snapshot");let a=t.data;if(a.delta){const n=Ft.accumulateDelta(r,a.delta);ke(this,Mt,"f")[t.data.id]=n}return ke(this,Mt,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ke(this,Mt,"f")[t.data.id]=t.data;break}if(ke(this,Mt,"f")[t.data.id])return ke(this,Mt,"f")[t.data.id];throw new Error("No snapshot available")},Jo=function(t,r){let a=[];switch(t.event){case"thread.message.created":return[t.data,a];case"thread.message.delta":if(!r)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=t.data;if(n.delta.content)for(const s of n.delta.content)if(s.index in r.content){let i=r.content[s.index];r.content[s.index]=ke(this,Rr,"m",qo).call(this,s,i)}else r.content[s.index]=s,a.push(s);return[r,a];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(r)return[r,a];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},qo=function(t,r){return Ft.accumulateDelta(r,t)},Zo=function(t){switch(it(this,Hs,t.data,"f"),t.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":it(this,Ta,t.data,"f"),ke(this,ct,"f")&&(this._emit("toolCallDone",ke(this,ct,"f")),it(this,ct,void 0,"f"));break}};class ec extends je{create(t,r,a){return this._client.post(`/threads/${t}/messages`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}retrieve(t,r,a){return this._client.get(`/threads/${t}/messages/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}update(t,r,a,n){return this._client.post(`/threads/${t}/messages/${r}`,{body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t,r={},a){return nt(r)?this.list(t,{},r):this._client.getAPIList(`/threads/${t}/messages`,rc,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}del(t,r,a){return this._client.delete(`/threads/${t}/messages/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}}class rc extends Rt{}ec.MessagesPage=rc;class tc extends je{retrieve(t,r,a,n={},s){return nt(n)?this.retrieve(t,r,a,{},n):this._client.get(`/threads/${t}/runs/${r}/steps/${a}`,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(t,r,a={},n){return nt(a)?this.list(t,r,{},a):this._client.getAPIList(`/threads/${t}/runs/${r}/steps`,ac,{query:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class ac extends Rt{}tc.RunStepsPage=ac;class ds extends je{constructor(){super(...arguments),this.steps=new tc(this._client)}create(t,r,a){const{include:n,...s}=r;return this._client.post(`/threads/${t}/runs`,{query:{include:n},body:s,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers},stream:r.stream??!1})}retrieve(t,r,a){return this._client.get(`/threads/${t}/runs/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}update(t,r,a,n){return this._client.post(`/threads/${t}/runs/${r}`,{body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(t,r={},a){return nt(r)?this.list(t,{},r):this._client.getAPIList(`/threads/${t}/runs`,nc,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}cancel(t,r,a){return this._client.post(`/threads/${t}/runs/${r}/cancel`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async createAndPoll(t,r,a){const n=await this.create(t,r,a);return await this.poll(t,n.id,a)}createAndStream(t,r,a){return Ft.createAssistantStream(t,this._client.beta.threads.runs,r,a)}async poll(t,r,a){const n={...a==null?void 0:a.headers,"X-Stainless-Poll-Helper":"true"};for(a!=null&&a.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=a.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(t,r,{...a,headers:{...a==null?void 0:a.headers,...n}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(a!=null&&a.pollIntervalMs)c=a.pollIntervalMs;else{const o=i.headers.get("openai-poll-after-ms");if(o){const l=parseInt(o);isNaN(l)||(c=l)}}await fs(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(t,r,a){return Ft.createAssistantStream(t,this._client.beta.threads.runs,r,a)}submitToolOutputs(t,r,a,n){return this._client.post(`/threads/${t}/runs/${r}/submit_tool_outputs`,{body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:a.stream??!1})}async submitToolOutputsAndPoll(t,r,a,n){const s=await this.submitToolOutputs(t,r,a,n);return await this.poll(t,s.id,n)}submitToolOutputsStream(t,r,a,n){return Ft.createToolAssistantStream(t,r,this._client.beta.threads.runs,a,n)}}class nc extends Rt{}ds.RunsPage=nc;ds.Steps=tc;ds.RunStepsPage=ac;class hn extends je{constructor(){super(...arguments),this.runs=new ds(this._client),this.messages=new ec(this._client)}create(t={},r){return nt(t)?this.create({},t):this._client.post("/threads",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/threads/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,a){return this._client.post(`/threads/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}del(t,r){return this._client.delete(`/threads/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}createAndRun(t,r){return this._client.post("/threads/runs",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}async createAndRunPoll(t,r){const a=await this.createAndRun(t,r);return await this.runs.poll(a.thread_id,a.id,r)}createAndRunStream(t,r){return Ft.createThreadAssistantStream(t,this._client.beta.threads,r)}}hn.Runs=ds;hn.RunsPage=nc;hn.Messages=ec;hn.MessagesPage=rc;const Qw=async e=>{const t=await Promise.allSettled(e),r=t.filter(n=>n.status==="rejected");if(r.length){for(const n of r)console.error(n.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const a=[];for(const n of t)n.status==="fulfilled"&&a.push(n.value);return a};let sc=class extends je{create(t,r,a){return this._client.post(`/vector_stores/${t}/files`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}retrieve(t,r,a){return this._client.get(`/vector_stores/${t}/files/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t,r={},a){return nt(r)?this.list(t,{},r):this._client.getAPIList(`/vector_stores/${t}/files`,pi,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}del(t,r,a){return this._client.delete(`/vector_stores/${t}/files/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async createAndPoll(t,r,a){const n=await this.create(t,r,a);return await this.poll(t,n.id,a)}async poll(t,r,a){const n={...a==null?void 0:a.headers,"X-Stainless-Poll-Helper":"true"};for(a!=null&&a.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=a.pollIntervalMs.toString());;){const s=await this.retrieve(t,r,{...a,headers:n}).withResponse(),i=s.data;switch(i.status){case"in_progress":let c=5e3;if(a!=null&&a.pollIntervalMs)c=a.pollIntervalMs;else{const o=s.response.headers.get("openai-poll-after-ms");if(o){const l=parseInt(o);isNaN(l)||(c=l)}}await fs(c);break;case"failed":case"completed":return i}}}async upload(t,r,a){const n=await this._client.files.create({file:r,purpose:"assistants"},a);return this.create(t,{file_id:n.id},a)}async uploadAndPoll(t,r,a){const n=await this.upload(t,r,a);return await this.poll(t,n.id,a)}};class pi extends Rt{}sc.VectorStoreFilesPage=pi;class Qu extends je{create(t,r,a){return this._client.post(`/vector_stores/${t}/file_batches`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}retrieve(t,r,a){return this._client.get(`/vector_stores/${t}/file_batches/${r}`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}cancel(t,r,a){return this._client.post(`/vector_stores/${t}/file_batches/${r}/cancel`,{...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}async createAndPoll(t,r,a){const n=await this.create(t,r);return await this.poll(t,n.id,a)}listFiles(t,r,a={},n){return nt(a)?this.listFiles(t,r,{},a):this._client.getAPIList(`/vector_stores/${t}/file_batches/${r}/files`,pi,{query:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async poll(t,r,a){const n={...a==null?void 0:a.headers,"X-Stainless-Poll-Helper":"true"};for(a!=null&&a.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=a.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(t,r,{...a,headers:n}).withResponse();switch(s.status){case"in_progress":let c=5e3;if(a!=null&&a.pollIntervalMs)c=a.pollIntervalMs;else{const o=i.headers.get("openai-poll-after-ms");if(o){const l=parseInt(o);isNaN(l)||(c=l)}}await fs(c);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(t,{files:r,fileIds:a=[]},n){if(r==null||r.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=(n==null?void 0:n.maxConcurrency)??5,i=Math.min(s,r.length),c=this._client,o=r.values(),l=[...a];async function f(u){for(let d of u){const p=await c.files.create({file:d,purpose:"assistants"},n);l.push(p.id)}}const h=Array(i).fill(o).map(f);return await Qw(h),await this.createAndPoll(t,{file_ids:l})}}class dn extends je{constructor(){super(...arguments),this.files=new sc(this._client),this.fileBatches=new Qu(this._client)}create(t,r){return this._client.post("/vector_stores",{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(t,r){return this._client.get(`/vector_stores/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(t,r,a){return this._client.post(`/vector_stores/${t}`,{body:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(t={},r){return nt(t)?this.list({},t):this._client.getAPIList("/vector_stores",ic,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(t,r){return this._client.delete(`/vector_stores/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class ic extends Rt{}dn.VectorStoresPage=ic;dn.Files=sc;dn.VectorStoreFilesPage=pi;dn.FileBatches=Qu;class Ba extends je{constructor(){super(...arguments),this.vectorStores=new dn(this._client),this.chat=new h0(this._client),this.assistants=new q0(this._client),this.threads=new hn(this._client)}}Ba.VectorStores=dn;Ba.VectorStoresPage=ic;Ba.Assistants=q0;Ba.AssistantsPage=Z0;Ba.Threads=hn;class eh extends je{create(t,r){return this._client.post("/completions",{body:t,...r,stream:t.stream??!1})}}class rh extends je{create(t,r){return this._client.post("/embeddings",{body:t,...r})}}class cc extends je{create(t,r){return this._client.post("/files",on({body:t,...r}))}retrieve(t,r){return this._client.get(`/files/${t}`,r)}list(t={},r){return nt(t)?this.list({},t):this._client.getAPIList("/files",oc,{query:t,...r})}del(t,r){return this._client.delete(`/files/${t}`,r)}content(t,r){return this._client.get(`/files/${t}/content`,{...r,__binaryResponse:!0})}retrieveContent(t,r){return this._client.get(`/files/${t}/content`,{...r,headers:{Accept:"application/json",...r==null?void 0:r.headers}})}async waitForProcessing(t,{pollInterval:r=5e3,maxWait:a=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),s=Date.now();let i=await this.retrieve(t);for(;!i.status||!n.has(i.status);)if(await fs(r),i=await this.retrieve(t),Date.now()-s>a)throw new j0({message:`Giving up on waiting for file ${t} to finish processing after ${a} milliseconds.`});return i}}class oc extends Rt{}cc.FileObjectsPage=oc;class lc extends je{list(t,r={},a){return nt(r)?this.list(t,{},r):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,fc,{query:r,...a})}}class fc extends Rt{}lc.FineTuningJobCheckpointsPage=fc;class xn extends je{constructor(){super(...arguments),this.checkpoints=new lc(this._client)}create(t,r){return this._client.post("/fine_tuning/jobs",{body:t,...r})}retrieve(t,r){return this._client.get(`/fine_tuning/jobs/${t}`,r)}list(t={},r){return nt(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",uc,{query:t,...r})}cancel(t,r){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,r)}listEvents(t,r={},a){return nt(r)?this.listEvents(t,{},r):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,hc,{query:r,...a})}}class uc extends Rt{}class hc extends Rt{}xn.FineTuningJobsPage=uc;xn.FineTuningJobEventsPage=hc;xn.Checkpoints=lc;xn.FineTuningJobCheckpointsPage=fc;class xs extends je{constructor(){super(...arguments),this.jobs=new xn(this._client)}}xs.Jobs=xn;xs.FineTuningJobsPage=uc;xs.FineTuningJobEventsPage=hc;class th extends je{createVariation(t,r){return this._client.post("/images/variations",on({body:t,...r}))}edit(t,r){return this._client.post("/images/edits",on({body:t,...r}))}generate(t,r){return this._client.post("/images/generations",{body:t,...r})}}class dc extends je{retrieve(t,r){return this._client.get(`/models/${t}`,r)}list(t){return this._client.getAPIList("/models",xc,t)}del(t,r){return this._client.delete(`/models/${t}`,r)}}class xc extends Hw{}dc.ModelsPage=xc;class ah extends je{create(t,r){return this._client.post("/moderations",{body:t,...r})}}class nh extends je{create(t,r,a){return this._client.post(`/uploads/${t}/parts`,on({body:r,...a}))}}class pc extends je{constructor(){super(...arguments),this.parts=new nh(this._client)}create(t,r){return this._client.post("/uploads",{body:t,...r})}cancel(t,r){return this._client.post(`/uploads/${t}/cancel`,r)}complete(t,r,a){return this._client.post(`/uploads/${t}/complete`,{body:r,...a})}}pc.Parts=nh;var sh;class Ue extends bw{constructor({baseURL:t=Cs("OPENAI_BASE_URL"),apiKey:r=Cs("OPENAI_API_KEY"),organization:a=Cs("OPENAI_ORG_ID")??null,project:n=Cs("OPENAI_PROJECT_ID")??null,...s}={}){if(r===void 0)throw new Ne("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:r,organization:a,project:n,...s,baseURL:t||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&Uw())throw new Ne(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new eh(this),this.chat=new K0(this),this.embeddings=new rh(this),this.files=new cc(this),this.images=new th(this),this.audio=new us(this),this.moderations=new ah(this),this.models=new dc(this),this.fineTuning=new xs(this),this.beta=new Ba(this),this.batches=new Y0(this),this.uploads=new pc(this),this._options=i,this.apiKey=r,this.organization=a,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(t){return uw(t,{arrayFormat:"brackets"})}}sh=Ue;Ue.OpenAI=sh;Ue.DEFAULT_TIMEOUT=6e5;Ue.OpenAIError=Ne;Ue.APIError=Pr;Ue.APIConnectionError=hi;Ue.APIConnectionTimeoutError=j0;Ue.APIUserAbortError=St;Ue.NotFoundError=uu;Ue.ConflictError=hu;Ue.RateLimitError=xu;Ue.BadRequestError=ou;Ue.AuthenticationError=lu;Ue.InternalServerError=pu;Ue.PermissionDeniedError=fu;Ue.UnprocessableEntityError=du;Ue.toFile=ku;Ue.fileFromPath=iu;Ue.Completions=eh;Ue.Chat=K0;Ue.Embeddings=rh;Ue.Files=cc;Ue.FileObjectsPage=oc;Ue.Images=th;Ue.Audio=us;Ue.Moderations=ah;Ue.Models=dc;Ue.ModelsPage=xc;Ue.FineTuning=xs;Ue.Beta=Ba;Ue.Batches=Y0;Ue.BatchesPage=J0;Ue.Uploads=pc;var ek=Oe('<div class="loading-overlay svelte-1ib1jqp"><div class="spinner-border svelte-1ib1jqp" role="status"><span class="visually-hidden svelte-1ib1jqp">Loading...</span></div></div>');function rk(e,t){let r=ze(t,"visible",8,!1);var a=De(),n=Fe(a);{var s=i=>{var c=ek();ne(i,c)};xr(n,i=>{r()&&i(s)})}ne(e,a)}function tk(){const e=console.warn;console.warn=t=>{t.includes("unknown prop")||t.includes("unexpected slot")||e(t)},_0(()=>{console.warn=e})}var ak=Oe("<!> <!>",1);function va(e,t){const r=Fc(t,["children","$$slots","$$events","$$legacy"]),a=Fc(r,["type","tokens","header","rows","ordered","renderers"]);ts(t,!1);let n=ze(t,"type",8,void 0),s=ze(t,"tokens",8,void 0),i=ze(t,"header",8,void 0),c=ze(t,"rows",8,void 0),o=ze(t,"ordered",8,!1),l=ze(t,"renderers",8);tk(),rs();var f=De(),h=Fe(f);{var u=p=>{var x=De(),m=Fe(x);at(m,1,s,tt,(w,_)=>{var v=De(),C=Fe(v);va(C,Wa(()=>j(_),{get renderers(){return l()}})),ne(w,v)}),ne(p,x)},d=p=>{var x=De(),m=Fe(x);{var w=_=>{var v=De(),C=Fe(v);{var O=E=>{var M=De(),I=Fe(M);ut(I,()=>l().table,(W,L)=>{L(W,{children:(N,J)=>{var le=ak(),Z=Fe(le);ut(Z,()=>l().tablehead,(Q,ye)=>{ye(Q,{children:(U,ve)=>{var ge=De(),F=Fe(ge);ut(F,()=>l().tablerow,(B,P)=>{P(B,{children:(D,Y)=>{var re=De(),ie=Fe(re);at(ie,1,i,tt,(te,H,se)=>{var y=De(),_e=Fe(y),he=Ac(()=>a.align[se]||"center");ut(_e,()=>l().tablecell,(we,me)=>{me(we,{header:!0,get align(){return j(he)},children:(q,Se)=>{var He=De(),Pe=Fe(He);va(Pe,{get tokens(){return j(H).tokens},get renderers(){return l()}}),ne(q,He)},$$slots:{default:!0}})}),ne(te,y)}),ne(D,re)},$$slots:{default:!0}})}),ne(U,ge)},$$slots:{default:!0}})});var oe=be(Z,2);ut(oe,()=>l().tablebody,(Q,ye)=>{ye(Q,{children:(U,ve)=>{var ge=De(),F=Fe(ge);at(F,1,c,tt,(B,P)=>{var D=De(),Y=Fe(D);ut(Y,()=>l().tablerow,(re,ie)=>{ie(re,{children:(te,H)=>{var se=De(),y=Fe(se);at(y,1,()=>j(P),tt,(_e,he,we)=>{var me=De(),q=Fe(me),Se=Ac(()=>a.align[we]||"center");ut(q,()=>l().tablecell,(He,Pe)=>{Pe(He,{header:!1,get align(){return j(Se)},children:(Ke,cr)=>{var Qe=De(),qe=Fe(Qe);va(qe,{get tokens(){return j(he).tokens},get renderers(){return l()}}),ne(Ke,Qe)},$$slots:{default:!0}})}),ne(_e,me)}),ne(te,se)},$$slots:{default:!0}})}),ne(B,D)}),ne(U,ge)},$$slots:{default:!0}})}),ne(N,le)},$$slots:{default:!0}})}),ne(E,M)},R=E=>{var M=De(),I=Fe(M);{var W=N=>{var J=De(),le=Fe(J);{var Z=Q=>{var ye=De(),U=Fe(ye);ut(U,()=>l().list,(ve,ge)=>{ge(ve,Wa({get ordered(){return o()}},()=>a,{children:(F,B)=>{var P=De(),D=Fe(P);at(D,1,()=>a.items,tt,(Y,re)=>{var ie=De(),te=Fe(ie);ut(te,()=>l().orderedlistitem||l().listitem,(H,se)=>{se(H,Wa(()=>j(re),{children:(y,_e)=>{var he=De(),we=Fe(he);va(we,{get tokens(){return j(re).tokens},get renderers(){return l()}}),ne(y,he)},$$slots:{default:!0}}))}),ne(Y,ie)}),ne(F,P)},$$slots:{default:!0}}))}),ne(Q,ye)},oe=Q=>{var ye=De(),U=Fe(ye);ut(U,()=>l().list,(ve,ge)=>{ge(ve,Wa({get ordered(){return o()}},()=>a,{children:(F,B)=>{var P=De(),D=Fe(P);at(D,1,()=>a.items,tt,(Y,re)=>{var ie=De(),te=Fe(ie);ut(te,()=>l().unorderedlistitem||l().listitem,(H,se)=>{se(H,Wa(()=>j(re),{children:(y,_e)=>{var he=De(),we=Fe(he);va(we,{get tokens(){return j(re).tokens},get renderers(){return l()}}),ne(y,he)},$$slots:{default:!0}}))}),ne(Y,ie)}),ne(F,P)},$$slots:{default:!0}}))}),ne(Q,ye)};xr(le,Q=>{o()?Q(Z):Q(oe,!1)})}ne(N,J)},L=N=>{var J=De(),le=Fe(J);ut(le,()=>l()[n()],(Z,oe)=>{oe(Z,Wa(()=>a,{children:(Q,ye)=>{var U=De(),ve=Fe(U);{var ge=B=>{var P=De(),D=Fe(P);va(D,{get tokens(){return s()},get renderers(){return l()}}),ne(B,P)},F=B=>{var P=sl();Je(()=>Et(P,a.raw)),ne(B,P)};xr(ve,B=>{s()?B(ge):B(F,!1)})}ne(Q,U)},$$slots:{default:!0}}))}),ne(N,J)};xr(I,N=>{n()==="list"?N(W):N(L,!1)},!0)}ne(E,M)};xr(C,E=>{n()==="table"?E(O):E(R,!1)})}ne(_,v)};xr(m,_=>{l()[n()]&&_(w)})}ne(p,x)};xr(h,p=>{n()?p(d,!1):p(u)})}ne(e,f),as()}function mc(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let xa=mc();function ih(e){xa=e}const ch=/[&<>"']/,nk=new RegExp(ch.source,"g"),oh=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,sk=new RegExp(oh.source,"g"),ik={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qo=e=>ik[e];function Br(e,t){if(t){if(ch.test(e))return e.replace(nk,Qo)}else if(oh.test(e))return e.replace(sk,Qo);return e}const ck=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function lh(e){return e.replace(ck,(t,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}const ok=/(^|[^\[])\^/g;function Ve(e,t){e=typeof e=="string"?e:e.source,t=t||"";const r={replace:(a,n)=>(n=n.source||n,n=n.replace(ok,"$1"),e=e.replace(a,n),r),getRegex:()=>new RegExp(e,t)};return r}const lk=/[^\w:]/g,fk=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function el(e,t,r){if(e){let a;try{a=decodeURIComponent(lh(r)).replace(lk,"").toLowerCase()}catch{return null}if(a.indexOf("javascript:")===0||a.indexOf("vbscript:")===0||a.indexOf("data:")===0)return null}t&&!fk.test(r)&&(r=xk(t,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch{return null}return r}const Ds={},uk=/^[^:]+:\/*[^/]*$/,hk=/^([^:]+:)[\s\S]*$/,dk=/^([^:]+:\/*[^/]*)[\s\S]*$/;function xk(e,t){Ds[" "+e]||(uk.test(e)?Ds[" "+e]=e+"/":Ds[" "+e]=Ws(e,"/",!0)),e=Ds[" "+e];const r=e.indexOf(":")===-1;return t.substring(0,2)==="//"?r?t:e.replace(hk,"$1")+t:t.charAt(0)==="/"?r?t:e.replace(dk,"$1")+t:e+t}const si={exec:function(){}};function rl(e,t){const r=e.replace(/\|/g,(s,i,c)=>{let o=!1,l=i;for(;--l>=0&&c[l]==="\\";)o=!o;return o?"|":" |"}),a=r.split(/ \|/);let n=0;if(a[0].trim()||a.shift(),a.length>0&&!a[a.length-1].trim()&&a.pop(),a.length>t)a.splice(t);else for(;a.length<t;)a.push("");for(;n<a.length;n++)a[n]=a[n].trim().replace(/\\\|/g,"|");return a}function Ws(e,t,r){const a=e.length;if(a===0)return"";let n=0;for(;n<a;){const s=e.charAt(a-n-1);if(s===t&&!r)n++;else if(s!==t&&r)n++;else break}return e.slice(0,a-n)}function pk(e,t){if(e.indexOf(t[1])===-1)return-1;const r=e.length;let a=0,n=0;for(;n<r;n++)if(e[n]==="\\")n++;else if(e[n]===t[0])a++;else if(e[n]===t[1]&&(a--,a<0))return n;return-1}function mk(e,t){!e||e.silent||(t&&console.warn("marked(): callback is deprecated since version 5.0.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/using_pro#async"),(e.sanitize||e.sanitizer)&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options"),(e.highlight||e.langPrefix!=="language-")&&console.warn("marked(): highlight and langPrefix parameters are deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-highlight."),e.mangle&&console.warn("marked(): mangle parameter is enabled by default, but is deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install https://www.npmjs.com/package/marked-mangle, or disable by setting `{mangle: false}`."),e.baseUrl&&console.warn("marked(): baseUrl parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-base-url."),e.smartypants&&console.warn("marked(): smartypants parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-smartypants."),e.xhtml&&console.warn("marked(): xhtml parameter is deprecated since version 5.0.0, should not be used and will be removed in the future. Instead use https://www.npmjs.com/package/marked-xhtml."),(e.headerIds||e.headerPrefix)&&console.warn("marked(): headerIds and headerPrefix parameters enabled by default, but are deprecated since version 5.0.0, and will be removed in the future. To clear this warning, install  https://www.npmjs.com/package/marked-gfm-heading-id, or disable by setting `{headerIds: false}`."))}function tl(e,t,r,a){const n=t.href,s=t.title?Br(t.title):null,i=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){a.state.inLink=!0;const c={type:"link",raw:r,href:n,title:s,text:i,tokens:a.inlineTokens(i)};return a.state.inLink=!1,c}return{type:"image",raw:r,href:n,title:s,text:Br(i)}}function gk(e,t){const r=e.match(/^(\s+)(?:```)/);if(r===null)return t;const a=r[1];return t.split(`
`).map(n=>{const s=n.match(/^\s+/);if(s===null)return n;const[i]=s;return i.length>=a.length?n.slice(a.length):n}).join(`
`)}class ii{constructor(t){this.options=t||xa}space(t){const r=this.rules.block.newline.exec(t);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(t){const r=this.rules.block.code.exec(t);if(r){const a=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?a:Ws(a,`
`)}}}fences(t){const r=this.rules.block.fences.exec(t);if(r){const a=r[0],n=gk(a,r[3]||"");return{type:"code",raw:a,lang:r[2]?r[2].trim().replace(this.rules.inline._escapes,"$1"):r[2],text:n}}}heading(t){const r=this.rules.block.heading.exec(t);if(r){let a=r[2].trim();if(/#$/.test(a)){const n=Ws(a,"#");(this.options.pedantic||!n||/ $/.test(n))&&(a=n.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:a,tokens:this.lexer.inline(a)}}}hr(t){const r=this.rules.block.hr.exec(t);if(r)return{type:"hr",raw:r[0]}}blockquote(t){const r=this.rules.block.blockquote.exec(t);if(r){const a=r[0].replace(/^ *>[ \t]?/gm,""),n=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(a);return this.lexer.state.top=n,{type:"blockquote",raw:r[0],tokens:s,text:a}}}list(t){let r=this.rules.block.list.exec(t);if(r){let a,n,s,i,c,o,l,f,h,u,d,p,x=r[1].trim();const m=x.length>1,w={type:"list",raw:"",ordered:m,start:m?+x.slice(0,-1):"",loose:!1,items:[]};x=m?`\\d{1,9}\\${x.slice(-1)}`:`\\${x}`,this.options.pedantic&&(x=m?x:"[*+-]");const _=new RegExp(`^( {0,3}${x})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;t&&(p=!1,!(!(r=_.exec(t))||this.rules.block.hr.test(t)));){if(a=r[0],t=t.substring(a.length),f=r[2].split(`
`,1)[0].replace(/^\t+/,C=>" ".repeat(3*C.length)),h=t.split(`
`,1)[0],this.options.pedantic?(i=2,d=f.trimLeft()):(i=r[2].search(/[^ ]/),i=i>4?1:i,d=f.slice(i),i+=r[1].length),o=!1,!f&&/^ *$/.test(h)&&(a+=h+`
`,t=t.substring(h.length+1),p=!0),!p){const C=new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),O=new RegExp(`^ {0,${Math.min(3,i-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),R=new RegExp(`^ {0,${Math.min(3,i-1)}}(?:\`\`\`|~~~)`),E=new RegExp(`^ {0,${Math.min(3,i-1)}}#`);for(;t&&(u=t.split(`
`,1)[0],h=u,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(R.test(h)||E.test(h)||C.test(h)||O.test(t)));){if(h.search(/[^ ]/)>=i||!h.trim())d+=`
`+h.slice(i);else{if(o||f.search(/[^ ]/)>=4||R.test(f)||E.test(f)||O.test(f))break;d+=`
`+h}!o&&!h.trim()&&(o=!0),a+=u+`
`,t=t.substring(u.length+1),f=h.slice(i)}}w.loose||(l?w.loose=!0:/\n *\n *$/.test(a)&&(l=!0)),this.options.gfm&&(n=/^\[[ xX]\] /.exec(d),n&&(s=n[0]!=="[ ] ",d=d.replace(/^\[[ xX]\] +/,""))),w.items.push({type:"list_item",raw:a,task:!!n,checked:s,loose:!1,text:d}),w.raw+=a}w.items[w.items.length-1].raw=a.trimRight(),w.items[w.items.length-1].text=d.trimRight(),w.raw=w.raw.trimRight();const v=w.items.length;for(c=0;c<v;c++)if(this.lexer.state.top=!1,w.items[c].tokens=this.lexer.blockTokens(w.items[c].text,[]),!w.loose){const C=w.items[c].tokens.filter(R=>R.type==="space"),O=C.length>0&&C.some(R=>/\n.*\n/.test(R.raw));w.loose=O}if(w.loose)for(c=0;c<v;c++)w.items[c].loose=!0;return w}}html(t){const r=this.rules.block.html.exec(t);if(r){const a={type:"html",block:!0,raw:r[0],pre:!this.options.sanitizer&&(r[1]==="pre"||r[1]==="script"||r[1]==="style"),text:r[0]};if(this.options.sanitize){const n=this.options.sanitizer?this.options.sanitizer(r[0]):Br(r[0]);a.type="paragraph",a.text=n,a.tokens=this.lexer.inline(n)}return a}}def(t){const r=this.rules.block.def.exec(t);if(r){const a=r[1].toLowerCase().replace(/\s+/g," "),n=r[2]?r[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",s=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline._escapes,"$1"):r[3];return{type:"def",tag:a,raw:r[0],href:n,title:s}}}table(t){const r=this.rules.block.table.exec(t);if(r){const a={type:"table",header:rl(r[1]).map(n=>({text:n})),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(a.header.length===a.align.length){a.raw=r[0];let n=a.align.length,s,i,c,o;for(s=0;s<n;s++)/^ *-+: *$/.test(a.align[s])?a.align[s]="right":/^ *:-+: *$/.test(a.align[s])?a.align[s]="center":/^ *:-+ *$/.test(a.align[s])?a.align[s]="left":a.align[s]=null;for(n=a.rows.length,s=0;s<n;s++)a.rows[s]=rl(a.rows[s],a.header.length).map(l=>({text:l}));for(n=a.header.length,i=0;i<n;i++)a.header[i].tokens=this.lexer.inline(a.header[i].text);for(n=a.rows.length,i=0;i<n;i++)for(o=a.rows[i],c=0;c<o.length;c++)o[c].tokens=this.lexer.inline(o[c].text);return a}}}lheading(t){const r=this.rules.block.lheading.exec(t);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(t){const r=this.rules.block.paragraph.exec(t);if(r){const a=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:a,tokens:this.lexer.inline(a)}}}text(t){const r=this.rules.block.text.exec(t);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(t){const r=this.rules.inline.escape.exec(t);if(r)return{type:"escape",raw:r[0],text:Br(r[1])}}tag(t){const r=this.rules.inline.tag.exec(t);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):Br(r[0]):r[0]}}link(t){const r=this.rules.inline.link.exec(t);if(r){const a=r[2].trim();if(!this.options.pedantic&&/^</.test(a)){if(!/>$/.test(a))return;const i=Ws(a.slice(0,-1),"\\");if((a.length-i.length)%2===0)return}else{const i=pk(r[2],"()");if(i>-1){const o=(r[0].indexOf("!")===0?5:4)+r[1].length+i;r[2]=r[2].substring(0,i),r[0]=r[0].substring(0,o).trim(),r[3]=""}}let n=r[2],s="";if(this.options.pedantic){const i=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);i&&(n=i[1],s=i[3])}else s=r[3]?r[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(this.options.pedantic&&!/>$/.test(a)?n=n.slice(1):n=n.slice(1,-1)),tl(r,{href:n&&n.replace(this.rules.inline._escapes,"$1"),title:s&&s.replace(this.rules.inline._escapes,"$1")},r[0],this.lexer)}}reflink(t,r){let a;if((a=this.rules.inline.reflink.exec(t))||(a=this.rules.inline.nolink.exec(t))){let n=(a[2]||a[1]).replace(/\s+/g," ");if(n=r[n.toLowerCase()],!n){const s=a[0].charAt(0);return{type:"text",raw:s,text:s}}return tl(a,n,a[0],this.lexer)}}emStrong(t,r,a=""){let n=this.rules.inline.emStrong.lDelim.exec(t);if(!n||n[3]&&a.match(/[\p{L}\p{N}]/u))return;if(!(n[1]||n[2]||"")||!a||this.rules.inline.punctuation.exec(a)){const i=n[0].length-1;let c,o,l=i,f=0;const h=n[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(h.lastIndex=0,r=r.slice(-1*t.length+i);(n=h.exec(r))!=null;){if(c=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!c)continue;if(o=c.length,n[3]||n[4]){l+=o;continue}else if((n[5]||n[6])&&i%3&&!((i+o)%3)){f+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+f);const u=t.slice(0,i+n.index+o+1);if(Math.min(i,o)%2){const p=u.slice(1,-1);return{type:"em",raw:u,text:p,tokens:this.lexer.inlineTokens(p)}}const d=u.slice(2,-2);return{type:"strong",raw:u,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(t){const r=this.rules.inline.code.exec(t);if(r){let a=r[2].replace(/\n/g," ");const n=/[^ ]/.test(a),s=/^ /.test(a)&&/ $/.test(a);return n&&s&&(a=a.substring(1,a.length-1)),a=Br(a,!0),{type:"codespan",raw:r[0],text:a}}}br(t){const r=this.rules.inline.br.exec(t);if(r)return{type:"br",raw:r[0]}}del(t){const r=this.rules.inline.del.exec(t);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(t,r){const a=this.rules.inline.autolink.exec(t);if(a){let n,s;return a[2]==="@"?(n=Br(this.options.mangle?r(a[1]):a[1]),s="mailto:"+n):(n=Br(a[1]),s=n),{type:"link",raw:a[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(t,r){let a;if(a=this.rules.inline.url.exec(t)){let n,s;if(a[2]==="@")n=Br(this.options.mangle?r(a[0]):a[0]),s="mailto:"+n;else{let i;do i=a[0],a[0]=this.rules.inline._backpedal.exec(a[0])[0];while(i!==a[0]);n=Br(a[0]),a[1]==="www."?s="http://"+a[0]:s=a[0]}return{type:"link",raw:a[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(t,r){const a=this.rules.inline.text.exec(t);if(a){let n;return this.lexer.state.inRawBlock?n=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(a[0]):Br(a[0]):a[0]:n=Br(this.options.smartypants?r(a[0]):a[0]),{type:"text",raw:a[0],text:n}}}}const Ee={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:si,lheading:/^((?:(?!^bull ).|\n(?!\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};Ee._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;Ee._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;Ee.def=Ve(Ee.def).replace("label",Ee._label).replace("title",Ee._title).getRegex();Ee.bullet=/(?:[*+-]|\d{1,9}[.)])/;Ee.listItemStart=Ve(/^( *)(bull) */).replace("bull",Ee.bullet).getRegex();Ee.list=Ve(Ee.list).replace(/bull/g,Ee.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Ee.def.source+")").getRegex();Ee._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";Ee._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;Ee.html=Ve(Ee.html,"i").replace("comment",Ee._comment).replace("tag",Ee._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();Ee.lheading=Ve(Ee.lheading).replace(/bull/g,Ee.bullet).getRegex();Ee.paragraph=Ve(Ee._paragraph).replace("hr",Ee.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee._tag).getRegex();Ee.blockquote=Ve(Ee.blockquote).replace("paragraph",Ee.paragraph).getRegex();Ee.normal={...Ee};Ee.gfm={...Ee.normal,table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"};Ee.gfm.table=Ve(Ee.gfm.table).replace("hr",Ee.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee._tag).getRegex();Ee.gfm.paragraph=Ve(Ee._paragraph).replace("hr",Ee.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Ee.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ee._tag).getRegex();Ee.pedantic={...Ee.normal,html:Ve(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ee._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:si,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Ve(Ee.normal._paragraph).replace("hr",Ee.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ee.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()};const ue={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:si,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,rDelimAst:/^[^_*]*?__[^_*]*?\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\*)[punct](\*+)(?=[\s]|$)|[^punct\s](\*+)(?!\*)(?=[punct\s]|$)|(?!\*)[punct\s](\*+)(?=[^punct\s])|[\s](\*+)(?!\*)(?=[punct])|(?!\*)[punct](\*+)(?!\*)(?=[punct])|[^punct\s](\*+)(?=[^punct\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\s]|$)|[^punct\s](_+)(?!_)(?=[punct\s]|$)|(?!_)[punct\s](_+)(?=[^punct\s])|[\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:si,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^((?![*_])[\spunctuation])/};ue._punctuation="\\p{P}$+<=>`^|~";ue.punctuation=Ve(ue.punctuation,"u").replace(/punctuation/g,ue._punctuation).getRegex();ue.blockSkip=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;ue.anyPunctuation=/\\[punct]/g;ue._escapes=/\\([punct])/g;ue._comment=Ve(Ee._comment).replace("(?:-->|$)","-->").getRegex();ue.emStrong.lDelim=Ve(ue.emStrong.lDelim,"u").replace(/punct/g,ue._punctuation).getRegex();ue.emStrong.rDelimAst=Ve(ue.emStrong.rDelimAst,"gu").replace(/punct/g,ue._punctuation).getRegex();ue.emStrong.rDelimUnd=Ve(ue.emStrong.rDelimUnd,"gu").replace(/punct/g,ue._punctuation).getRegex();ue.anyPunctuation=Ve(ue.anyPunctuation,"gu").replace(/punct/g,ue._punctuation).getRegex();ue._escapes=Ve(ue._escapes,"gu").replace(/punct/g,ue._punctuation).getRegex();ue._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;ue._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;ue.autolink=Ve(ue.autolink).replace("scheme",ue._scheme).replace("email",ue._email).getRegex();ue._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;ue.tag=Ve(ue.tag).replace("comment",ue._comment).replace("attribute",ue._attribute).getRegex();ue._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;ue._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;ue._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;ue.link=Ve(ue.link).replace("label",ue._label).replace("href",ue._href).replace("title",ue._title).getRegex();ue.reflink=Ve(ue.reflink).replace("label",ue._label).replace("ref",Ee._label).getRegex();ue.nolink=Ve(ue.nolink).replace("ref",Ee._label).getRegex();ue.reflinkSearch=Ve(ue.reflinkSearch,"g").replace("reflink",ue.reflink).replace("nolink",ue.nolink).getRegex();ue.normal={...ue};ue.pedantic={...ue.normal,strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ve(/^!?\[(label)\]\((.*?)\)/).replace("label",ue._label).getRegex(),reflink:Ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ue._label).getRegex()};ue.gfm={...ue.normal,escape:Ve(ue.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};ue.gfm.url=Ve(ue.gfm.url,"i").replace("email",ue.gfm._extended_email).getRegex();ue.breaks={...ue.gfm,br:Ve(ue.br).replace("{2,}","*").getRegex(),text:Ve(ue.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};function vk(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function al(e){let t="",r,a;const n=e.length;for(r=0;r<n;r++)a=e.charCodeAt(r),Math.random()>.5&&(a="x"+a.toString(16)),t+="&#"+a+";";return t}class bt{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||xa,this.options.tokenizer=this.options.tokenizer||new ii,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:Ee.normal,inline:ue.normal};this.options.pedantic?(r.block=Ee.pedantic,r.inline=ue.pedantic):this.options.gfm&&(r.block=Ee.gfm,this.options.breaks?r.inline=ue.breaks:r.inline=ue.gfm),this.tokenizer.rules=r}static get rules(){return{block:Ee,inline:ue}}static lex(t,r){return new bt(r).lex(t)}static lexInline(t,r){return new bt(r).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);let r;for(;r=this.inlineQueue.shift();)this.inlineTokens(r.src,r.tokens);return this.tokens}blockTokens(t,r=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(c,o,l)=>o+"    ".repeat(l.length));let a,n,s,i;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(c=>(a=c.call({lexer:this},t,r))?(t=t.substring(a.raw.length),r.push(a),!0):!1))){if(a=this.tokenizer.space(t)){t=t.substring(a.raw.length),a.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(a);continue}if(a=this.tokenizer.code(t)){t=t.substring(a.raw.length),n=r[r.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+a.raw,n.text+=`
`+a.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(a);continue}if(a=this.tokenizer.fences(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.heading(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.hr(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.blockquote(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.list(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.html(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.def(t)){t=t.substring(a.raw.length),n=r[r.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+a.raw,n.text+=`
`+a.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.lheading(t)){t=t.substring(a.raw.length),r.push(a);continue}if(s=t,this.options.extensions&&this.options.extensions.startBlock){let c=1/0;const o=t.slice(1);let l;this.options.extensions.startBlock.forEach(function(f){l=f.call({lexer:this},o),typeof l=="number"&&l>=0&&(c=Math.min(c,l))}),c<1/0&&c>=0&&(s=t.substring(0,c+1))}if(this.state.top&&(a=this.tokenizer.paragraph(s))){n=r[r.length-1],i&&n.type==="paragraph"?(n.raw+=`
`+a.raw,n.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(a),i=s.length!==t.length,t=t.substring(a.raw.length);continue}if(a=this.tokenizer.text(t)){t=t.substring(a.raw.length),n=r[r.length-1],n&&n.type==="text"?(n.raw+=`
`+a.raw,n.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):r.push(a);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,r}inline(t,r=[]){return this.inlineQueue.push({src:t,tokens:r}),r}inlineTokens(t,r=[]){let a,n,s,i=t,c,o,l;if(this.tokens.links){const f=Object.keys(this.tokens.links);if(f.length>0)for(;(c=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)f.includes(c[0].slice(c[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(c=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(c=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,c.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(o||(l=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(f=>(a=f.call({lexer:this},t,r))?(t=t.substring(a.raw.length),r.push(a),!0):!1))){if(a=this.tokenizer.escape(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.tag(t)){t=t.substring(a.raw.length),n=r[r.length-1],n&&a.type==="text"&&n.type==="text"?(n.raw+=a.raw,n.text+=a.text):r.push(a);continue}if(a=this.tokenizer.link(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(a.raw.length),n=r[r.length-1],n&&a.type==="text"&&n.type==="text"?(n.raw+=a.raw,n.text+=a.text):r.push(a);continue}if(a=this.tokenizer.emStrong(t,i,l)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.codespan(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.br(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.del(t)){t=t.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.autolink(t,al)){t=t.substring(a.raw.length),r.push(a);continue}if(!this.state.inLink&&(a=this.tokenizer.url(t,al))){t=t.substring(a.raw.length),r.push(a);continue}if(s=t,this.options.extensions&&this.options.extensions.startInline){let f=1/0;const h=t.slice(1);let u;this.options.extensions.startInline.forEach(function(d){u=d.call({lexer:this},h),typeof u=="number"&&u>=0&&(f=Math.min(f,u))}),f<1/0&&f>=0&&(s=t.substring(0,f+1))}if(a=this.tokenizer.inlineText(s,vk)){t=t.substring(a.raw.length),a.raw.slice(-1)!=="_"&&(l=a.raw.slice(-1)),o=!0,n=r[r.length-1],n&&n.type==="text"?(n.raw+=a.raw,n.text+=a.text):r.push(a);continue}if(t){const f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return r}}class ci{constructor(t){this.options=t||xa}code(t,r,a){const n=(r||"").match(/\S*/)[0];if(this.options.highlight){const s=this.options.highlight(t,n);s!=null&&s!==t&&(a=!0,t=s)}return t=t.replace(/\n$/,"")+`
`,n?'<pre><code class="'+this.options.langPrefix+Br(n)+'">'+(a?t:Br(t,!0))+`</code></pre>
`:"<pre><code>"+(a?t:Br(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t,r){return t}heading(t,r,a,n){if(this.options.headerIds){const s=this.options.headerPrefix+n.slug(a);return`<h${r} id="${s}">${t}</h${r}>
`}return`<h${r}>${t}</h${r}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,r,a){const n=r?"ol":"ul",s=r&&a!==1?' start="'+a+'"':"";return"<"+n+s+`>
`+t+"</"+n+`>
`}listitem(t){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return`<p>${t}</p>
`}table(t,r){return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,r){const a=r.header?"th":"td";return(r.align?`<${a} align="${r.align}">`:`<${a}>`)+t+`</${a}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return`<del>${t}</del>`}link(t,r,a){if(t=el(this.options.sanitize,this.options.baseUrl,t),t===null)return a;let n='<a href="'+t+'"';return r&&(n+=' title="'+r+'"'),n+=">"+a+"</a>",n}image(t,r,a){if(t=el(this.options.sanitize,this.options.baseUrl,t),t===null)return a;let n=`<img src="${t}" alt="${a}"`;return r&&(n+=` title="${r}"`),n+=this.options.xhtml?"/>":">",n}text(t){return t}}class gc{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,r,a){return""+a}image(t,r,a){return""+a}br(){return""}}class es{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,r){let a=t,n=0;if(this.seen.hasOwnProperty(a)){n=this.seen[t];do n++,a=t+"-"+n;while(this.seen.hasOwnProperty(a))}return r||(this.seen[t]=n,this.seen[a]=0),a}slug(t,r={}){const a=this.serialize(t);return this.getNextSafeSlug(a,r.dryrun)}}class Bt{constructor(t){this.options=t||xa,this.options.renderer=this.options.renderer||new ci,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new gc,this.slugger=new es}static parse(t,r){return new Bt(r).parse(t)}static parseInline(t,r){return new Bt(r).parseInline(t)}parse(t,r=!0){let a="",n,s,i,c,o,l,f,h,u,d,p,x,m,w,_,v,C,O,R;const E=t.length;for(n=0;n<E;n++){if(d=t[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[d.type]&&(R=this.options.extensions.renderers[d.type].call({parser:this},d),R!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(d.type))){a+=R||"";continue}switch(d.type){case"space":continue;case"hr":{a+=this.renderer.hr();continue}case"heading":{a+=this.renderer.heading(this.parseInline(d.tokens),d.depth,lh(this.parseInline(d.tokens,this.textRenderer)),this.slugger);continue}case"code":{a+=this.renderer.code(d.text,d.lang,d.escaped);continue}case"table":{for(h="",f="",c=d.header.length,s=0;s<c;s++)f+=this.renderer.tablecell(this.parseInline(d.header[s].tokens),{header:!0,align:d.align[s]});for(h+=this.renderer.tablerow(f),u="",c=d.rows.length,s=0;s<c;s++){for(l=d.rows[s],f="",o=l.length,i=0;i<o;i++)f+=this.renderer.tablecell(this.parseInline(l[i].tokens),{header:!1,align:d.align[i]});u+=this.renderer.tablerow(f)}a+=this.renderer.table(h,u);continue}case"blockquote":{u=this.parse(d.tokens),a+=this.renderer.blockquote(u);continue}case"list":{for(p=d.ordered,x=d.start,m=d.loose,c=d.items.length,u="",s=0;s<c;s++)_=d.items[s],v=_.checked,C=_.task,w="",_.task&&(O=this.renderer.checkbox(v),m?_.tokens.length>0&&_.tokens[0].type==="paragraph"?(_.tokens[0].text=O+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&_.tokens[0].tokens[0].type==="text"&&(_.tokens[0].tokens[0].text=O+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",text:O}):w+=O),w+=this.parse(_.tokens,m),u+=this.renderer.listitem(w,C,v);a+=this.renderer.list(u,p,x);continue}case"html":{a+=this.renderer.html(d.text,d.block);continue}case"paragraph":{a+=this.renderer.paragraph(this.parseInline(d.tokens));continue}case"text":{for(u=d.tokens?this.parseInline(d.tokens):d.text;n+1<E&&t[n+1].type==="text";)d=t[++n],u+=`
`+(d.tokens?this.parseInline(d.tokens):d.text);a+=r?this.renderer.paragraph(u):u;continue}default:{const M='Token with "'+d.type+'" type was not found.';if(this.options.silent){console.error(M);return}else throw new Error(M)}}}return a}parseInline(t,r){r=r||this.renderer;let a="",n,s,i;const c=t.length;for(n=0;n<c;n++){if(s=t[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]&&(i=this.options.extensions.renderers[s.type].call({parser:this},s),i!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type))){a+=i||"";continue}switch(s.type){case"escape":{a+=r.text(s.text);break}case"html":{a+=r.html(s.text);break}case"link":{a+=r.link(s.href,s.title,this.parseInline(s.tokens,r));break}case"image":{a+=r.image(s.href,s.title,s.text);break}case"strong":{a+=r.strong(this.parseInline(s.tokens,r));break}case"em":{a+=r.em(this.parseInline(s.tokens,r));break}case"codespan":{a+=r.codespan(s.text);break}case"br":{a+=r.br();break}case"del":{a+=r.del(this.parseInline(s.tokens,r));break}case"text":{a+=r.text(s.text);break}default:{const o='Token with "'+s.type+'" type was not found.';if(this.options.silent){console.error(o);return}else throw new Error(o)}}}return a}}class Vn{constructor(t){this.options=t||xa}preprocess(t){return t}postprocess(t){return t}}jr(Vn,"passThroughHooks",new Set(["preprocess","postprocess"]));var Ia,x0,fh;class _k{constructor(...t){_c(this,Ia);jr(this,"defaults",mc());jr(this,"options",this.setOptions);jr(this,"parse",ms(this,Ia,x0).call(this,bt.lex,Bt.parse));jr(this,"parseInline",ms(this,Ia,x0).call(this,bt.lexInline,Bt.parseInline));jr(this,"Parser",Bt);jr(this,"parser",Bt.parse);jr(this,"Renderer",ci);jr(this,"TextRenderer",gc);jr(this,"Lexer",bt);jr(this,"lexer",bt.lex);jr(this,"Tokenizer",ii);jr(this,"Slugger",es);jr(this,"Hooks",Vn);this.use(...t)}walkTokens(t,r){let a=[];for(const n of t)switch(a=a.concat(r.call(this,n)),n.type){case"table":{for(const s of n.header)a=a.concat(this.walkTokens(s.tokens,r));for(const s of n.rows)for(const i of s)a=a.concat(this.walkTokens(i.tokens,r));break}case"list":{a=a.concat(this.walkTokens(n.items,r));break}default:this.defaults.extensions&&this.defaults.extensions.childTokens&&this.defaults.extensions.childTokens[n.type]?this.defaults.extensions.childTokens[n.type].forEach(s=>{a=a.concat(this.walkTokens(n[s],r))}):n.tokens&&(a=a.concat(this.walkTokens(n.tokens,r)))}return a}use(...t){const r=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(a=>{const n={...a};if(n.async=this.defaults.async||n.async||!1,a.extensions&&(a.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if(s.renderer){const i=r.renderers[s.name];i?r.renderers[s.name]=function(...c){let o=s.renderer.apply(this,c);return o===!1&&(o=i.apply(this,c)),o}:r.renderers[s.name]=s.renderer}if(s.tokenizer){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");r[s.level]?r[s.level].unshift(s.tokenizer):r[s.level]=[s.tokenizer],s.start&&(s.level==="block"?r.startBlock?r.startBlock.push(s.start):r.startBlock=[s.start]:s.level==="inline"&&(r.startInline?r.startInline.push(s.start):r.startInline=[s.start]))}s.childTokens&&(r.childTokens[s.name]=s.childTokens)}),n.extensions=r),a.renderer){const s=this.defaults.renderer||new ci(this.defaults);for(const i in a.renderer){const c=s[i];s[i]=(...o)=>{let l=a.renderer[i].apply(s,o);return l===!1&&(l=c.apply(s,o)),l}}n.renderer=s}if(a.tokenizer){const s=this.defaults.tokenizer||new ii(this.defaults);for(const i in a.tokenizer){const c=s[i];s[i]=(...o)=>{let l=a.tokenizer[i].apply(s,o);return l===!1&&(l=c.apply(s,o)),l}}n.tokenizer=s}if(a.hooks){const s=this.defaults.hooks||new Vn;for(const i in a.hooks){const c=s[i];Vn.passThroughHooks.has(i)?s[i]=o=>{if(this.defaults.async)return Promise.resolve(a.hooks[i].call(s,o)).then(f=>c.call(s,f));const l=a.hooks[i].call(s,o);return c.call(s,l)}:s[i]=(...o)=>{let l=a.hooks[i].apply(s,o);return l===!1&&(l=c.apply(s,o)),l}}n.hooks=s}if(a.walkTokens){const s=this.defaults.walkTokens;n.walkTokens=function(i){let c=[];return c.push(a.walkTokens.call(this,i)),s&&(c=c.concat(s.call(this,i))),c}}this.defaults={...this.defaults,...n}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}}Ia=new WeakSet,x0=function(t,r){return(a,n,s)=>{typeof n=="function"&&(s=n,n=null);const i={...n};n={...this.defaults,...i};const c=ms(this,Ia,fh).call(this,n.silent,n.async,s);if(typeof a>"u"||a===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof a!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(a)+", string expected"));if(mk(n,s),n.hooks&&(n.hooks.options=n),s){const o=n.highlight;let l;try{n.hooks&&(a=n.hooks.preprocess(a)),l=t(a,n)}catch(u){return c(u)}const f=u=>{let d;if(!u)try{n.walkTokens&&this.walkTokens(l,n.walkTokens),d=r(l,n),n.hooks&&(d=n.hooks.postprocess(d))}catch(p){u=p}return n.highlight=o,u?c(u):s(null,d)};if(!o||o.length<3||(delete n.highlight,!l.length))return f();let h=0;this.walkTokens(l,u=>{u.type==="code"&&(h++,setTimeout(()=>{o(u.text,u.lang,(d,p)=>{if(d)return f(d);p!=null&&p!==u.text&&(u.text=p,u.escaped=!0),h--,h===0&&f()})},0))}),h===0&&f();return}if(n.async)return Promise.resolve(n.hooks?n.hooks.preprocess(a):a).then(o=>t(o,n)).then(o=>n.walkTokens?Promise.all(this.walkTokens(o,n.walkTokens)).then(()=>o):o).then(o=>r(o,n)).then(o=>n.hooks?n.hooks.postprocess(o):o).catch(c);try{n.hooks&&(a=n.hooks.preprocess(a));const o=t(a,n);n.walkTokens&&this.walkTokens(o,n.walkTokens);let l=r(o,n);return n.hooks&&(l=n.hooks.postprocess(l)),l}catch(o){return c(o)}}},fh=function(t,r,a){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const s="<p>An error occurred:</p><pre>"+Br(n.message+"",!0)+"</pre>";if(r)return Promise.resolve(s);if(a){a(null,s);return}return s}if(r)return Promise.reject(n);if(a){a(n);return}throw n}};const Ra=new _k(xa);function Xe(e,t,r){return Ra.parse(e,t,r)}Xe.options=Xe.setOptions=function(e){return Ra.setOptions(e),Xe.defaults=Ra.defaults,ih(Xe.defaults),Xe};Xe.getDefaults=mc;Xe.defaults=xa;Xe.use=function(...e){return Ra.use(...e),Xe.defaults=Ra.defaults,ih(Xe.defaults),Xe};Xe.walkTokens=function(e,t){return Ra.walkTokens(e,t)};Xe.parseInline=Ra.parseInline;Xe.Parser=Bt;Xe.parser=Bt.parse;Xe.Renderer=ci;Xe.TextRenderer=gc;Xe.Lexer=bt;Xe.lexer=bt.lex;Xe.Tokenizer=ii;Xe.Slugger=es;Xe.Hooks=Vn;Xe.parse=Xe;Xe.options;Xe.setOptions;Xe.use;Xe.walkTokens;Xe.parseInline;Bt.parse;bt.lex;const uh={};var wk=Oe("<h1><!></h1>"),kk=Oe("<h2><!></h2>"),Ek=Oe("<h3><!></h3>"),Tk=Oe("<h4><!></h4>"),yk=Oe("<h5><!></h5>"),Ak=Oe("<h6><!></h6>");function Sk(e,t){ts(t,!1);const r=kr();let a=ze(t,"depth",8),n=ze(t,"raw",8),s=ze(t,"text",8);const{slug:i,getOptions:c}=$h(uh),o=c();Kt(()=>ga(s()),()=>{Ge(r,o.headerIds?o.headerPrefix+i(s()):void 0)}),v0(),rs();var l=De(),f=Fe(l);{var h=d=>{var p=wk(),x=xe(p);ir(x,t,"default",{}),fe(p),Je(()=>br(p,"id",j(r))),ne(d,p)},u=d=>{var p=De(),x=Fe(p);{var m=_=>{var v=kk(),C=xe(v);ir(C,t,"default",{}),fe(v),Je(()=>br(v,"id",j(r))),ne(_,v)},w=_=>{var v=De(),C=Fe(v);{var O=E=>{var M=Ek(),I=xe(M);ir(I,t,"default",{}),fe(M),Je(()=>br(M,"id",j(r))),ne(E,M)},R=E=>{var M=De(),I=Fe(M);{var W=N=>{var J=Tk(),le=xe(J);ir(le,t,"default",{}),fe(J),Je(()=>br(J,"id",j(r))),ne(N,J)},L=N=>{var J=De(),le=Fe(J);{var Z=Q=>{var ye=yk(),U=xe(ye);ir(U,t,"default",{}),fe(ye),Je(()=>br(ye,"id",j(r))),ne(Q,ye)},oe=Q=>{var ye=De(),U=Fe(ye);{var ve=F=>{var B=Ak(),P=xe(B);ir(P,t,"default",{}),fe(B),Je(()=>br(B,"id",j(r))),ne(F,B)},ge=F=>{var B=sl();Je(()=>Et(B,n())),ne(F,B)};xr(U,F=>{a()===6?F(ve):F(ge,!1)},!0)}ne(Q,ye)};xr(le,Q=>{a()===5?Q(Z):Q(oe,!1)},!0)}ne(N,J)};xr(I,N=>{a()===4?N(W):N(L,!1)},!0)}ne(E,M)};xr(C,E=>{a()===3?E(O):E(R,!1)},!0)}ne(_,v)};xr(x,_=>{a()===2?_(m):_(w,!1)},!0)}ne(d,p)};xr(f,d=>{a()===1?d(h):d(u,!1)})}ne(e,l),as()}var Fk=Oe("<p><!></p>");function bk(e,t){var r=Fk(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}function Ck(e,t){ze(t,"text",8)(),ze(t,"raw",8)();var n=De(),s=Fe(n);ir(s,t,"default",{}),ne(e,n)}var Rk=Oe("<img>");function Ik(e,t){let r=ze(t,"href",8,""),a=ze(t,"title",8,void 0),n=ze(t,"text",8,"");var s=Rk();Je(()=>{br(s,"src",r()),br(s,"title",a()),br(s,"alt",n())}),ne(e,s)}var Ok=Oe("<a><!></a>");function Dk(e,t){let r=ze(t,"href",8,""),a=ze(t,"title",8,void 0);var n=Ok(),s=xe(n);ir(s,t,"default",{}),fe(n),Je(()=>{br(n,"href",r()),br(n,"title",a())}),ne(e,n)}var Pk=Oe("<em><!></em>");function Nk(e,t){var r=Pk(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var Mk=Oe("<del><!></del>");function Lk(e,t){var r=Mk(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var Bk=Oe("<code> </code>");function Uk(e,t){ts(t,!1);let r=ze(t,"raw",8);rs();var a=Bk(),n=xe(a,!0);Je(()=>Et(n,r().replace(/`/g,""))),fe(a),ne(e,a),as()}var $k=Oe("<strong><!></strong>");function Hk(e,t){var r=$k(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var Wk=Oe("<table><!></table>");function Vk(e,t){var r=Wk(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var Gk=Oe("<thead><!></thead>");function zk(e,t){var r=Gk(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var Xk=Oe("<tbody><!></tbody>");function jk(e,t){var r=Xk(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var Kk=Oe("<tr><!></tr>");function Yk(e,t){var r=Kk(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var Jk=Oe("<th><!></th>"),qk=Oe("<td><!></td>");function Zk(e,t){let r=ze(t,"header",8),a=ze(t,"align",8);var n=De(),s=Fe(n);{var i=o=>{var l=Jk(),f=xe(l);ir(f,t,"default",{}),fe(l),Je(()=>br(l,"align",a())),ne(o,l)},c=o=>{var l=qk(),f=xe(l);ir(f,t,"default",{}),fe(l),Je(()=>br(l,"align",a())),ne(o,l)};xr(s,o=>{r()?o(i):o(c,!1)})}ne(e,n)}var Qk=Oe("<ol><!></ol>"),eE=Oe("<ul><!></ul>");function rE(e,t){let r=ze(t,"ordered",8),a=ze(t,"start",8);var n=De(),s=Fe(n);{var i=o=>{var l=Qk(),f=xe(l);ir(f,t,"default",{}),fe(l),Je(()=>br(l,"start",a())),ne(o,l)},c=o=>{var l=eE(),f=xe(l);ir(f,t,"default",{}),fe(l),ne(o,l)};xr(s,o=>{r()?o(i):o(c,!1)})}ne(e,n)}var tE=Oe("<li><!></li>");function aE(e,t){var r=tE(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var nE=Oe("<hr>");function sE(e){var t=nE();ne(e,t)}function iE(e,t){let r=ze(t,"text",8);var a=De(),n=Fe(a);Kh(n,r),ne(e,a)}var cE=Oe("<blockquote><!></blockquote>");function oE(e,t){var r=cE(),a=xe(r);ir(a,t,"default",{}),fe(r),ne(e,r)}var lE=Oe("<pre><code> </code></pre>");function fE(e,t){let r=ze(t,"lang",8),a=ze(t,"text",8);var n=lE(),s=xe(n),i=xe(s,!0);fe(s),fe(n),Je(()=>{Jh(n,r()),Et(i,a())}),ne(e,n)}var uE=Oe("<br><!>",1);function hE(e,t){var r=uE(),a=be(Fe(r));ir(a,t,"default",{}),ne(e,r)}const dE={heading:Sk,paragraph:bk,text:Ck,image:Ik,link:Dk,em:Nk,strong:Hk,codespan:Uk,del:Lk,table:Vk,tablehead:zk,tablebody:jk,tablerow:Yk,tablecell:Zk,list:rE,orderedlistitem:null,unorderedlistitem:null,listitem:aE,hr:sE,html:iE,blockquote:oE,code:fE,br:hE},xE={baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,xhtml:!1};function nl(e,t){ts(t,!1);const r=kr(),a=kr(),n=kr(),s=kr();let i=ze(t,"source",24,()=>[]),c=ze(t,"renderers",24,()=>({})),o=ze(t,"options",24,()=>({})),l=ze(t,"isInline",8,!1);const f=Gh();let h=kr(),u=kr(),d=kr();Hh(uh,{slug:p=>j(a)?j(a).slug(p):"",getOptions:()=>j(n)}),_0(()=>{Ge(d,!0)}),Kt(()=>ga(i()),()=>{Ge(r,Array.isArray(i()))}),Kt(()=>(ga(i()),es),()=>{Ge(a,i()?new es:void 0)}),Kt(()=>ga(o()),()=>{Ge(n,{...xE,...o()})}),Kt(()=>(j(r),j(h),ga(i()),j(u),j(n),ga(l())),()=>{j(r)?Ge(h,i()):(Ge(u,new bt(j(n))),Ge(h,l()?j(u).inlineTokens(i()):j(u).lex(i())),f("parsed",{tokens:j(h)}))}),Kt(()=>ga(c()),()=>{Ge(s,{...dE,...c()})}),Kt(()=>(j(d),j(r),j(h)),()=>{j(d)&&!j(r)&&f("parsed",{tokens:j(h)})}),v0(),rs(),va(e,{get tokens(){return j(h)},get renderers(){return j(s)}}),as()}var pE=Oe("<option> </option>"),mE=Oe("<option> </option>"),gE=Oe('<th style="min-width: 320px;"> </th>'),vE=Oe('<th style="min-width: 320px;"> </th> <!>',1),_E=Oe("<td><!></td>"),wE=Oe("<td><!></td> <!>",1),kE=Oe("<tr></tr>"),EE=Oe('<div class="form-group mt-2"><label for="jobSelect">Compare with</label> <select id="jobSelect" class="form-control"><option selected>Select a previous version to compare with</option><!></select></div> <div class="table-responsive"><table class="table table-striped mt-4 svelte-19egix3"><thead><tr></tr></thead><tbody></tbody></table></div> <div class="mt-4"><button class="btn btn-primary svelte-19egix3">Feedback</button></div>',1),TE=Oe("<option> </option>"),yE=Oe('<div class="form-group mb-3"><label> </label> <select class="form-control"><option>Select a column</option><!></select></div>'),AE=Oe("<option> </option>"),SE=Oe('<div class="modal show" tabindex="-1" style="display: block;"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">New Job</h5> <button type="button" class="btn-close"></button></div> <div class="modal-body"><form><div class="form-group mb-3"><label for="fileInput">File</label> <input type="file" id="fileInput" class="form-control" accept=".csv, .xlsx"></div> <div class="form-group mb-3"><label for="nameInput">Name</label> <input type="text" id="nameInput" class="form-control"></div> <div class="form-group mb-3"><label for="headersInput">Headers</label> <input type="text" id="headersInput" class="form-control"></div> <div class="card mb-3"><div class="card-body"><h6 class="card-title">Header Mappings</h6> <!></div></div> <div class="form-group mb-3"><label for="promptInput">Prompt</label> <textarea id="promptInput" class="form-control" rows="20"></textarea></div> <div class="form-group mb-3"><label for="retailerRulesSelect">Retailer Rules</label> <select id="retailerRulesSelect" class="form-control"><option selecteed="">Select a Retailer Rule...</option><!></select></div> <div class="form-group mb-3"><label for="keywordsInput">Keywords</label> <input type="text" id="keywordsInput" class="form-control"></div> <div class="form-group mb-3"><label for="excludedWordsInput">Excluded Words</label> <input type="text" id="excludedWordsInput" class="form-control"></div></form></div> <div class="modal-footer"><button type="button" class="btn btn-primary svelte-19egix3">Run</button> <button type="button" class="btn btn-secondary">Close</button></div></div></div></div>'),FE=Oe('<div class="modal show" tabindex="-1" style="display: block;"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Send Feedback</h5> <button type="button" class="btn-close"></button></div> <div class="modal-body"><div class="form-group mb-3"><label for="feedbackInput">Feedback</label> <textarea id="feedbackInput" class="form-control" rows="8"></textarea></div></div> <div class="modal-footer"><button type="button" class="btn btn-primary svelte-19egix3">Submit</button> <button type="button" class="btn btn-secondary">Close</button></div></div></div></div>'),bE=Oe('<div class="container my-5"><h1>Product Description Generator V2</h1> <div class="mt-3 mb-3"><button class="btn btn-primary svelte-19egix3">New Job</button></div> <div class="form-group"><label for="jobSelect">Jobs</label> <select id="jobSelect" class="form-control"><option selected>Select a job</option><!></select></div> <!> <!> <!> <!></div>');function GE(e,t){ts(t,!1);const r=kr(),a=kr(),n=new Ue({apiKey:"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",dangerouslyAllowBrowser:!0}),s=`Optimize the following table of product descriptions:

%InputFileTable%

The list of optimized product descriptions must be in form of a table with the following headers: %Headers%.
The product code must be exactly the same as in the "SKU (or Item / Product ID number)" header in the original table of product descriptions.
The product description in the new table must be in the same order.

Your output must only contain the optimized table of product descriptions. Optimize the product description for the following retailer rules:

%RetailerRules%

In the optimized product descriptions, maximise the use of the following keywords: %Keywords%
In the optimized product descriptions, add bold style to keywords.

In the optimized product descriptions, exclude the following words: %ExcludedWords%`,i=[{id:1,name:"AMZ-Guidelines-Moen",promptPart:`Title:
Formula: Brand, Model #, Model Name (Collection), Item Type Name, *Size, *Color, Unit Count, Unit Type 
Example: Moen S73104BL Weymouth One Handle Pre-Rinse Spring Pulldown Kitchen Faucet with Power Boost, Matte Black
Details:
- Keep the product name within 200 characters including spaces.
- Use Title Case to capitalize the first letter of each word (if in English). Convert all words in upper case to lower case.
- Remove duplicate information.
- Use numerals instead of spelling out numbers.
- Add specific information such as the brand, color, and size, especially to any child variations
- Write titles in accordance to ATS's predefined title rule
Prohibited:
- Characters and extra punctuation characters, such as ™~ ! * $ ? _ ~ { } # < > | * ; ^ Æ © ®
- Restricted phrases such as 100% Genuine, Premium Quality, Free 2-Day Shipping
- Unnecessary synonyms, search keywords, or irrelevant keywords that are not related to the product
Disabled

Product Description:
- Min 150 words. 
- Max 200 words.
- Strive to reach the upper max word limit to make the description longer.
- Write in complete sentences and use a full stop at the end
- Use sentence case: Capital letters are only used at the start of a sentence (except for acronyms, such as HDMI, BMX, or USB, which are uppercase)
Prohibited:
- Avoid special characters such as ™, ®, €, …, †, ‡, o, ¢, £, ¥, ©, ±, ~, â, which are not allowed
- Do not include an ASIN number or use "not applicable" or "NA" or "n/a"
- Do not have any spelling or grammatical errors
- Do not use prohibited phrases such as eco-friendly, environmentally friendly, ecologically friendly, anti-microbial, anti-bacterial, Made from Bamboo, contains Bamboo, Made from Soy or contains Soy
- Do not include Amazon.com (or any other extension such as .co.uk or .de) or Amazon
- Don't use prohibited guarantee information such as “Full refund” or “If not satisfied, send it back” or “Unconditional guarantee with no limit”
- Do not include any information related to the cost or price of the product
- Do not include any information related to the company of the vendor
- Do not include any website links

Bullets:
Formula: HEADLINE: Sentence
Example: BOOSTED STREAM: Moen's exclusive Power Boost technology offers a faster clean and faster fill with the push of a button
Details:
- Keep the new bullet list items in the same order as the original product description.
- Begin with a capital letter
- Format bullets as a sentence fragment
- Use a semicolon (;) to separate phrases within a single bullet point
- Use a minimum of 10 characters per bullet and maximum of 255 characters per bullet
- Write numbers one through nine in full, excluding names, model numbers, and measurements
- Add a header, ending with a colon (:)
- Include a space between a digit and a measurement, for example, 60 ml (not 60ml)
- Use clear, natural language; avoid adding unnecessary keywords or phrases
- Highlight product features and benefits; avoid marketing copy
- Highlight how the product meets the customer needs
- Maintain data consistency across product variants
Prohibited
- Special characters such as ™, ®, €, …, †, ‡, o, ¢, £, ¥, ©, ±, ~, â
- Emojis
- ASIN number, "not applicable", "NA", "n/a", "N/A", "not eligible", "yet to decide", "to be decided", "TBD", or "COPY PENDING"
- Prohibited phrases such as "eco-friendly", "environmentally friendly", "ecologically friendly", "anti-microbial", "anti-bacterial", "made from bamboo", "contains bamboo", "made from Soy", or "contains Soy". For more information, go to Prohibited Product Claims
- Prohibited guarantee information such as "Full refund", "If not satisfied, send it back", or "Unconditional guarantee with no limit"
- Company information, website links, external hyperlinks, or contact information
- Do not repeat content; Each bullet point should mention unique product information
- Do not use end punctuation
- Comparison to competitor brands
- Subjective, performance, or comparative claims, unless they are verifiable on the product packaging
- Claims relating to accolades and awards, unless the product detail page contains supporting details, such as date and awarding body
- Claims about the results of consumer surveys, even if the survey collected subjective opinions, unless substantiated with the source and date`}];let c=kr([]),o=kr(""),l=kr(""),f=kr(!1),h=kr(!1),u=kr({file:null,name:"",headers:"",headerMappings:{},prompt:"",retailerRules:"",keywords:"",excludedWords:""}),d=kr(""),p=kr(!1),x=kr([]),m=[];_0(()=>{const H=localStorage.getItem("jobs");H&&(Ge(c,JSON.parse(H)),console.log(j(c)))});function w(){Ge(p,!0)}function _(){Ge(p,!1)}function v(H){if(!Array.isArray(H)||H.length===0)throw new Error("Input must be a non-empty array of arrays.");const se=H[0],y=H.slice(1),_e=`| ${se.join(" | ")} |`,he=y.map(me=>`| ${me.map(q=>`"${q}"`).join(" | ")} |`);return[_e,...he].join(`
`)}function C(H){if(typeof H!="string"||H.trim()==="")throw new Error("Input must be a non-empty string.");const se=H.trim().split(`
`);console.log("lines:"),console.log(se);let y=-1,_e=-1;for(let q=0;q<se.length;q++){const Se=se[q].trim();Se.startsWith("|")&&Se.endsWith("|")&&(y==-1&&(y=q),_e=q)}if(console.log("tableStart:"),console.log(y),console.log("tableEnd:"),console.log(_e),y===-1||_e===-1)throw new Error("No valid markdown table found.");const he=se.slice(y,_e),we=[he[0],...he.slice(2)];function me(q){const Se=[];let He="",Pe=!1;q=q.trim(),q.startsWith("|")&&(q=q.slice(1)),q.endsWith("|")&&(q=q.slice(0,-1));for(let Ke=0;Ke<q.length;Ke++){const cr=q[Ke];cr==='"'&&(Ke===0||q[Ke-1]!=="\\")?Pe=!Pe:cr==="|"&&!Pe?(Se.push(He.trim()),He=""):He+=cr}return Se.push(He.trim()),Se}return we.map(me)}function O(){I(),Ge(f,!0)}function R(){I(),Ge(f,!1)}function E(){Ge(h,!0)}function M(){Ge(h,!1)}function I(){Ge(u,{file:null,name:"",headers:"Product_Code, Product_Name, Long_Product_Copy, Extended_Bullet_1, Extended_Bullet_2, Extended_Bullet_3, Extended_Bullet_4, Extended_Bullet_5",headerMappings:{},prompt:s,retailerRules:"",keywords:"sensitive stomachs, reduce colic, reduce spit up, fussiness, gassy, soy baby formula, cows milk allergy, lactose free, hypoallergenic, plant-based, lactose intolerance, Mederma, scar, scars, scar gel, acne, scar treatment, surgery, wound, whitening products, holidays, whitening, whitening pen, whitening kit, holiday smile, whiter teeth, whiter smile",excludedWords:"prevents, cures, organic, whitening strips"}),W(),j(u).headerMappings.find(H=>H.header==="Product_Code").value=0,j(u).headerMappings.find(H=>H.header==="Product_Name").value=1,j(u).headerMappings.find(H=>H.header==="Long_Product_Copy").value=2,j(u).headerMappings.find(H=>H.header==="Extended_Bullet_1").value=5,j(u).headerMappings.find(H=>H.header==="Extended_Bullet_2").value=6,j(u).headerMappings.find(H=>H.header==="Extended_Bullet_3").value=7,j(u).headerMappings.find(H=>H.header==="Extended_Bullet_4").value=8,j(u).headerMappings.find(H=>H.header==="Extended_Bullet_5").value=9,Ge(u,j(u))}function W(){It(u,j(u).headerMappings=j(u).headers.split(",").map(H=>({header:H.trim(),value:""})))}function L(){const H=new Date,se=H.getFullYear(),y=String(H.getMonth()+1).padStart(2,"0"),_e=String(H.getDate()).padStart(2,"0"),he=String(H.getHours()).padStart(2,"0"),we=String(H.getMinutes()).padStart(2,"0"),me=String(H.getSeconds()).padStart(2,"0");return`${se}-${y}-${_e} ${he}:${we}:${me}`}function N(H){return H.toLowerCase().replace(/[\s\W]+/g,"_")}async function J(){w();const H=j(u).retailerRules,se=i.filter(Pe=>Pe.id===H)[0],y=j(u).headers.split(",").map(Pe=>Pe.trim()),_e=[y,...m.map(Pe=>y.map(Ke=>{console.log(`tableHeader: ${Ke}`);const cr=j(u).headerMappings.find(Qe=>(console.log(Qe),Qe.header===Ke));return console.log("----"),console.log(cr),Pe[cr.value]}))];console.log("originalTableData:"),console.log(_e);const he=v(_e);let we=j(u).prompt;we=we.replaceAll("%InputFileTable%",he).replaceAll("%Headers%",y.map(Pe=>`"${Pe}"`).join(", ")).replaceAll("%RetailerRules%",se?se.promptPart:"").replaceAll("%Keywords%",j(u).keywords).replaceAll("%ExcludedWords%",j(u).excludedWords),console.log("fullPrompt:"),console.log(we);let me=[{role:"user",content:we}];const q=await n.chat.completions.create({messages:me,model:"gpt-4o"});me.push(q.choices[0].message);const Se=q.choices[0].message.content,He=C(Se);j(c).push({name:j(u).name.split(".")[0],formData:j(u),fullPrompt:we,tableData:He,messageHistory:me,tableHistory:[{name:"Original",string:he,tableData:_e}]}),Ge(c,j(c)),Ge(o,j(c).length-1),localStorage.setItem("jobs",JSON.stringify(j(c))),R(),_()}async function le(){w();let H=j(c)[j(o)].messageHistory,se=j(d);console.log("fullPrompt:"),console.log(se),H.push({role:"user",content:se});const _e=(await n.chat.completions.create({messages:H,model:"gpt-4o"})).choices[0].message.content,he=C(_e);It(c,j(c)[j(o)].messageHistory=H),j(c)[j(o)].tableHistory.push({name:L(),string:v(j(c)[j(o)].tableData),tableData:j(c)[j(o)].tableData}),It(c,j(c)[j(o)].tableData=he),Ge(c,j(c)),localStorage.setItem("jobs",JSON.stringify(j(c))),M(),_()}function Z(H){const se=H.target.files[0];if(!se)return;const y=new FileReader;y.onload=function(_e){const he=_e.target.result;if(It(u,j(u).name=se.name),Ge(x,[]),m=[],se.type==="text/csv")m=he.split(`
`).map(we=>we.split(",")),Ge(x,m[0]),m.shift();else if(se.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){const we=Qi(he,{type:"binary"}),me=we.SheetNames[0],q=we.Sheets[me];m=rw.sheet_to_json(q,{header:1}).filter(Se=>Se.length>0),Ge(x,m[0]),m.shift()}},se.type==="text/csv"?y.readAsText(se):se.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&y.readAsBinaryString(se)}Kt(()=>(j(o),j(c)),()=>{Ge(r,j(o)!==""?j(c)[j(o)]:null)}),Kt(()=>(j(o),j(l),j(c)),()=>{Ge(a,j(o)!==""&&j(l)!==""?j(c)[j(o)].tableHistory[j(l)].tableData:null)}),v0(),rs();var oe=bE(),Q=be(xe(oe),2),ye=xe(Q);fe(Q);var U=be(Q,2),ve=be(xe(U),2);Je(()=>{j(o),wn(()=>{j(c)})});var ge=xe(ve);ge.value=((ge.__value="")==null,"");var F=be(ge);at(F,1,()=>j(c),tt,(H,se,y)=>{var _e=pE();_e.value=(_e.__value=y)==null?"":y;var he=xe(_e,!0);fe(_e),Je(()=>Et(he,j(se).name)),ne(H,_e)}),fe(ve),fe(U);var B=be(U,2);{var P=H=>{var se=EE(),y=Fe(se),_e=be(xe(y),2);Je(()=>{j(l),wn(()=>{j(r)})});var he=xe(_e);he.value=((he.__value="")==null,"");var we=be(he);at(we,1,()=>j(r).tableHistory,tt,(Qe,qe,hr)=>{var tr=mE();tr.value=(tr.__value=hr)==null?"":hr;var zr=xe(tr,!0);fe(tr),Je(()=>Et(zr,j(qe).name)),ne(Qe,tr)}),fe(_e),fe(y);var me=be(y,2),q=xe(me),Se=xe(q),He=xe(Se);at(He,5,()=>j(r).tableData[0],tt,(Qe,qe)=>{var hr=vE(),tr=Fe(hr),zr=xe(tr,!0);fe(tr);var or=be(tr,2);{var pr=Te=>{var We=gE(),Ar=xe(We);fe(We),Je(()=>Et(Ar,`Original_${j(qe)??""}`)),ne(Te,We)};xr(or,Te=>{j(a)&&Te(pr)})}Je(()=>Et(zr,j(qe))),ne(Qe,hr)}),fe(He),fe(Se);var Pe=be(Se);at(Pe,5,()=>j(r).tableData,tt,(Qe,qe,hr)=>{var tr=De(),zr=Fe(tr);{var or=pr=>{var Te=kE();at(Te,5,()=>j(qe),tt,(We,Ar,er)=>{var st=wE(),Wt=Fe(st),Ua=xe(Wt);nl(Ua,{get source(){return j(Ar)}}),fe(Wt);var $a=be(Wt,2);{var pa=ea=>{var lr=_E(),Xr=xe(lr);nl(Xr,{get source(){return j(a)[hr][er]}}),fe(lr),ne(ea,lr)};xr($a,ea=>{j(a)&&ea(pa)})}ne(We,st)}),fe(Te),ne(pr,Te)};xr(zr,pr=>{hr>0&&pr(or)})}ne(Qe,tr)}),fe(Pe),fe(q),fe(me);var Ke=be(me,2),cr=xe(Ke);cr.disabled=!1,fe(Ke),vs(_e,()=>j(l),Qe=>Ge(l,Qe)),zt("click",cr,E),ne(H,se)};xr(B,H=>{j(r)&&H(P)})}var D=be(B,2);{var Y=H=>{var se=SE(),y=xe(se),_e=xe(y),he=xe(_e),we=be(xe(he),2);fe(he);var me=be(he,2),q=xe(me),Se=xe(q),He=be(xe(Se),2);fe(Se);var Pe=be(Se,2),Ke=be(xe(Pe),2);gs(Ke),fe(Pe);var cr=be(Pe,2),Qe=be(xe(cr),2);gs(Qe),fe(cr);var qe=be(cr,2),hr=xe(qe),tr=be(xe(hr),2);at(tr,1,()=>j(u).headerMappings,tt,(lr,Xr,ra)=>{var gt=yE(),ta=xe(gt);Je(()=>br(ta,"for",`headersInput_${N(j(Xr).header)}`));var mi=xe(ta,!0);fe(ta);var Ha=be(ta,2);Je(()=>{j(Xr),wn(()=>{j(x)})}),Je(()=>br(Ha,"id",`headersInput_${N(j(Xr).header)}`));var pn=xe(Ha);pn.value=((pn.__value="")==null,"");var gi=be(pn);at(gi,1,()=>j(x),tt,(mn,vi,ps)=>{var Vt=TE();Vt.value=(Vt.__value=ps)==null?"":ps;var _i=xe(Vt,!0);fe(Vt),Je(()=>Et(_i,j(vi))),ne(mn,Vt)}),fe(Ha),fe(gt),Je(()=>Et(mi,j(Xr).header)),vs(Ha,()=>j(Xr).value,mn=>(j(Xr).value=mn,wn(()=>j(u).headerMappings))),ne(lr,gt)}),fe(hr),fe(qe);var zr=be(qe,2),or=be(xe(zr),2);Sc(or),fe(zr);var pr=be(zr,2),Te=be(xe(pr),2);Je(()=>{j(u),wn(()=>{})});var We=xe(Te);We.value=((We.__value="")==null,"");var Ar=be(We);at(Ar,1,()=>i,tt,(lr,Xr)=>{var ra=AE(),gt={},ta=xe(ra,!0);fe(ra),Je(()=>{gt!==(gt=j(Xr).id)&&(ra.value=(ra.__value=j(Xr).id)==null?"":j(Xr).id),Et(ta,j(Xr).name)}),ne(lr,ra)}),fe(Te),fe(pr);var er=be(pr,2),st=be(xe(er),2);gs(st),fe(er);var Wt=be(er,2),Ua=be(xe(Wt),2);gs(Ua),fe(Wt),fe(q),fe(me);var $a=be(me,2),pa=xe($a),ea=be(pa,2);fe($a),fe(_e),fe(y),fe(se),zt("click",we,R),zt("change",He,Z),Va(Ke,()=>j(u).name,lr=>It(u,j(u).name=lr)),Va(Qe,()=>j(u).headers,lr=>It(u,j(u).headers=lr)),Va(or,()=>j(u).prompt,lr=>It(u,j(u).prompt=lr)),vs(Te,()=>j(u).retailerRules,lr=>It(u,j(u).retailerRules=lr)),Va(st,()=>j(u).keywords,lr=>It(u,j(u).keywords=lr)),Va(Ua,()=>j(u).excludedWords,lr=>It(u,j(u).excludedWords=lr)),zt("click",pa,J),zt("click",ea,R),ne(H,se)};xr(D,H=>{j(f)&&H(Y)})}var re=be(D,2);{var ie=H=>{var se=FE(),y=xe(se),_e=xe(y),he=xe(_e),we=be(xe(he),2);fe(he);var me=be(he,2),q=xe(me),Se=be(xe(q),2);Sc(Se),fe(q),fe(me);var He=be(me,2),Pe=xe(He),Ke=be(Pe,2);fe(He),fe(_e),fe(y),fe(se),zt("click",we,M),Va(Se,()=>j(d),cr=>Ge(d,cr)),zt("click",Pe,le),zt("click",Ke,M),ne(H,se)};xr(re,H=>{j(h)&&H(ie)})}var te=be(re,2);rk(te,{get visible(){return j(p)}}),fe(oe),zt("click",ye,O),vs(ve,()=>j(o),H=>Ge(o,H)),ne(e,oe),as()}export{GE as component};
